<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Turismo Inclusivo Ecuador - Portal Turístico Accesible</title>
  <meta name="description" content="Portal turístico inclusivo de Ecuador con información accesible sobre destinos, rutas y servicios turísticos" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <!-- Skip to main content link for screen readers -->
  <a href="#main-content" class="skip-link">Saltar al contenido principal</a>
  
  <!-- Indicador de estado de accesibilidad -->
  <div id="accessibility-status" class="accessibility-status" role="status" aria-live="polite">
    <span id="status-text">Accesibilidad: Normal</span>
  </div>
  
  <header role="banner">
    <div class="logo">
      <img src="img/logo-ecuador.png" alt="Logo oficial de Ecuador Turismo" class="logo-img" />
      <span class="logo-text">PORTAL TURÍSTICO EC</span>
    </div>

    <div class="menu-accesibilidad" role="navigation" aria-label="Herramientas de accesibilidad">
      <button class="menu-toggle" onclick="toggleAccMenu()" aria-expanded="false" aria-controls="accesibilidad-lista">
        <span aria-hidden="true">♿</span> Accesibilidad <span aria-hidden="true">▾</span>
      </button>
      <ul id="accesibilidad-lista" class="accesibilidad-lista oculto" role="menu">
        <li role="none"><button role="menuitem" onclick="activarContraste()" aria-label="Activar modo alto contraste">
          <span aria-hidden="true">🌓</span> Alto contraste
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarModoMonocromatico()" aria-label="Activar modo monocromático">
          <span aria-hidden="true">🎨</span> Modo monocromático
        </button></li>
        <li role="none"><button role="menuitem" onclick="aumentarTexto()" aria-label="Aumentar tamaño del texto">
          <span aria-hidden="true">👁️</span> Aumentar texto
        </button></li>
        <li role="none"><button role="menuitem" onclick="reducirTexto()" aria-label="Reducir tamaño del texto">
          <span aria-hidden="true">👁️</span> Reducir texto
        </button></li>
        <li role="none"><button role="menuitem" onclick="ajustarEspaciado()" aria-label="Ajustar espaciado de texto">
          <span aria-hidden="true">📏</span> Ajustar espaciado
        </button></li>
        <li role="none"><button role="menuitem" onclick="usarFuenteLegible()" aria-label="Cambiar a fuente más legible">
          <span aria-hidden="true">🅰️</span> Fuente legible
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarZoom()" aria-label="Activar zoom de página">
          <span aria-hidden="true">🔍</span> Zoom de página
        </button></li>
        <li role="none"><button role="menuitem" onclick="resaltarEnlaces()" aria-label="Resaltar enlaces y foco">
          <span aria-hidden="true">✨</span> Resaltar enlaces
        </button></li>
        <li role="none"><button role="menuitem" onclick="pausarAnimaciones()" aria-label="Pausar animaciones">
          <span aria-hidden="true">⏸️</span> Pausar animaciones
        </button></li>
        <li role="none"><button role="menuitem" onclick="leerTexto()" aria-label="Activar lectura de texto en voz alta">
          <span aria-hidden="true">👂</span> Lectura de texto
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarDescripcionAudio()" aria-label="Activar descripción de audio">
          <span aria-hidden="true">🎧</span> Descripción de audio
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarSubtitulos()" aria-label="Activar subtítulos cerrados">
          <span aria-hidden="true">📺</span> Subtítulos cerrados
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarSubtitulosDirecto()" aria-label="Activar subtítulos en directo">
          <span aria-hidden="true">📡</span> Subtítulos en directo
        </button></li>
        <li role="none"><button role="menuitem" onclick="descargarTranscripcion()" aria-label="Descargar transcripción">
          <span aria-hidden="true">📄</span> Descargar transcripción
        </button></li>
        <li role="none"><button role="menuitem" onclick="mostrarControlesAudio()" aria-label="Mostrar controles de audio">
          <span aria-hidden="true">🔊</span> Controles de audio
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarAlertasVisuales()" aria-label="Activar alertas visuales">
          <span aria-hidden="true">⚠️</span> Alertas visuales
        </button></li>
        <li role="none"><button role="menuitem" onclick="restablecerAccesibilidad()" aria-label="Restablecer configuración de accesibilidad">
          <span aria-hidden="true">♻️</span> Restablecer
        </button></li>
        <li role="none"><button role="menuitem" onclick="mostrarInfoAccesibilidad()" aria-label="Mostrar información de accesibilidad">
          <span aria-hidden="true">ℹ️</span> Información
        </button></li>
      </ul>
    </div>

    <!-- Menú principal mejorado -->
    <nav class="nav-main" role="navigation" aria-label="Navegación principal">
      <button class="menu-toggle-mobile" onclick="toggleMobileMenu()" aria-expanded="false" aria-controls="menu-principal" aria-label="Abrir menú principal">
        <span class="hamburger-icon" aria-hidden="true">☰</span>
        <span class="menu-text">Menú</span>
      </button>
      
      <ul id="menu-principal" class="menu-principal" role="menubar">
        <!-- Sección: Navegación Principal -->
        <li class="menu-section" role="none">
          <span class="menu-section-title" aria-hidden="true">Navegación</span>
          <ul class="menu-items" role="group" aria-label="Navegación principal">
            <li role="none">
              <a href="#inicio" class="menu-item active" role="menuitem" aria-current="page">
                <span class="menu-icon" aria-hidden="true">🏠</span>
                <span class="menu-text">Inicio</span>
              </a>
            </li>
            <li role="none">
              <a href="#rutas" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">🛣️</span>
                <span class="menu-text">Rutas</span>
              </a>
            </li>
            <li role="none">
              <a href="#alojamientos" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">🏨</span>
                <span class="menu-text">Alojamientos</span>
              </a>
            </li>
            <li role="none">
              <a href="#accesibilidad" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">🚶‍♂️</span>
                <span class="menu-text">Accesibilidad</span>
              </a>
            </li>
            <li role="none">
              <a href="#contacto" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">📞</span>
                <span class="menu-text">Contacto</span>
              </a>
            </li>
            <li role="none" class="menu-item-user">
              <button class="menu-item btn-login" onclick="mostrarModal('modal-login')" role="menuitem">
                <span class="menu-icon" aria-hidden="true">👤</span>
                <span class="menu-text">Iniciar Sesión</span>
              </button>
            </li>
            <li role="none" class="menu-item-user">
              <button class="menu-item btn-register" onclick="mostrarModal('modal-auth')" role="menuitem">
                <span class="menu-icon" aria-hidden="true">📝</span>
                <span class="menu-text">Registrarse</span>
              </button>
            </li>
          </ul>
        </li>

        <!-- Sección: Servicios -->
        <li class="menu-section" role="none">
          <span class="menu-section-title" aria-hidden="true">Servicios</span>
          <ul class="menu-items" role="group" aria-label="Servicios turísticos">
            <li role="none">
              <a href="#multimedia" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">🎥</span>
                <span class="menu-text">Multimedia</span>
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Accesos rápidos -->
    <div class="quick-access" role="complementary" aria-label="Accesos rápidos">
      <button class="quick-btn" onclick="scrollToSection('destinos')" aria-label="Ir a destinos destacados">
        <span class="quick-icon" aria-hidden="true">⭐</span>
        <span class="quick-text">Destinos</span>
      </button>
      <button class="quick-btn" onclick="scrollToSection('multimedia')" aria-label="Ir a contenido multimedia">
        <span class="quick-icon" aria-hidden="true">🎬</span>
        <span class="quick-text">Videos</span>
      </button>
      <button class="quick-btn" onclick="mostrarModal('modal-login')" aria-label="Acceso rápido a inicio de sesión">
        <span class="quick-icon" aria-hidden="true">🔑</span>
        <span class="quick-text">Acceder</span>
      </button>
    </div>
  </header>

  <main id="main-content" role="main">
    <!-- Breadcrumbs -->
    <nav id="breadcrumbs" class="breadcrumbs" aria-label="Navegación de migas de pan">
      <a href="#inicio">Inicio</a>
    </nav>
    
    <section class="banner-rotativo" aria-label="Imágenes de destinos turísticos de Ecuador">
      <img src="img/banner1.jpg" class="active" alt="Vista panorámica de Cuenca, ciudad patrimonio de la humanidad" />
      <img src="img/banner2.jpg" alt="Playa de Salinas con aguas cristalinas del Pacífico" />
      <img src="img/banner3.jpg" alt="Paisaje montañoso de los Andes ecuatorianos" />
    </section>

    <section aria-labelledby="mapa-titulo">
      <h2 id="mapa-titulo" style="text-align:center; margin-top: 2rem;">Mapa de Rutas Turísticas</h2>
      <div id="map" style="height: 400px; margin: 20px auto; width: 90%; max-width: 1000px;" 
           role="application" aria-label="Mapa interactivo de destinos turísticos de Ecuador"></div>
    </section>

    <!-- Sección de destinos destacados -->
    <section class="destinos-destacados" aria-labelledby="destinos-titulo">
      <h2 id="destinos-titulo">Destinos Destacados</h2>
      <div class="destinos-grid">
        <article class="destino-card">
          <img src="img/cuenca.jpg" alt="Centro histórico de Cuenca" />
          <h3>Cuenca</h3>
          <p>Ciudad patrimonio de la humanidad con arquitectura colonial y artesanías tradicionales.</p>
          <button class="btn-destino" aria-label="Ver más información sobre Cuenca">Ver más</button>
        </article>
        <article class="destino-card">
          <img src="img/salinas.jpg" alt="Playa de Salinas" />
          <h3>Salinas</h3>
          <p>Hermosa playa del Pacífico con excelente infraestructura turística y accesibilidad.</p>
          <button class="btn-destino" aria-label="Ver más información sobre Salinas">Ver más</button>
        </article>
        <article class="destino-card">
          <img src="img/manta.jpg" alt="Ciudad de Manta" />
          <h3>Manta</h3>
          <p>Puerto pesquero con hermosas playas y deliciosa gastronomía marina.</p>
          <button class="btn-destino" aria-label="Ver más información sobre Manta">Ver más</button>
        </article>
      </div>
    </section>

    <!-- Sección de contenido multimedia accesible -->
    <section class="multimedia-accesible" aria-labelledby="multimedia-titulo">
      <h2 id="multimedia-titulo">Contenido Multimedia Accesible</h2>
      
      <!-- Video con subtítulos -->
      <div class="video-container" aria-labelledby="video-titulo">
        <h3 id="video-titulo">Video Promocional de Ecuador</h3>
        <div class="video-wrapper">
          <video id="video-ecuador" controls preload="metadata" aria-describedby="video-descripcion">
            <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
            <track kind="subtitles" src="subtitulos-ecuador.vtt" srclang="es" label="Español" default>
            <track kind="subtitles" src="subtitulos-ecuador-en.vtt" srclang="en" label="English">
            Tu navegador no soporta el elemento de video.
          </video>
          <div id="subtitulos-custom" class="subtitulos-custom oculto" aria-live="polite"></div>
        </div>
        <p id="video-descripcion" class="video-descripcion">
          Video promocional que muestra los paisajes más hermosos de Ecuador, incluyendo la costa, sierra y Amazonía.
        </p>
        <div class="video-controls">
          <button onclick="toggleSubtitulos()" class="btn-control" aria-label="Activar o desactivar subtítulos">
            <span aria-hidden="true">📺</span> Subtítulos
          </button>
          <button onclick="toggleTranscripcion()" class="btn-control" aria-label="Mostrar transcripción">
            <span aria-hidden="true">📄</span> Transcripción
          </button>
          <button onclick="descargarVideoTranscripcion()" class="btn-control" aria-label="Descargar transcripción del video">
            <span aria-hidden="true">💾</span> Descargar
          </button>
        </div>
      </div>

      <!-- Audio con controles -->
      <div class="audio-container" aria-labelledby="audio-titulo">
        <h3 id="audio-titulo">Audio Guía Turística</h3>
        <div class="audio-wrapper">
          <audio id="audio-guia" controls preload="metadata" aria-describedby="audio-descripcion">
            <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
            Tu navegador no soporta el elemento de audio.
          </audio>
        </div>
        <p id="audio-descripcion" class="audio-descripcion">
          Audio guía que describe los principales atractivos turísticos de Ecuador.
        </p>
        <div class="audio-controls">
          <button onclick="toggleMute()" class="btn-control" aria-label="Silenciar o activar audio">
            <span aria-hidden="true">🔇</span> Silenciar
          </button>
          <button onclick="ajustarVolumen(0.5)" class="btn-control" aria-label="Ajustar volumen al 50%">
            <span aria-hidden="true">🔊</span> Volumen 50%
          </button>
          <button onclick="ajustarVolumen(1.0)" class="btn-control" aria-label="Ajustar volumen al 100%">
            <span aria-hidden="true">🔊</span> Volumen 100%
          </button>
          <button onclick="descargarAudioTranscripcion()" class="btn-control" aria-label="Descargar transcripción del audio">
            <span aria-hidden="true">💾</span> Descargar
          </button>
        </div>
      </div>

      <!-- Transcripción en tiempo real -->
      <div id="transcripcion-container" class="transcripcion-container oculto" aria-labelledby="transcripcion-titulo">
        <h3 id="transcripcion-titulo">Transcripción en Tiempo Real</h3>
        <div id="transcripcion-texto" class="transcripcion-texto" role="log" aria-live="polite">
          <p>La transcripción aparecerá aquí cuando se active...</p>
        </div>
        <div class="transcripcion-controls">
          <button onclick="iniciarTranscripcion()" class="btn-control" aria-label="Iniciar transcripción en tiempo real">
            <span aria-hidden="true">🎤</span> Iniciar
          </button>
          <button onclick="detenerTranscripcion()" class="btn-control" aria-label="Detener transcripción en tiempo real">
            <span aria-hidden="true">⏹️</span> Detener
          </button>
          <button onclick="limpiarTranscripcion()" class="btn-control" aria-label="Limpiar transcripción">
            <span aria-hidden="true">🗑️</span> Limpiar
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de Registro de Usuario Mejorado -->
  <div id="modal-auth" class="modal oculto" role="dialog" aria-labelledby="modal-registro-titulo" aria-hidden="true">
    <div class="modal-content registro-modal">
      <span class="cerrar" onclick="cerrarModal('modal-auth')" aria-label="Cerrar ventana de registro">&times;</span>
      
      <div class="registro-header">
        <div class="registro-icon" aria-hidden="true">📝</div>
        <h2 id="modal-registro-titulo">Crear Cuenta</h2>
        <p class="registro-subtitle">Únete al Portal Turístico Ecuador</p>
      </div>
      
      <form id="form-registro" role="form" aria-describedby="registro-descripcion" novalidate>
        <p id="registro-descripcion" class="sr-only">Formulario completo para crear una nueva cuenta de usuario en el portal turístico</p>
        
        <!-- Sección: Datos Personales -->
        <div class="form-section" aria-labelledby="datos-personales-titulo">
          <h3 id="datos-personales-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">👤</span>
            Datos Personales
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">📛</span>
                Nombre Completo
              </label>
              <input 
                type="text" 
                id="nombre" 
                name="nombre" 
                placeholder="Ingresa tu nombre completo" 
                required 
                autocomplete="given-name"
                aria-describedby="nombre-error nombre-help"
                class="form-input"
                minlength="2"
                maxlength="50"
              />
              <div id="nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="nombre-help" class="help-text">Ingresa tu nombre y apellidos</div>
            </div>
            
            <div class="form-group">
              <label for="cedula" class="form-label required">
                <span class="label-icon" aria-hidden="true">🆔</span>
                Cédula de Identidad
              </label>
              <input 
                type="text" 
                id="cedula" 
                name="cedula" 
                placeholder="Ej: 1234567890" 
                required 
                autocomplete="off"
                aria-describedby="cedula-error cedula-help"
                class="form-input"
                pattern="[0-9]{10}"
                maxlength="10"
              />
              <div id="cedula-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="cedula-help" class="help-text">Ingresa tu número de cédula (10 dígitos)</div>
            </div>
          </div>
        </div>
        
        <!-- Sección: Información de Contacto -->
        <div class="form-section" aria-labelledby="contacto-titulo">
          <h3 id="contacto-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📧</span>
            Información de Contacto
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="email" class="form-label required">
                <span class="label-icon" aria-hidden="true">📧</span>
                Correo Electrónico
              </label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                placeholder="tu@email.com" 
                required 
                autocomplete="email"
                aria-describedby="email-error email-help"
                class="form-input"
              />
              <div id="email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="email-help" class="help-text">Ingresa un correo válido para confirmar tu cuenta</div>
            </div>
            
            <div class="form-group">
              <label for="telefono" class="form-label">
                <span class="label-icon" aria-hidden="true">📱</span>
                Teléfono (Opcional)
              </label>
              <input 
                type="tel" 
                id="telefono" 
                name="telefono" 
                placeholder="Ej: 0991234567" 
                autocomplete="tel"
                aria-describedby="telefono-error telefono-help"
                class="form-input"
                pattern="[0-9]{10}"
                maxlength="10"
              />
              <div id="telefono-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="telefono-help" class="help-text">Ingresa tu número de teléfono móvil</div>
            </div>
          </div>
        </div>
        
        <!-- Sección: Credenciales de Acceso -->
        <div class="form-section" aria-labelledby="credenciales-titulo">
          <h3 id="credenciales-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">🔐</span>
            Credenciales de Acceso
          </h3>
          
          <div class="form-group">
            <label for="usuario" class="form-label required">
              <span class="label-icon" aria-hidden="true">👤</span>
              Nombre de Usuario
            </label>
            <div class="input-wrapper">
              <input 
                type="text" 
                id="usuario" 
                name="usuario" 
                placeholder="Elige un nombre de usuario único" 
                required 
                autocomplete="username"
                aria-describedby="usuario-error usuario-help"
                class="form-input"
                minlength="3"
                maxlength="20"
                pattern="[a-zA-Z0-9_]+"
              />
              <div class="input-status" aria-hidden="true"></div>
            </div>
            <div id="usuario-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="usuario-help" class="help-text">Mínimo 3 caracteres, solo letras, números y guiones bajos</div>
          </div>
          
          <div class="form-group">
            <label for="clave" class="form-label required">
              <span class="label-icon" aria-hidden="true">🔒</span>
              Contraseña
            </label>
            <div class="input-wrapper">
              <input 
                type="password" 
                id="clave" 
                name="clave" 
                placeholder="Crea una contraseña segura" 
                required 
                autocomplete="new-password"
                aria-describedby="clave-error clave-help password-strength"
                class="form-input"
                minlength="8"
              />
              <button 
                type="button" 
                class="password-toggle" 
                onclick="togglePasswordVisibility('clave')"
                aria-label="Mostrar contraseña"
                aria-pressed="false"
              >
                <span class="toggle-icon" aria-hidden="true">👁️</span>
              </button>
              <div class="input-status" aria-hidden="true"></div>
            </div>
            <div id="clave-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="clave-help" class="help-text">Mínimo 8 caracteres, incluye mayúsculas, minúsculas y números</div>
            
            <!-- Barra de fortaleza de contraseña -->
            <div class="password-strength-container">
              <div class="strength-bar">
                <div id="password-strength-bar" class="strength-fill"></div>
              </div>
              <span id="password-strength-text" class="strength-text">Fortaleza de la contraseña</span>
            </div>
          </div>
          
          <div class="form-group">
            <label for="confirmar-clave" class="form-label required">
              <span class="label-icon" aria-hidden="true">🔐</span>
              Confirmar Contraseña
            </label>
            <div class="input-wrapper">
              <input 
                type="password" 
                id="confirmar-clave" 
                name="confirmar-clave" 
                placeholder="Repite tu contraseña" 
                required 
                autocomplete="new-password"
                aria-describedby="confirmar-clave-error confirmar-clave-help"
                class="form-input"
              />
              <div class="input-status" aria-hidden="true"></div>
            </div>
            <div id="confirmar-clave-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="confirmar-clave-help" class="help-text">Repite exactamente la misma contraseña</div>
          </div>
        </div>
        
        <!-- Sección: Términos y Condiciones -->
        <div class="form-section" aria-labelledby="terminos-titulo">
          <h3 id="terminos-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📋</span>
            Términos y Condiciones
          </h3>
          
          <div class="form-options">
            <label class="checkbox-wrapper required">
              <input 
                type="checkbox" 
                id="aceptar-terminos" 
                name="aceptar-terminos"
                required
                aria-describedby="terminos-help"
              />
              <span class="checkmark"></span>
              <span class="checkbox-text">
                Acepto los <a href="#terminos-uso" class="link-inline">Términos de Uso</a> y la 
                <a href="#politica-privacidad" class="link-inline">Política de Privacidad</a>
              </span>
            </label>
            <div id="terminos-help" class="help-text">Debes aceptar los términos para continuar</div>
          </div>
          
          <div class="form-options">
            <label class="checkbox-wrapper">
              <input 
                type="checkbox" 
                id="recibir-notificaciones" 
                name="recibir-notificaciones"
                aria-describedby="notificaciones-help"
              />
              <span class="checkmark"></span>
              <span class="checkbox-text">Deseo recibir notificaciones sobre ofertas turísticas</span>
            </label>
            <div id="notificaciones-help" class="help-text">Puedes cambiar esta opción después</div>
          </div>
        </div>
        
        <!-- Botones de acción -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-registro-submit"
            aria-label="Crear cuenta de usuario"
            id="registro-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">✅</span>
            <span class="btn-text">Crear Cuenta</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-registro-cancel"
            onclick="cerrarModal('modal-auth')"
            aria-label="Cancelar registro"
          >
            <span class="btn-icon" aria-hidden="true">❌</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="registro-status" class="registro-status" role="status" aria-live="polite"></div>
      </form>
      
      <!-- Enlaces adicionales -->
      <div class="registro-footer">
        <p class="registro-links">
          <a href="#" onclick="cerrarModal('modal-auth'); mostrarModal('modal-login')" class="link-secondary">
            ¿Ya tienes cuenta? Inicia sesión aquí
          </a>
        </p>
      </div>
    </div>
  </div>

  <!-- Modal de Registro de Administrador (solo visible para admins) -->
  <div id="modal-admin" class="modal oculto" role="dialog" aria-labelledby="modal-admin-titulo" aria-hidden="true">
    <div class="modal-content">
      <span class="cerrar" onclick="cerrarModal('modal-admin')" aria-label="Cerrar ventana de registro de admin">&times;</span>
      <h2 id="modal-admin-titulo">Registrar Administrador</h2>
      <form id="form-registro-admin" role="form" aria-describedby="admin-descripcion">
        <p id="admin-descripcion" class="sr-only">Formulario para crear una nueva cuenta de administrador</p>
        <div class="form-group">
          <label for="admin-usuario">Usuario:</label>
          <input type="text" id="admin-usuario" name="usuario" placeholder="Nombre de usuario" required />
        </div>
        <div class="form-group">
          <label for="admin-clave">Contraseña:</label>
          <input type="password" id="admin-clave" name="clave" placeholder="Contraseña" required />
        </div>
        <div class="form-group">
          <label for="admin-email">Email:</label>
          <input type="email" id="admin-email" name="email" placeholder="Correo electrónico" required />
        </div>
        <button type="submit" aria-label="Registrar administrador">Registrar Admin</button>
      </form>
    </div>
  </div>

  <!-- Modal de Login Mejorado -->
  <div id="modal-login" class="modal oculto" role="dialog" aria-labelledby="modal-login-titulo" aria-hidden="true">
    <div class="modal-content login-modal">
      <span class="cerrar" onclick="cerrarModal('modal-login')" aria-label="Cerrar ventana de inicio de sesión">&times;</span>
      
      <div class="login-header">
        <div class="login-icon" aria-hidden="true">🔐</div>
        <h2 id="modal-login-titulo">Iniciar Sesión</h2>
        <p class="login-subtitle">Accede a tu cuenta del Portal Turístico Ecuador</p>
      </div>
      
      <form id="form-login" role="form" aria-describedby="login-descripcion" novalidate>
        <p id="login-descripcion" class="sr-only">Formulario para iniciar sesión en el portal turístico de Ecuador</p>
        
        <!-- Campo Usuario -->
        <div class="form-group">
          <label for="login-usuario" class="form-label">
            <span class="label-icon" aria-hidden="true">👤</span>
            Nombre de Usuario
          </label>
          <div class="input-wrapper">
            <input 
              type="text" 
              id="login-usuario" 
              name="usuario" 
              placeholder="Ingresa tu nombre de usuario" 
              required 
              autocomplete="username"
              aria-describedby="login-usuario-error login-usuario-help"
              class="form-input"
              autofocus
            />
            <div class="input-status" aria-hidden="true"></div>
          </div>
          <div id="login-usuario-error" class="error-message" role="alert" aria-live="polite"></div>
          <div id="login-usuario-help" class="help-text">Ingresa el nombre de usuario que registraste</div>
        </div>
        
        <!-- Campo Contraseña -->
        <div class="form-group">
          <label for="login-clave" class="form-label">
            <span class="label-icon" aria-hidden="true">🔒</span>
            Contraseña
          </label>
          <div class="input-wrapper">
            <input 
              type="password" 
              id="login-clave" 
              name="clave" 
              placeholder="Ingresa tu contraseña" 
              required 
              autocomplete="current-password"
              aria-describedby="login-clave-error login-clave-help"
              class="form-input"
            />
            <button 
              type="button" 
              class="password-toggle" 
              onclick="togglePasswordVisibility('login-clave')"
              aria-label="Mostrar contraseña"
              aria-pressed="false"
            >
              <span class="toggle-icon" aria-hidden="true">👁️</span>
            </button>
            <div class="input-status" aria-hidden="true"></div>
          </div>
          <div id="login-clave-error" class="error-message" role="alert" aria-live="polite"></div>
          <div id="login-clave-help" class="help-text">Ingresa la contraseña de tu cuenta</div>
        </div>
        
        <!-- Opciones adicionales -->
        <div class="form-options">
          <label class="checkbox-wrapper">
            <input 
              type="checkbox" 
              id="remember-user" 
              name="remember"
              aria-describedby="remember-help"
            />
            <span class="checkmark"></span>
            <span class="checkbox-text">Recordar mi usuario</span>
          </label>
          <div id="remember-help" class="sr-only">Marcar esta opción para recordar tu nombre de usuario</div>
        </div>
        
        <!-- CAPTCHA para prevenir intentos múltiples -->
        <div class="captcha-container" id="captcha-container" style="display: none;">
          <div class="captcha-challenge">
            <span class="captcha-text" id="captcha-text">¿Cuál es la capital de Ecuador?</span>
            <input 
              type="text" 
              id="captcha-answer" 
              placeholder="Respuesta"
              class="form-input captcha-input"
              aria-describedby="captcha-help"
            />
            <div id="captcha-help" class="help-text">Responde la pregunta para verificar que eres humano</div>
          </div>
        </div>
        
        <!-- Botón de envío -->
        <button 
          type="submit" 
          class="btn-login-submit"
          aria-label="Iniciar sesión en el portal"
          id="login-submit-btn"
        >
          <span class="btn-icon" aria-hidden="true">🚀</span>
          <span class="btn-text">Iniciar Sesión</span>
          <div class="btn-loading" aria-hidden="true"></div>
        </button>
        
        <!-- Mensaje de estado -->
        <div id="login-status" class="login-status" role="status" aria-live="polite"></div>
      </form>
      
      <!-- Enlaces adicionales -->
      <div class="login-footer">
        <p class="login-links">
          <a href="#" onclick="cerrarModal('modal-login'); mostrarModal('modal-auth')" class="link-secondary">
            ¿No tienes cuenta? Regístrate aquí
          </a>
        </p>
        <p class="login-links">
          <a href="#" onclick="mostrarRecuperarPassword()" class="link-secondary">
            ¿Olvidaste tu contraseña?
          </a>
        </p>
      </div>
    </div>
  </div>

  <footer role="contentinfo">
    <div class="footer-content">
      <p>&copy; 2024 Portal Turístico Ecuador. Todos los derechos reservados.</p>
      <nav aria-label="Enlaces de pie de página">
        <a href="#politica-privacidad">Política de Privacidad</a> |
        <a href="#terminos-uso">Términos de Uso</a> |
        <a href="#" onclick="abrirModal('modal-guardar-registro')">Guardar Destino</a> |
        <a href="#" onclick="abrirModalEditar(1)">Editar Destino</a> |
        <a href="#" onclick="abrirModalBusqueda()">Búsqueda Avanzada</a> |
        <a href="#" onclick="abrirModalEliminar(1)">Eliminar Destino</a> |
        <a href="#" onclick="mostrarModalContacto()">Contacto</a>
      </nav>
    </div>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Configuración global
    const API_BASE_URL = 'http://192.168.18.27:5000';
    let currentUser = null;
    let speechSynthesis = window.speechSynthesis;

    // Utilidades de accesibilidad
    function announceToScreenReader(message) {
      const announcement = document.createElement('div');
      announcement.setAttribute('aria-live', 'polite');
      announcement.setAttribute('aria-atomic', 'true');
      announcement.className = 'sr-only';
      announcement.textContent = message;
      document.body.appendChild(announcement);
      setTimeout(() => document.body.removeChild(announcement), 1000);
    }

    function updateAccessibilityStatus() {
      const statusElement = document.getElementById('accessibility-status');
      const statusText = document.getElementById('status-text');
      const activeFeatures = [];
      
      if (document.body.classList.contains('alto-contraste')) activeFeatures.push('Alto contraste');
      if (document.body.classList.contains('monocromatico')) activeFeatures.push('Monocromático');
      if (document.body.classList.contains('texto-grande')) activeFeatures.push('Texto grande');
      if (document.body.classList.contains('texto-pequeno')) activeFeatures.push('Texto pequeño');
      if (document.body.classList.contains('espaciado-ajustado')) activeFeatures.push('Espaciado ajustado');
      if (document.body.classList.contains('fuente-legible')) activeFeatures.push('Fuente legible');
      if (document.body.classList.contains('zoom-pagina')) activeFeatures.push('Zoom');
      if (document.body.classList.contains('resaltar-enlaces')) activeFeatures.push('Enlaces resaltados');
      if (document.body.classList.contains('pausar-animaciones')) activeFeatures.push('Animaciones pausadas');
      if (document.body.classList.contains('descripcion-audio')) activeFeatures.push('Descripción de audio');
      if (subtitulosActivos) activeFeatures.push('Subtítulos');
      if (alertasVisualesActivas) activeFeatures.push('Alertas visuales');
      
      if (activeFeatures.length > 0) {
        statusText.textContent = `Accesibilidad: ${activeFeatures.join(', ')}`;
        statusElement.classList.add('active');
        setTimeout(() => statusElement.classList.remove('active'), 3000);
      } else {
        statusText.textContent = 'Accesibilidad: Normal';
        statusElement.classList.remove('active');
      }
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.setAttribute('role', 'alert');
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.classList.add('fade-out');
        setTimeout(() => document.body.removeChild(notification), 300);
      }, 3000);
    }

    // Validación de formularios
    function validateForm(formData) {
      const errors = {};
      
      if (!formData.usuario || formData.usuario.trim().length < 3) {
        errors.usuario = 'El usuario debe tener al menos 3 caracteres';
      }
      
      if (!formData.clave || formData.clave.length < 6) {
        errors.clave = 'La contraseña debe tener al menos 6 caracteres';
      }
      
      return errors;
    }

    function displayFormErrors(errors) {
      Object.keys(errors).forEach(field => {
        const errorElement = document.getElementById(`${field}-error`);
        if (errorElement) {
          errorElement.textContent = errors[field];
          errorElement.style.display = 'block';
        }
      });
    }

    function clearFormErrors() {
      const errorElements = document.querySelectorAll('.error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    // Mapa interactivo mejorado
    function initializeMap() {
      const map = L.map('map').setView([-1.8312, -78.1834], 6);
      
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
      }).addTo(map);

      const destinations = [
        { 
          lat: -2.9006, 
          lng: -79.0045, 
          name: "Cuenca",
          description: "Ciudad patrimonio de la humanidad",
          accessibility: "Accesible para sillas de ruedas"
        },
        { 
          lat: -0.9683, 
          lng: -80.7128, 
          name: "Salinas",
          description: "Playa del Pacífico",
          accessibility: "Rampas de acceso disponibles"
        },
        { 
          lat: -0.9462, 
          lng: -80.7214, 
          name: "Manta",
          description: "Puerto pesquero",
          accessibility: "Transporte adaptado disponible"
        },
        { 
          lat: -1.2547, 
          lng: -78.6229, 
          name: "Baños",
          description: "Aventura en los Andes",
          accessibility: "Guías especializados en accesibilidad"
        }
      ];

      destinations.forEach(dest => {
        const marker = L.marker([dest.lat, dest.lng]).addTo(map);
        const popupContent = `
          <div class="map-popup">
            <h3>${dest.name}</h3>
            <p>${dest.description}</p>
            <p><strong>Accesibilidad:</strong> ${dest.accessibility}</p>
            <button onclick="showDestinationDetails('${dest.name}')" class="btn-destino">
              Ver más información
            </button>
          </div>
        `;
        marker.bindPopup(popupContent);
      });

      return map;
    }

    // Banner rotativo mejorado
    function initializeBanner() {
      const banners = document.querySelectorAll('.banner-rotativo img');
      let bannerIndex = 0;
      
      function rotateBanner() {
        banners.forEach((img, i) => {
          img.classList.toggle('active', i === bannerIndex);
          img.setAttribute('aria-hidden', i !== bannerIndex);
        });
        bannerIndex = (bannerIndex + 1) % banners.length;
      }
      
      // Controles de banner para accesibilidad
      const bannerControls = document.createElement('div');
      bannerControls.className = 'banner-controls';
      bannerControls.innerHTML = `
        <button onclick="previousBanner()" aria-label="Imagen anterior">‹</button>
        <span class="banner-counter">1 de ${banners.length}</span>
        <button onclick="nextBanner()" aria-label="Siguiente imagen">›</button>
      `;
      document.querySelector('.banner-rotativo').appendChild(bannerControls);
      
      setInterval(rotateBanner, 5000);
    }

    function previousBanner() {
      const banners = document.querySelectorAll('.banner-rotativo img');
      const currentIndex = Array.from(banners).findIndex(img => img.classList.contains('active'));
      const newIndex = currentIndex > 0 ? currentIndex - 1 : banners.length - 1;
      
      banners.forEach((img, i) => {
        img.classList.toggle('active', i === newIndex);
        img.setAttribute('aria-hidden', i !== newIndex);
      });
      
      updateBannerCounter(newIndex + 1);
    }

    function nextBanner() {
      const banners = document.querySelectorAll('.banner-rotativo img');
      const currentIndex = Array.from(banners).findIndex(img => img.classList.contains('active'));
      const newIndex = (currentIndex + 1) % banners.length;
      
      banners.forEach((img, i) => {
        img.classList.toggle('active', i === newIndex);
        img.setAttribute('aria-hidden', i !== newIndex);
      });
      
      updateBannerCounter(newIndex + 1);
    }

    function updateBannerCounter(current) {
      const counter = document.querySelector('.banner-counter');
      if (counter) {
        counter.textContent = `${current} de ${document.querySelectorAll('.banner-rotativo img').length}`;
      }
    }

    // Modales mejorados
    function showModal(id) {
      const modal = document.getElementById(id);
      modal.classList.remove('oculto');
      modal.setAttribute('aria-hidden', 'false');
      
      // Enfoque en el primer elemento interactivo
      const firstFocusable = modal.querySelector('input, button, select');
      if (firstFocusable) {
        firstFocusable.focus();
      }
      
      // Cerrar con Escape
      document.addEventListener('keydown', handleEscapeKey);
      
      announceToScreenReader(`Ventana ${id === 'modal-login' ? 'de inicio de sesión' : 'de registro'} abierta`);
    }

    function closeModal(id) {
      const modal = document.getElementById(id);
      modal.classList.add('oculto');
      modal.setAttribute('aria-hidden', 'true');
      
      document.removeEventListener('keydown', handleEscapeKey);
      clearFormErrors();
      
      announceToScreenReader('Ventana cerrada');
    }

    function handleEscapeKey(event) {
      if (event.key === 'Escape') {
        const openModal = document.querySelector('.modal:not(.oculto)');
        if (openModal) {
          closeModal(openModal.id);
        }
      }
    }

    // Registro mejorado
    document.getElementById("form-registro").addEventListener("submit", async (e) => {
      e.preventDefault();
      clearFormErrors();
      
      const formData = {
        usuario: document.getElementById("usuario").value.trim(),
        clave: document.getElementById("clave").value,
        rol: document.getElementById("rol").value
      };
      
      const errors = validateForm(formData);
      if (Object.keys(errors).length > 0) {
        displayFormErrors(errors);
        announceToScreenReader('Hay errores en el formulario. Por favor, revíselos.');
        return;
      }
      
      try {
        showNotification('Registrando usuario...', 'info');
        
        const response = await fetch(`${API_BASE_URL}/registro`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          showNotification(data.mensaje, 'success');
          announceToScreenReader('Usuario registrado exitosamente');
          closeModal('modal-auth');
        } else {
          showNotification(data.mensaje, 'error');
          announceToScreenReader('Error al registrar usuario');
        }
      } catch (error) {
        showNotification("Error de conexión. Intente nuevamente.", 'error');
        announceToScreenReader('Error de conexión');
      }
    });

    // Login mejorado
    document.getElementById("form-login").addEventListener("submit", async (e) => {
      e.preventDefault();
      clearFormErrors();
      
      const formData = {
        usuario: document.getElementById("login-usuario").value.trim(),
        clave: document.getElementById("login-clave").value
      };
      
      const errors = validateForm(formData);
      if (Object.keys(errors).length > 0) {
        displayFormErrors(errors);
        announceToScreenReader('Hay errores en el formulario. Por favor, revíselos.');
        return;
      }
      
      try {
        showNotification('Iniciando sesión...', 'info');
        
        const response = await fetch(`${API_BASE_URL}/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          currentUser = { usuario: formData.usuario, rol: data.rol };
          showNotification(data.mensaje, 'success');
          announceToScreenReader(`Bienvenido ${formData.usuario}`);
          closeModal('modal-login');
          
          if (data.rol === 'admin') {
            showAdminPanel();
          }
        } else {
          showNotification(data.mensaje, 'error');
          announceToScreenReader('Credenciales incorrectas');
        }
      } catch (error) {
        showNotification("Error de conexión. Intente nuevamente.", 'error');
        announceToScreenReader('Error de conexión');
      }
    });

    // Panel de administración mejorado
    function showAdminPanel() {
      if (document.getElementById('panel-admin')) return;
      
      const panel = document.createElement('div');
      panel.id = 'panel-admin';
      panel.className = 'admin-panel';
      panel.innerHTML = `
        <div class="admin-header">
          <h2>Panel de Administrador</h2>
          <button onclick="closeAdminPanel()" aria-label="Cerrar panel de administrador">×</button>
        </div>
        <div class="admin-content">
          <h3>Usuarios Registrados</h3>
          <div id="users-list" class="users-list">
            <p>Cargando usuarios...</p>
          </div>
        </div>
      `;
      
      document.body.appendChild(panel);
      loadUsers();
      announceToScreenReader('Panel de administrador abierto');
    }

    function closeAdminPanel() {
      const panel = document.getElementById('panel-admin');
      if (panel) {
        document.body.removeChild(panel);
        announceToScreenReader('Panel de administrador cerrado');
      }
    }

    async function loadUsers() {
      try {
        const response = await fetch(`${API_BASE_URL}/admin/usuarios`);
        const users = await response.json();
        
        const usersList = document.getElementById('users-list');
        if (users.length > 0) {
          usersList.innerHTML = users.map(user => `
            <div class="user-item">
              <span class="user-name">${user.usuario}</span>
              <span class="user-id">ID: ${user.id}</span>
            </div>
          `).join('');
        } else {
          usersList.innerHTML = '<p>No hay usuarios registrados</p>';
        }
      } catch (error) {
        document.getElementById('users-list').innerHTML = '<p>Error al cargar usuarios</p>';
      }
    }

    // Funciones de accesibilidad mejoradas
    function toggleAccMenu() {
      const menu = document.getElementById('accesibilidad-lista');
      const button = document.querySelector('.menu-toggle');
      const isExpanded = menu.classList.contains('oculto');
      
      menu.classList.toggle('oculto');
      button.setAttribute('aria-expanded', !isExpanded);
      
      announceToScreenReader(`Menú de accesibilidad ${isExpanded ? 'abierto' : 'cerrado'}`);
    }

    function activateHighContrast() {
      document.body.classList.toggle('alto-contraste');
      const isActive = document.body.classList.contains('alto-contraste');
      announceToScreenReader(`Modo alto contraste ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function activateMonochromaticMode() {
      document.body.classList.toggle('monocromatico');
      const isActive = document.body.classList.contains('monocromatico');
      announceToScreenReader(`Modo monocromático ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function increaseTextSize() {
      document.body.classList.remove('texto-pequeno');
      document.body.classList.add('texto-grande');
      announceToScreenReader('Tamaño de texto aumentado');
      updateAccessibilityStatus();
    }

    function decreaseTextSize() {
      document.body.classList.remove('texto-grande');
      document.body.classList.add('texto-pequeno');
      announceToScreenReader('Tamaño de texto reducido');
      updateAccessibilityStatus();
    }

    function adjustSpacing() {
      document.body.classList.toggle('espaciado-ajustado');
      const isActive = document.body.classList.contains('espaciado-ajustado');
      announceToScreenReader(`Espaciado de texto ${isActive ? 'ajustado' : 'normalizado'}`);
      updateAccessibilityStatus();
    }

    function useReadableFont() {
      document.body.classList.toggle('fuente-legible');
      const isActive = document.body.classList.contains('fuente-legible');
      announceToScreenReader(`Fuente legible ${isActive ? 'activada' : 'desactivada'}`);
      updateAccessibilityStatus();
    }

    function activateZoom() {
      document.body.classList.toggle('zoom-pagina');
      const isActive = document.body.classList.contains('zoom-pagina');
      announceToScreenReader(`Zoom de página ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function highlightLinks() {
      document.body.classList.toggle('resaltar-enlaces');
      const isActive = document.body.classList.contains('resaltar-enlaces');
      announceToScreenReader(`Enlaces resaltados ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function pauseAnimations() {
      document.body.classList.toggle('pausar-animaciones');
      const isActive = document.body.classList.contains('pausar-animaciones');
      announceToScreenReader(`Animaciones pausadas ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function readText() {
      if (speechSynthesis.speaking) {
        speechSynthesis.cancel();
        announceToScreenReader('Lectura detenida');
        return;
      }
      
      const textToRead = document.querySelector('main').innerText;
      const speech = new SpeechSynthesisUtterance(textToRead);
      speech.lang = "es-ES";
      speech.rate = 0.9;
      
      speech.onend = () => announceToScreenReader('Lectura completada');
      speech.onerror = () => announceToScreenReader('Error en la lectura');
      
      speechSynthesis.speak(speech);
      announceToScreenReader('Iniciando lectura del contenido');
    }

    function activateAudioDescription() {
      document.body.classList.toggle('descripcion-audio');
      const isActive = document.body.classList.contains('descripcion-audio');
      announceToScreenReader(`Descripción de audio ${isActive ? 'activada' : 'desactivada'}`);
      updateAccessibilityStatus();
    }

    function resetAccessibility() {
      document.body.classList.remove('alto-contraste', 'texto-grande', 'texto-pequeno', 'fuente-legible', 'monocromatico', 'espaciado-ajustado', 'zoom-pagina', 'resaltar-enlaces', 'pausar-animaciones', 'descripcion-audio');
      
      // Resetear funcionalidades de accesibilidad auditiva
      subtitulosActivos = false;
      alertasVisualesActivas = false;
      
      // Detener reconocimiento de voz si está activo
      if (recognition && recognition.state !== 'inactive') {
        recognition.stop();
      }
      
      // Ocultar subtítulos personalizados
      const subtitulosDiv = document.getElementById('subtitulos-custom');
      if (subtitulosDiv) {
        subtitulosDiv.classList.add('oculto');
      }
      
      // Ocultar transcripción
      const transcripcionContainer = document.getElementById('transcripcion-container');
      if (transcripcionContainer) {
        transcripcionContainer.classList.add('oculto');
      }
      
      // Remover indicador de alertas
      const alertIndicator = document.getElementById('alert-indicator');
      if (alertIndicator) {
        alertIndicator.remove();
      }
      
      if (speechSynthesis.speaking) {
        speechSynthesis.cancel();
      }
      
      announceToScreenReader('Configuración de accesibilidad restablecida');
      updateAccessibilityStatus();
    }

    // Funciones para accesibilidad auditiva
    let subtitulosActivos = false;
    let transcripcionActiva = false;
    let alertasVisualesActivas = false;
    let recognition = null;

    function activateSubtitles() {
      subtitulosActivos = !subtitulosActivos;
      const video = document.getElementById('video-ecuador');
      if (video) {
        const tracks = video.textTracks;
        for (let i = 0; i < tracks.length; i++) {
          tracks[i].mode = subtitulosActivos ? 'showing' : 'hidden';
        }
      }
      announceToScreenReader(`Subtítulos cerrados ${subtitulosActivos ? 'activados' : 'desactivados'}`);
      updateAccessibilityStatus();
    }

    function activateLiveSubtitles() {
      if (!recognition) {
        recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = 'es-ES';
        
        recognition.onresult = function(event) {
          const subtitulosDiv = document.getElementById('subtitulos-custom');
          let interimTranscript = '';
          let finalTranscript = '';
          
          for (let i = event.resultIndex; i < event.results.length; i++) {
            const transcript = event.results[i][0].transcript;
            if (event.results[i].isFinal) {
              finalTranscript += transcript;
            } else {
              interimTranscript += transcript;
            }
          }
          
          if (subtitulosDiv) {
            subtitulosDiv.innerHTML = `<span class="final">${finalTranscript}</span><span class="interim">${interimTranscript}</span>`;
          }
        };
      }
      
      if (recognition && recognition.state === 'inactive') {
        recognition.start();
        announceToScreenReader('Subtítulos en directo activados');
      } else if (recognition) {
        recognition.stop();
        announceToScreenReader('Subtítulos en directo desactivados');
      }
    }

    function downloadTranscription() {
      const transcription = `
TRANSCRIPCIÓN DEL CONTENIDO MULTIMEDIA
Portal Turístico Ecuador
Fecha: ${new Date().toLocaleDateString()}

VIDEO PROMOCIONAL DE ECUADOR:
"Bienvenidos a Ecuador, un país lleno de diversidad y belleza natural. 
Desde las playas del Pacífico hasta las cumbres de los Andes, 
Ecuador ofrece experiencias únicas para todos los viajeros.

En la costa, podrás disfrutar de hermosas playas como Salinas y Manta, 
con aguas cálidas y excelente gastronomía marina.

En la sierra, ciudades como Cuenca te transportarán al pasado colonial, 
con su arquitectura histórica y artesanías tradicionales.

Y en la Amazonía, la selva más biodiversa del mundo te espera 
con sus ríos, cascadas y comunidades indígenas.

Ecuador, un país pequeño pero gigante en experiencias."

AUDIO GUÍA TURÍSTICA:
"Esta guía te llevará por los principales destinos turísticos de Ecuador.
Cada región tiene su propio encanto y cultura única.
Te invitamos a explorar y descubrir la magia de nuestro país."

---
Generado automáticamente por el Portal Turístico Ecuador
      `;
      
      const blob = new Blob([transcription], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'transcripcion-ecuador.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      announceToScreenReader('Transcripción descargada exitosamente');
    }

    function showAudioControls() {
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `
        <div class="modal-content">
          <span class="cerrar" onclick="this.parentElement.parentElement.remove()">&times;</span>
          <h3>Controles de Audio</h3>
          <div class="audio-controls-panel">
            <div class="control-group">
              <label for="volume-slider">Volumen:</label>
              <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1" 
                     onchange="setVolume(this.value)" aria-label="Control de volumen">
              <span id="volume-display">100%</span>
            </div>
            <div class="control-group">
              <button onclick="muteAll()" class="btn-control">
                <span aria-hidden="true">🔇</span> Silenciar todo
              </button>
              <button onclick="unmuteAll()" class="btn-control">
                <span aria-hidden="true">🔊</span> Activar todo
              </button>
            </div>
            <div class="control-group">
              <label>
                <input type="checkbox" id="disable-autoplay" onchange="toggleAutoplay(this.checked)">
                Deshabilitar reproducción automática
              </label>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      modal.classList.remove('oculto');
      announceToScreenReader('Panel de controles de audio abierto');
    }

    function activateVisualAlerts() {
      alertasVisualesActivas = !alertasVisualesActivas;
      document.body.classList.toggle('alertas-visuales', alertasVisualesActivas);
      
      if (alertasVisualesActivas) {
        // Crear indicador visual de alertas
        const alertIndicator = document.createElement('div');
        alertIndicator.id = 'alert-indicator';
        alertIndicator.className = 'alert-indicator';
        alertIndicator.innerHTML = `
          <div class="alert-light"></div>
          <span>Alertas visuales activas</span>
        `;
        document.body.appendChild(alertIndicator);
        
        // Simular alerta visual
        setTimeout(() => {
          showVisualAlert('Nueva notificación disponible');
        }, 2000);
      } else {
        const indicator = document.getElementById('alert-indicator');
        if (indicator) {
          indicator.remove();
        }
      }
      
      announceToScreenReader(`Alertas visuales ${alertasVisualesActivas ? 'activadas' : 'desactivadas'}`);
      updateAccessibilityStatus();
    }

    // Funciones auxiliares para multimedia
    function toggleSubtitulos() {
      const video = document.getElementById('video-ecuador');
      const subtitulosDiv = document.getElementById('subtitulos-custom');
      
      if (video && subtitulosDiv) {
        subtitulosDiv.classList.toggle('oculto');
        if (!subtitulosDiv.classList.contains('oculto')) {
          // Simular subtítulos personalizados
          const subtitulos = [
            { tiempo: 0, texto: "Bienvenidos a Ecuador" },
            { tiempo: 3, texto: "Un país lleno de diversidad" },
            { tiempo: 6, texto: "Desde las playas hasta las montañas" },
            { tiempo: 9, texto: "Descubre la magia de nuestro país" }
          ];
          
          let currentIndex = 0;
          const interval = setInterval(() => {
            if (currentIndex < subtitulos.length) {
              subtitulosDiv.textContent = subtitulos[currentIndex].texto;
              currentIndex++;
            } else {
              clearInterval(interval);
            }
          }, 3000);
        }
      }
    }

    function toggleTranscripcion() {
      const container = document.getElementById('transcripcion-container');
      if (container) {
        container.classList.toggle('oculto');
        if (!container.classList.contains('oculto')) {
          const texto = document.getElementById('transcripcion-texto');
          texto.innerHTML = `
            <p><strong>Transcripción del video:</strong></p>
            <p>Bienvenidos a Ecuador, un país lleno de diversidad y belleza natural. 
            Desde las playas del Pacífico hasta las cumbres de los Andes, 
            Ecuador ofrece experiencias únicas para todos los viajeros.</p>
            <p>En la costa, podrás disfrutar de hermosas playas como Salinas y Manta, 
            con aguas cálidas y excelente gastronomía marina.</p>
            <p>En la sierra, ciudades como Cuenca te transportarán al pasado colonial, 
            con su arquitectura histórica y artesanías tradicionales.</p>
          `;
        }
      }
    }

    function toggleMute() {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.muted = !audio.muted;
        announceToScreenReader(`Audio ${audio.muted ? 'silenciado' : 'activado'}`);
      }
    }

    function ajustarVolumen(nivel) {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.volume = nivel;
        announceToScreenReader(`Volumen ajustado al ${Math.round(nivel * 100)}%`);
      }
    }

    function showVisualAlert(message) {
      if (!alertasVisualesActivas) return;
      
      const alert = document.createElement('div');
      alert.className = 'visual-alert';
      alert.innerHTML = `
        <div class="alert-content">
          <span class="alert-icon">⚠️</span>
          <span class="alert-message">${message}</span>
        </div>
      `;
      document.body.appendChild(alert);
      
      setTimeout(() => {
        alert.classList.add('fade-out');
        setTimeout(() => alert.remove(), 500);
      }, 3000);
    }

    function setVolume(value) {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.volume = value;
        document.getElementById('volume-display').textContent = `${Math.round(value * 100)}%`;
      }
    }

    function muteAll() {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.muted = true;
        audio.volume = 0;
        document.getElementById('volume-slider').value = 0;
        document.getElementById('volume-display').textContent = '0%';
      }
      announceToScreenReader('Todo el audio ha sido silenciado');
    }

    function unmuteAll() {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.muted = false;
        audio.volume = 1;
        document.getElementById('volume-slider').value = 1;
        document.getElementById('volume-display').textContent = '100%';
      }
      announceToScreenReader('Audio activado');
    }

    function toggleAutoplay(disabled) {
      const video = document.getElementById('video-ecuador');
      const audio = document.getElementById('audio-guia');
      
      if (video) video.autoplay = !disabled;
      if (audio) audio.autoplay = !disabled;
      
      announceToScreenReader(`Reproducción automática ${disabled ? 'deshabilitada' : 'habilitada'}`);
    }

    // Funciones para destinos
    function showDestinationDetails(destinationName) {
      const destinations = {
        'Cuenca': {
          description: 'Cuenca es una ciudad del sur de Ecuador, capital de la provincia del Azuay. Es conocida por su centro histórico declarado Patrimonio de la Humanidad por la UNESCO.',
          accessibility: 'La ciudad cuenta con rampas de acceso en la mayoría de edificios históricos y transporte público adaptado.',
          attractions: ['Centro Histórico', 'Catedral Nueva', 'Museo Pumapungo', 'Mercado 10 de Agosto']
        },
        'Salinas': {
          description: 'Salinas es una ciudad costera en la provincia de Santa Elena, conocida por sus hermosas playas y excelente infraestructura turística.',
          accessibility: 'Playas con acceso para sillas de ruedas y hoteles con habitaciones adaptadas.',
          attractions: ['Playa de Salinas', 'Malecón', 'Museo del Mar', 'Restaurantes de mariscos']
        },
        'Manta': {
          description: 'Manta es un importante puerto pesquero y ciudad turística en la provincia de Manabí.',
          accessibility: 'Transporte público adaptado y guías turísticos especializados en accesibilidad.',
          attractions: ['Puerto Pesquero', 'Playa de Manta', 'Museo del Banco Central', 'Malecon 2000']
        }
      };
      
      const dest = destinations[destinationName];
      if (dest) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = `
          <div class="modal-content destination-modal">
            <span class="cerrar" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>${destinationName}</h2>
            <p>${dest.description}</p>
            <h3>Accesibilidad</h3>
            <p>${dest.accessibility}</p>
            <h3>Atracciones Principales</h3>
            <ul>
              ${dest.attractions.map(attr => `<li>${attr}</li>`).join('')}
            </ul>
            <button onclick="this.parentElement.parentElement.remove()" class="btn-destino">Cerrar</button>
          </div>
        `;
        document.body.appendChild(modal);
        modal.classList.remove('oculto');
      }
    }

    // Funciones para el menú principal mejorado
    let currentPage = 'inicio';
    let mobileMenuOpen = false;

    function toggleMobileMenu() {
      const menu = document.getElementById('menu-principal');
      const button = document.querySelector('.menu-toggle-mobile');
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      
      mobileMenuOpen = !mobileMenuOpen;
      menu.classList.toggle('active', mobileMenuOpen);
      button.setAttribute('aria-expanded', !isExpanded);
      
      if (mobileMenuOpen) {
        button.innerHTML = '<span class="hamburger-icon" aria-hidden="true">✕</span><span class="menu-text">Cerrar</span>';
        announceToScreenReader('Menú móvil abierto');
      } else {
        button.innerHTML = '<span class="hamburger-icon" aria-hidden="true">☰</span><span class="menu-text">Menú</span>';
        announceToScreenReader('Menú móvil cerrado');
      }
    }

    function setActiveMenuItem(pageId) {
      // Remover clase active de todos los elementos
      const menuItems = document.querySelectorAll('.menu-item');
      menuItems.forEach(item => {
        item.classList.remove('active');
        item.removeAttribute('aria-current');
      });
      
      // Agregar clase active al elemento correspondiente
      const activeItem = document.querySelector(`[href="#${pageId}"]`);
      if (activeItem) {
        activeItem.classList.add('active');
        activeItem.setAttribute('aria-current', 'page');
      }
      
      currentPage = pageId;
      announceToScreenReader(`Navegando a ${pageId}`);
    }

    function scrollToSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) {
        section.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start' 
        });
        setActiveMenuItem(sectionId);
        announceToScreenReader(`Sección ${sectionId} visible`);
      }
    }

    // Navegación por teclado mejorada para el menú
    function setupMenuKeyboardNavigation() {
      const menuItems = document.querySelectorAll('.menu-item');
      const menuSections = document.querySelectorAll('.menu-section');
      
      // Navegación entre secciones
      menuSections.forEach((section, sectionIndex) => {
        const sectionItems = section.querySelectorAll('.menu-item');
        
        sectionItems.forEach((item, itemIndex) => {
          item.addEventListener('keydown', function(event) {
            switch(event.key) {
              case 'ArrowRight':
                event.preventDefault();
                const nextItem = itemIndex < sectionItems.length - 1 ? 
                  sectionItems[itemIndex + 1] : 
                  (sectionIndex < menuSections.length - 1 ? 
                    menuSections[sectionIndex + 1].querySelector('.menu-item') : 
                    sectionItems[0]);
                nextItem.focus();
                break;
                
              case 'ArrowLeft':
                event.preventDefault();
                const prevItem = itemIndex > 0 ? 
                  sectionItems[itemIndex - 1] : 
                  (sectionIndex > 0 ? 
                    menuSections[sectionIndex - 1].querySelectorAll('.menu-item') : 
                    sectionItems);
                const prevItemElement = Array.isArray(prevItem) ? 
                  prevItem[prevItem.length - 1] : prevItem;
                prevItemElement.focus();
                break;
                
              case 'ArrowDown':
                event.preventDefault();
                const nextSection = sectionIndex < menuSections.length - 1 ? 
                  menuSections[sectionIndex + 1] : menuSections[0];
                const nextSectionItem = nextSection.querySelector('.menu-item');
                nextSectionItem.focus();
                break;
                
              case 'ArrowUp':
                event.preventDefault();
                const prevSection = sectionIndex > 0 ? 
                  menuSections[sectionIndex - 1] : menuSections[menuSections.length - 1];
                const prevSectionItem = prevSection.querySelector('.menu-item');
                prevSectionItem.focus();
                break;
                
              case 'Enter':
              case ' ':
                event.preventDefault();
                if (item.tagName === 'A') {
                  item.click();
                } else if (item.tagName === 'BUTTON') {
                  item.click();
                }
                break;
                
              case 'Escape':
                if (mobileMenuOpen) {
                  toggleMobileMenu();
                }
                break;
            }
          });
        });
      });
    }

    // Función para cerrar menú móvil al hacer clic fuera
    function setupMenuClickOutside() {
      document.addEventListener('click', function(event) {
        const menu = document.getElementById('menu-principal');
        const menuToggle = document.querySelector('.menu-toggle-mobile');
        
        if (mobileMenuOpen && 
            !menu.contains(event.target) && 
            !menuToggle.contains(event.target)) {
          toggleMobileMenu();
        }
      });
    }

    // Función para manejar cambios de tamaño de ventana
    function handleResize() {
      if (window.innerWidth > 768 && mobileMenuOpen) {
        toggleMobileMenu();
      }
    }

    // Función para mostrar breadcrumbs
    function updateBreadcrumbs() {
      const breadcrumbs = document.getElementById('breadcrumbs');
      if (breadcrumbs) {
        const pageNames = {
          'inicio': 'Inicio',
          'rutas': 'Rutas',
          'alojamientos': 'Alojamientos',
          'accesibilidad': 'Accesibilidad',
          'contacto': 'Contacto',
          'login': 'Iniciar Sesión',
          'register': 'Registrarse'
        };
        
        breadcrumbs.innerHTML = `
          <a href="#inicio">Inicio</a>
          ${currentPage !== 'inicio' ? ` > <span>${pageNames[currentPage] || currentPage}</span>` : ''}
        `;
      }
    }

    // Función para mostrar indicador de progreso
    function showProgressIndicator() {
      const progress = document.createElement('div');
      progress.className = 'progress-indicator';
      progress.innerHTML = `
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
      `;
      document.body.appendChild(progress);
      
      setTimeout(() => {
        progress.remove();
      }, 1000);
    }

    // Navegación por teclado
    document.addEventListener('keydown', function(event) {
      // Navegación con Tab
      if (event.key === 'Tab') {
        document.body.classList.add('keyboard-navigation');
      }
      
      // Navegación con teclas de flecha en el menú de accesibilidad
      if (event.key === 'ArrowDown' || event.key === 'ArrowUp') {
        const menu = document.getElementById('accesibilidad-lista');
        if (!menu.classList.contains('oculto')) {
          event.preventDefault();
          const buttons = menu.querySelectorAll('button');
          const currentIndex = Array.from(buttons).findIndex(btn => btn === document.activeElement);
          
          if (currentIndex !== -1) {
            let newIndex;
            if (event.key === 'ArrowDown') {
              newIndex = (currentIndex + 1) % buttons.length;
            } else {
              newIndex = currentIndex > 0 ? currentIndex - 1 : buttons.length - 1;
            }
            buttons[newIndex].focus();
          }
        }
      }
      
      // Cerrar menú con Escape
      if (event.key === 'Escape') {
        const menu = document.getElementById('accesibilidad-lista');
        if (!menu.classList.contains('oculto')) {
          toggleAccMenu();
        }
      }
      
      // Atajos de teclado para accesibilidad
      if (event.ctrlKey || event.metaKey) {
        switch(event.key) {
          case '1':
            event.preventDefault();
            activateHighContrast();
            break;
          case '2':
            event.preventDefault();
            activateMonochromaticMode();
            break;
          case '3':
            event.preventDefault();
            increaseTextSize();
            break;
          case '4':
            event.preventDefault();
            decreaseTextSize();
            break;
          case '5':
            event.preventDefault();
            adjustSpacing();
            break;
          case '6':
            event.preventDefault();
            useReadableFont();
            break;
          case '7':
            event.preventDefault();
            activateZoom();
            break;
          case '8':
            event.preventDefault();
            highlightLinks();
            break;
          case '9':
            event.preventDefault();
            pauseAnimations();
            break;
          case '0':
            event.preventDefault();
            resetAccessibility();
            break;
        }
      }
    });

    document.addEventListener('mousedown', function() {
      document.body.classList.remove('keyboard-navigation');
    });

    // Mejorar navegación por teclado para el menú principal
    function setupKeyboardNavigation() {
      const navItems = document.querySelectorAll('.nav a');
      navItems.forEach((item, index) => {
        item.addEventListener('keydown', function(event) {
          if (event.key === 'ArrowRight') {
            event.preventDefault();
            const nextIndex = (index + 1) % navItems.length;
            navItems[nextIndex].focus();
          } else if (event.key === 'ArrowLeft') {
            event.preventDefault();
            const prevIndex = index > 0 ? index - 1 : navItems.length - 1;
            navItems[prevIndex].focus();
          }
        });
      });
    }

    // Función para mostrar información de accesibilidad
    function showAccessibilityInfo() {
      const info = `
        <div class="accessibility-info">
          <h3>Información de Accesibilidad</h3>
          <p>Este sitio web incluye las siguientes características de accesibilidad:</p>
          <ul>
            <li><strong>Alto contraste:</strong> Mejora la visibilidad del texto y elementos</li>
            <li><strong>Modo monocromático:</strong> Convierte todos los colores a escala de grises</li>
            <li><strong>Ajuste de texto:</strong> Aumentar o reducir el tamaño del texto</li>
            <li><strong>Espaciado:</strong> Ajustar el espaciado entre líneas, palabras y caracteres</li>
            <li><strong>Fuente legible:</strong> Cambiar a una fuente más fácil de leer</li>
            <li><strong>Zoom de página:</strong> Ampliar todo el contenido de la página</li>
            <li><strong>Resaltado de enlaces:</strong> Destacar enlaces y elementos de foco</li>
            <li><strong>Pausar animaciones:</strong> Detener todas las animaciones</li>
            <li><strong>Lectura de texto:</strong> Leer el contenido en voz alta</li>
            <li><strong>Descripción de audio:</strong> Proporcionar descripciones de audio</li>
          </ul>
          <p><strong>Atajos de teclado:</strong></p>
          <ul>
            <li>Ctrl+1: Alto contraste</li>
            <li>Ctrl+2: Modo monocromático</li>
            <li>Ctrl+3: Aumentar texto</li>
            <li>Ctrl+4: Reducir texto</li>
            <li>Ctrl+5: Ajustar espaciado</li>
            <li>Ctrl+6: Fuente legible</li>
            <li>Ctrl+7: Zoom de página</li>
            <li>Ctrl+8: Resaltar enlaces</li>
            <li>Ctrl+9: Pausar animaciones</li>
            <li>Ctrl+0: Restablecer todo</li>
          </ul>
          <button onclick="this.parentElement.remove()" class="btn-destino">Cerrar</button>
        </div>
      `;
      
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `<div class="modal-content">${info}</div>`;
      document.body.appendChild(modal);
      modal.classList.remove('oculto');
    }

    // Inicialización
    document.addEventListener('DOMContentLoaded', function() {
      initializeMap();
      initializeBanner();
      
      // Alias para compatibilidad
      window.mostrarModal = showModal;
      window.cerrarModal = closeModal;
      window.activarContraste = activateHighContrast;
      window.activarModoMonocromatico = activateMonochromaticMode;
      window.aumentarTexto = increaseTextSize;
      window.reducirTexto = decreaseTextSize;
      window.ajustarEspaciado = adjustSpacing;
      window.usarFuenteLegible = useReadableFont;
      window.activarZoom = activateZoom;
      window.resaltarEnlaces = highlightLinks;
      window.pausarAnimaciones = pauseAnimations;
      window.restablecerAccesibilidad = resetAccessibility;
      window.leerTexto = readText;
      window.activarDescripcionAudio = activateAudioDescription;
      window.activarSubtitulos = activateSubtitles;
      window.activarSubtitulosDirecto = activateLiveSubtitles;
      window.descargarTranscripcion = downloadTranscription;
      window.mostrarControlesAudio = showAudioControls;
      window.activarAlertasVisuales = activateVisualAlerts;
      window.mostrarInfoAccesibilidad = showAccessibilityInfo;
      window.mostrarPanelAdmin = showAdminPanel;
      window.showDestinationDetails = showDestinationDetails;
      window.togglePasswordVisibility = togglePasswordVisibility;
      window.mostrarRecuperarPassword = mostrarRecuperarPassword;
      window.enviarRecuperacion = enviarRecuperacion;
      window.mostrarModalContacto = mostrarModalContacto;
      
      setupKeyboardNavigation(); // Inicializar la navegación por teclado para el menú principal
      setupMenuKeyboardNavigation(); // Inicializar la navegación por teclado para el menú principal mejorado
      setupMenuClickOutside(); // Inicializar el cierre de menú al hacer clic fuera
      window.addEventListener('resize', handleResize); // Inicializar el manejo de tamaño de ventana
      updateBreadcrumbs(); // Inicializar las breadcrumbs
      showProgressIndicator(); // Inicializar el indicador de progreso
      
      // Inicializar funciones del formulario de login
      setupRealTimeValidation();
      loadRememberedUser();
      
      // Inicializar funciones del formulario de registro
      setupRegistroRealTimeValidation();
    });

    // Guardar token y rol tras login
    function guardarSesion(token, rol) {
      localStorage.setItem('token', token);
      localStorage.setItem('rol', rol);
    }

    // Mostrar/ocultar botón de registro de admin según el rol
    function actualizarUIporRol() {
      const rol = localStorage.getItem('rol');
      const btnAdmin = document.getElementById('btn-registro-admin');
      if (rol === 'admin') {
        if (!btnAdmin) {
          const btn = document.createElement('button');
          btn.id = 'btn-registro-admin';
          btn.className = 'btn-outline';
          btn.innerText = 'Registrar Admin';
          btn.onclick = () => mostrarModal('modal-admin');
          document.querySelector('.custom-buttons').appendChild(btn);
        }
      } else if (btnAdmin) {
        btnAdmin.remove();
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      actualizarUIporRol();
    });

    // Login mejorado: guardar token y rol
    const formLogin = document.getElementById('form-login');
    if (formLogin) {
      formLogin.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Limpiar estado anterior
        clearLoginStatus();
        
        // Validar formulario
        if (!validateLoginForm()) {
          return;
        }
        
        // Verificar intentos de login
        if (!checkLoginAttempts()) {
          return;
        }
        
        // Mostrar CAPTCHA si es necesario
        if (loginAttempts >= 2) {
          showCaptcha();
          if (!validateCaptcha()) {
            return;
          }
        }
        
        const usuario = document.getElementById('login-usuario').value.trim();
        const clave = document.getElementById('login-clave').value;
        
        // Mostrar estado de carga
        setLoginButtonLoading(true);
        showLoginStatus('Verificando credenciales...', 'info');
        
        try {
          const startTime = Date.now();
          
          const res = await fetch(`${API_BASE_URL}/login`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ usuario, clave })
          });
          
          const data = await res.json();
          const endTime = Date.now();
          const responseTime = endTime - startTime;
          
          // Verificar tiempo de respuesta
          if (responseTime > 15000) {
            showLoginStatus('La respuesta del servidor fue lenta. Intenta nuevamente.', 'error');
            setLoginButtonLoading(false);
            return;
          }
          
          if (res.ok) {
            // Login exitoso
            guardarSesion(data.token, data.rol);
            actualizarUIporRol();
            
            // Recordar usuario si está marcado
            rememberUser(usuario);
            
            // Resetear intentos
            loginAttempts = 0;
            
            showLoginStatus('¡Inicio de sesión exitoso! Redirigiendo...', 'success');
            announceToScreenReader('Inicio de sesión exitoso');
            
            // Cerrar modal después de un breve delay
            setTimeout(() => {
              cerrarModal('modal-login');
              showNotification('Bienvenido al Portal Turístico Ecuador', 'success');
            }, 1500);
            
          } else {
            // Login fallido
            loginAttempts++;
            lastLoginAttempt = Date.now();
            
            // Mensaje neutro para evitar ataques de enumeración
            const errorMessage = 'Usuario o contraseña incorrectos. Verifica tus credenciales.';
            showLoginStatus(errorMessage, 'error');
            announceToScreenReader('Error de autenticación');
            
            // Mostrar CAPTCHA en el siguiente intento
            if (loginAttempts >= 2) {
              showLoginStatus('Se requiere verificación adicional para continuar.', 'info');
            }
            
            setLoginButtonLoading(false);
          }
          
        } catch (error) {
          console.error('Error en login:', error);
          showLoginStatus('Error de conexión. Verifica tu conexión a internet e intenta nuevamente.', 'error');
          setLoginButtonLoading(false);
        }
      });
    }

    // Registro usuario normal mejorado
    const formRegistro = document.getElementById('form-registro');
    if (formRegistro) {
      formRegistro.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Limpiar estado anterior
        clearRegistroStatus();
        
        // Validar formulario
        if (!validateRegistroForm()) {
          return;
        }
        
        // Obtener datos del formulario
        const formData = {
          nombre: document.getElementById('nombre').value.trim(),
          cedula: document.getElementById('cedula').value.trim(),
          email: document.getElementById('email').value.trim(),
          telefono: document.getElementById('telefono').value.trim() || null,
          usuario: document.getElementById('usuario').value.trim(),
          clave: document.getElementById('clave').value,
          recibirNotificaciones: document.getElementById('recibir-notificaciones').checked
        };
        
        // Mostrar estado de carga
        setRegistroButtonLoading(true);
        showRegistroStatus('Creando tu cuenta...', 'info');
        
        try {
          const startTime = Date.now();
          
          const res = await fetch(`${API_BASE_URL}/registro`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          
          const data = await res.json();
          const endTime = Date.now();
          const responseTime = endTime - startTime;
          
          // Verificar tiempo de respuesta
          if (responseTime > 15000) {
            showRegistroStatus('La respuesta del servidor fue lenta. Intenta nuevamente.', 'error');
            setRegistroButtonLoading(false);
            return;
          }
          
          if (res.ok) {
            // Registro exitoso
            showRegistroStatus('¡Cuenta creada exitosamente! Redirigiendo...', 'success');
            announceToScreenReader('Cuenta creada exitosamente');
            
            // Cerrar modal después de un breve delay
            setTimeout(() => {
              cerrarModal('modal-auth');
              showNotification('¡Bienvenido al Portal Turístico Ecuador!', 'success');
              
              // Opcional: abrir modal de login
              setTimeout(() => {
                mostrarModal('modal-login');
              }, 1000);
            }, 2000);
            
          } else {
            // Registro fallido
            const errorMessage = data.mensaje || 'Error al crear la cuenta. Verifica los datos e intenta nuevamente.';
            showRegistroStatus(errorMessage, 'error');
            announceToScreenReader('Error al crear cuenta');
            setRegistroButtonLoading(false);
          }
          
        } catch (error) {
          console.error('Error en registro:', error);
          showRegistroStatus('Error de conexión. Verifica tu conexión a internet e intenta nuevamente.', 'error');
          setRegistroButtonLoading(false);
        }
      });
    }

    // Registro administrador (solo admins)
    const formRegistroAdmin = document.getElementById('form-registro-admin');
    if (formRegistroAdmin) {
      formRegistroAdmin.addEventListener('submit', async (e) => {
        e.preventDefault();
        const usuario = document.getElementById('admin-usuario').value;
        const clave = document.getElementById('admin-clave').value;
        const email = document.getElementById('admin-email').value;
        const token = localStorage.getItem('token');
        const res = await fetch(`${API_BASE_URL}/registro_admin`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ usuario, clave, email })
        });
        const data = await res.json();
        if (res.ok) {
          showNotification('Administrador registrado con éxito', 'success');
          cerrarModal('modal-admin');
        } else {
          showNotification(data.mensaje || 'Error al registrar admin', 'error');
        }
      });
    }

    // Funciones para el formulario de login mejorado
    let loginAttempts = 0;
    let lastLoginAttempt = 0;
    const MAX_LOGIN_ATTEMPTS = 3;
    const LOCKOUT_TIME = 300000; // 5 minutos

    function togglePasswordVisibility(inputId) {
      const input = document.getElementById(inputId);
      const toggle = input.parentElement.querySelector('.password-toggle');
      const icon = toggle.querySelector('.toggle-icon');
      
      if (input.type === 'password') {
        input.type = 'text';
        toggle.setAttribute('aria-pressed', 'true');
        toggle.setAttribute('aria-label', 'Ocultar contraseña');
        icon.textContent = '🙈';
      } else {
        input.type = 'password';
        toggle.setAttribute('aria-pressed', 'false');
        toggle.setAttribute('aria-label', 'Mostrar contraseña');
        icon.textContent = '👁️';
      }
    }

    function validateLoginForm() {
      const usuario = document.getElementById('login-usuario');
      const clave = document.getElementById('login-clave');
      const usuarioError = document.getElementById('login-usuario-error');
      const claveError = document.getElementById('login-clave-error');
      
      let isValid = true;
      
      // Limpiar errores anteriores
      clearLoginErrors();
      
      // Validar usuario
      if (!usuario.value.trim()) {
        showFieldError(usuarioError, 'El nombre de usuario es requerido');
        isValid = false;
      } else if (usuario.value.trim().length < 3) {
        showFieldError(usuarioError, 'El nombre de usuario debe tener al menos 3 caracteres');
        isValid = false;
      }
      
      // Validar contraseña
      if (!clave.value) {
        showFieldError(claveError, 'La contraseña es requerida');
        isValid = false;
      } else if (clave.value.length < 6) {
        showFieldError(claveError, 'La contraseña debe tener al menos 6 caracteres');
        isValid = false;
      }
      
      return isValid;
    }

    function showFieldError(errorElement, message) {
      errorElement.textContent = message;
      errorElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearLoginErrors() {
      const errorElements = document.querySelectorAll('#form-login .error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    function showLoginStatus(message, type = 'info') {
      const statusElement = document.getElementById('login-status');
      statusElement.textContent = message;
      statusElement.className = `login-status ${type}`;
      statusElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearLoginStatus() {
      const statusElement = document.getElementById('login-status');
      statusElement.style.display = 'none';
      statusElement.textContent = '';
    }

    function setLoginButtonLoading(loading) {
      const button = document.getElementById('login-submit-btn');
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        button.querySelector('.btn-text').textContent = 'Iniciando sesión...';
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        button.querySelector('.btn-text').textContent = 'Iniciar Sesión';
      }
    }

    function checkLoginAttempts() {
      const now = Date.now();
      
      // Si han pasado más de 5 minutos, resetear intentos
      if (now - lastLoginAttempt > LOCKOUT_TIME) {
        loginAttempts = 0;
      }
      
      if (loginAttempts >= MAX_LOGIN_ATTEMPTS) {
        const remainingTime = Math.ceil((LOCKOUT_TIME - (now - lastLoginAttempt)) / 1000);
        showLoginStatus(`Demasiados intentos fallidos. Intenta nuevamente en ${remainingTime} segundos.`, 'error');
        setLoginButtonLoading(false);
        return false;
      }
      
      return true;
    }

    function showCaptcha() {
      const captchaContainer = document.getElementById('captcha-container');
      const captchaText = document.getElementById('captcha-text');
      
      const captchaQuestions = [
        '¿Cuál es la capital de Ecuador?',
        '¿En qué continente está Ecuador?',
        '¿Cuál es el color de la bandera de Ecuador?',
        '¿Cuál es la moneda de Ecuador?'
      ];
      
      const captchaAnswers = [
        'quito',
        'america',
        'amarillo',
        'dolar'
      ];
      
      const randomIndex = Math.floor(Math.random() * captchaQuestions.length);
      captchaText.textContent = captchaQuestions[randomIndex];
      captchaText.setAttribute('data-answer', captchaAnswers[randomIndex]);
      
      captchaContainer.style.display = 'block';
      announceToScreenReader('Se requiere verificación de seguridad');
    }

    function validateCaptcha() {
      const captchaContainer = document.getElementById('captcha-container');
      const captchaAnswer = document.getElementById('captcha-answer');
      const captchaText = document.getElementById('captcha-text');
      
      if (captchaContainer.style.display === 'block') {
        const userAnswer = captchaAnswer.value.toLowerCase().trim();
        const correctAnswer = captchaText.getAttribute('data-answer');
        
        if (userAnswer !== correctAnswer) {
          showLoginStatus('Respuesta de verificación incorrecta. Intenta nuevamente.', 'error');
          return false;
        }
      }
      
      return true;
    }

    function rememberUser(username) {
      const rememberCheckbox = document.getElementById('remember-user');
      if (rememberCheckbox.checked) {
        localStorage.setItem('rememberedUser', username);
        announceToScreenReader('Usuario recordado');
      } else {
        localStorage.removeItem('rememberedUser');
      }
    }

    function loadRememberedUser() {
      const rememberedUser = localStorage.getItem('rememberedUser');
      if (rememberedUser) {
        const usuarioInput = document.getElementById('login-usuario');
        usuarioInput.value = rememberedUser;
        document.getElementById('remember-user').checked = true;
        announceToScreenReader('Usuario recordado cargado');
      }
    }

    function mostrarRecuperarPassword() {
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `
        <div class="modal-content login-modal">
          <span class="cerrar" onclick="this.parentElement.parentElement.remove()">&times;</span>
          <div class="login-header">
            <div class="login-icon" aria-hidden="true">🔑</div>
            <h2>Recuperar Contraseña</h2>
            <p>Ingresa tu correo electrónico para recibir instrucciones</p>
          </div>
          <form onsubmit="enviarRecuperacion(event)">
            <div class="form-group">
              <label for="recovery-email" class="form-label">
                <span class="label-icon" aria-hidden="true">📧</span>
                Correo Electrónico
              </label>
              <input 
                type="email" 
                id="recovery-email" 
                required 
                class="form-input"
                placeholder="tu@email.com"
                autocomplete="email"
              />
            </div>
            <button type="submit" class="btn-login-submit">
              <span class="btn-icon" aria-hidden="true">📤</span>
              <span class="btn-text">Enviar Instrucciones</span>
            </button>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
      modal.classList.remove('oculto');
      announceToScreenReader('Modal de recuperación de contraseña abierto');
    }

    function enviarRecuperacion(event) {
      event.preventDefault();
      const email = document.getElementById('recovery-email').value;
      
      // Simular envío de recuperación
      showNotification('Instrucciones enviadas a tu correo electrónico', 'success');
      announceToScreenReader('Instrucciones de recuperación enviadas');
      
      // Cerrar modal
      event.target.closest('.modal').remove();
    }

    // Validación en tiempo real
    function setupRealTimeValidation() {
      const usuario = document.getElementById('login-usuario');
      const clave = document.getElementById('login-clave');
      
      usuario.addEventListener('input', function() {
        const errorElement = document.getElementById('login-usuario-error');
        if (this.value.trim().length >= 3) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El nombre de usuario debe tener al menos 3 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      clave.addEventListener('input', function() {
        const errorElement = document.getElementById('login-clave-error');
        if (this.value.length >= 6) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.length > 0) {
          showFieldError(errorElement, 'La contraseña debe tener al menos 6 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
    }

    // Funciones para el formulario de registro mejorado
    function validateRegistroForm() {
      const nombre = document.getElementById('nombre');
      const cedula = document.getElementById('cedula');
      const email = document.getElementById('email');
      const telefono = document.getElementById('telefono');
      const usuario = document.getElementById('usuario');
      const clave = document.getElementById('clave');
      const confirmarClave = document.getElementById('confirmar-clave');
      const aceptarTerminos = document.getElementById('aceptar-terminos');
      
      let isValid = true;
      
      // Limpiar errores anteriores
      clearRegistroErrors();
      
      // Validar nombre
      if (!nombre.value.trim()) {
        showFieldError('nombre-error', 'El nombre completo es requerido');
        isValid = false;
      } else if (nombre.value.trim().length < 2) {
        showFieldError('nombre-error', 'El nombre debe tener al menos 2 caracteres');
        isValid = false;
      }
      
      // Validar cédula
      if (!cedula.value.trim()) {
        showFieldError('cedula-error', 'La cédula de identidad es requerida');
        isValid = false;
      } else if (!/^[0-9]{10}$/.test(cedula.value.trim())) {
        showFieldError('cedula-error', 'La cédula debe tener exactamente 10 dígitos');
        isValid = false;
      }
      
      // Validar email
      if (!email.value.trim()) {
        showFieldError('email-error', 'El correo electrónico es requerido');
        isValid = false;
      } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) {
        showFieldError('email-error', 'Ingresa un correo electrónico válido');
        isValid = false;
      }
      
      // Validar teléfono (opcional)
      if (telefono.value.trim() && !/^[0-9]{10}$/.test(telefono.value.trim())) {
        showFieldError('telefono-error', 'El teléfono debe tener 10 dígitos');
        isValid = false;
      }
      
      // Validar usuario
      if (!usuario.value.trim()) {
        showFieldError('usuario-error', 'El nombre de usuario es requerido');
        isValid = false;
      } else if (usuario.value.trim().length < 3) {
        showFieldError('usuario-error', 'El nombre de usuario debe tener al menos 3 caracteres');
        isValid = false;
      } else if (!/^[a-zA-Z0-9_]+$/.test(usuario.value.trim())) {
        showFieldError('usuario-error', 'Solo se permiten letras, números y guiones bajos');
        isValid = false;
      }
      
      // Validar contraseña
      if (!clave.value) {
        showFieldError('clave-error', 'La contraseña es requerida');
        isValid = false;
      } else if (clave.value.length < 8) {
        showFieldError('clave-error', 'La contraseña debe tener al menos 8 caracteres');
        isValid = false;
      } else if (!/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(clave.value)) {
        showFieldError('clave-error', 'La contraseña debe incluir mayúsculas, minúsculas y números');
        isValid = false;
      }
      
      // Validar confirmación de contraseña
      if (!confirmarClave.value) {
        showFieldError('confirmar-clave-error', 'Debes confirmar tu contraseña');
        isValid = false;
      } else if (clave.value !== confirmarClave.value) {
        showFieldError('confirmar-clave-error', 'Las contraseñas no coinciden');
        isValid = false;
      }
      
      // Validar términos y condiciones
      if (!aceptarTerminos.checked) {
        showFieldError('terminos-help', 'Debes aceptar los términos y condiciones');
        isValid = false;
      }
      
      return isValid;
    }

    function clearRegistroErrors() {
      const errorElements = document.querySelectorAll('#form-registro .error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    function showRegistroStatus(message, type = 'info') {
      const statusElement = document.getElementById('registro-status');
      statusElement.textContent = message;
      statusElement.className = `registro-status ${type}`;
      statusElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearRegistroStatus() {
      const statusElement = document.getElementById('registro-status');
      statusElement.style.display = 'none';
      statusElement.textContent = '';
    }

    function setRegistroButtonLoading(loading) {
      const button = document.getElementById('registro-submit-btn');
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        button.querySelector('.btn-text').textContent = 'Creando cuenta...';
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        button.querySelector('.btn-text').textContent = 'Crear Cuenta';
      }
    }

    function checkPasswordStrength(password) {
      let strength = 0;
      let feedback = [];
      
      // Longitud mínima
      if (password.length >= 8) strength += 1;
      else feedback.push('Al menos 8 caracteres');
      
      // Letras minúsculas
      if (/[a-z]/.test(password)) strength += 1;
      else feedback.push('Letras minúsculas');
      
      // Letras mayúsculas
      if (/[A-Z]/.test(password)) strength += 1;
      else feedback.push('Letras mayúsculas');
      
      // Números
      if (/\d/.test(password)) strength += 1;
      else feedback.push('Números');
      
      // Caracteres especiales
      if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength += 1;
      else feedback.push('Caracteres especiales');
      
      const strengthBar = document.getElementById('password-strength-bar');
      const strengthText = document.getElementById('password-strength-text');
      
      // Remover clases anteriores
      strengthBar.className = 'strength-fill';
      
      // Aplicar clase según fortaleza
      if (strength <= 1) {
        strengthBar.classList.add('weak');
        strengthText.textContent = 'Débil';
      } else if (strength <= 2) {
        strengthBar.classList.add('fair');
        strengthText.textContent = 'Regular';
      } else if (strength <= 3) {
        strengthBar.classList.add('good');
        strengthText.textContent = 'Buena';
      } else {
        strengthBar.classList.add('strong');
        strengthText.textContent = 'Fuerte';
      }
      
      return { strength, feedback };
    }

    function setupRegistroRealTimeValidation() {
      // Validación en tiempo real para nombre
      document.getElementById('nombre').addEventListener('input', function() {
        const errorElement = document.getElementById('nombre-error');
        if (this.value.trim().length >= 2) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El nombre debe tener al menos 2 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para cédula
      document.getElementById('cedula').addEventListener('input', function() {
        const errorElement = document.getElementById('cedula-error');
        if (/^[0-9]{10}$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'La cédula debe tener exactamente 10 dígitos');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para email
      document.getElementById('email').addEventListener('input', function() {
        const errorElement = document.getElementById('email-error');
        if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'Ingresa un correo electrónico válido');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para teléfono
      document.getElementById('telefono').addEventListener('input', function() {
        const errorElement = document.getElementById('telefono-error');
        if (this.value.trim() === '' || /^[0-9]{10}$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El teléfono debe tener 10 dígitos');
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para usuario
      document.getElementById('usuario').addEventListener('input', function() {
        const errorElement = document.getElementById('usuario-error');
        if (this.value.trim().length >= 3 && /^[a-zA-Z0-9_]+$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          if (this.value.trim().length < 3) {
            showFieldError(errorElement, 'El nombre de usuario debe tener al menos 3 caracteres');
          } else {
            showFieldError(errorElement, 'Solo se permiten letras, números y guiones bajos');
          }
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para contraseña
      document.getElementById('clave').addEventListener('input', function() {
        const errorElement = document.getElementById('clave-error');
        const strength = checkPasswordStrength(this.value);
        
        if (this.value.length >= 8 && /(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(this.value)) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.length > 0) {
          if (this.value.length < 8) {
            showFieldError(errorElement, 'La contraseña debe tener al menos 8 caracteres');
          } else {
            showFieldError(errorElement, 'La contraseña debe incluir mayúsculas, minúsculas y números');
          }
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
        
        // Validar confirmación de contraseña
        const confirmarClave = document.getElementById('confirmar-clave');
        if (confirmarClave.value && this.value !== confirmarClave.value) {
          showFieldError('confirmar-clave-error', 'Las contraseñas no coinciden');
        } else if (confirmarClave.value && this.value === confirmarClave.value) {
          document.getElementById('confirmar-clave-error').style.display = 'none';
          confirmarClave.classList.add('valid');
        }
      });
      
      // Validación en tiempo real para confirmación de contraseña
      document.getElementById('confirmar-clave').addEventListener('input', function() {
        const errorElement = document.getElementById('confirmar-clave-error');
        const clave = document.getElementById('clave').value;
        
        if (this.value === clave && clave.length > 0) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.length > 0) {
          showFieldError(errorElement, 'Las contraseñas no coinciden');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
    }

    // Funciones para el formulario de contacto
    function validateContactoForm() {
      const nombre = document.getElementById('contacto-nombre');
      const email = document.getElementById('contacto-email');
      const telefono = document.getElementById('contacto-telefono');
      const asunto = document.getElementById('contacto-asunto');
      const mensaje = document.getElementById('contacto-mensaje');
      const captchaAnswer = document.getElementById('contacto-captcha-answer');
      
      let isValid = true;
      
      // Limpiar errores anteriores
      clearContactoErrors();
      
      // Validar nombre
      if (!nombre.value.trim()) {
        showFieldError('contacto-nombre-error', 'El nombre completo es requerido');
        isValid = false;
      } else if (nombre.value.trim().length < 2) {
        showFieldError('contacto-nombre-error', 'El nombre debe tener al menos 2 caracteres');
        isValid = false;
      }
      
      // Validar email
      if (!email.value.trim()) {
        showFieldError('contacto-email-error', 'El correo electrónico es requerido');
        isValid = false;
      } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) {
        showFieldError('contacto-email-error', 'Ingresa un correo electrónico válido');
        isValid = false;
      }
      
      // Validar teléfono (opcional)
      if (telefono.value.trim() && !/^[0-9]{10}$/.test(telefono.value.trim())) {
        showFieldError('contacto-telefono-error', 'El teléfono debe tener 10 dígitos');
        isValid = false;
      }
      
      // Validar asunto
      if (!asunto.value) {
        showFieldError('contacto-asunto-error', 'Debes seleccionar un asunto');
        isValid = false;
      }
      
      // Validar mensaje
      if (!mensaje.value.trim()) {
        showFieldError('contacto-mensaje-error', 'El mensaje es requerido');
        isValid = false;
      } else if (mensaje.value.trim().length < 10) {
        showFieldError('contacto-mensaje-error', 'El mensaje debe tener al menos 10 caracteres');
        isValid = false;
      }
      
      // Validar CAPTCHA
      if (!validateContactoCaptcha()) {
        isValid = false;
      }
      
      return isValid;
    }

    function clearContactoErrors() {
      const errorElements = document.querySelectorAll('#form-contacto .error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    function showContactoStatus(message, type = 'info') {
      const statusElement = document.getElementById('contacto-status');
      statusElement.textContent = message;
      statusElement.className = `contacto-status ${type}`;
      statusElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearContactoStatus() {
      const statusElement = document.getElementById('contacto-status');
      statusElement.style.display = 'none';
      statusElement.textContent = '';
    }

    function setContactoButtonLoading(loading) {
      const button = document.getElementById('contacto-submit-btn');
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        button.querySelector('.btn-text').textContent = 'Enviando mensaje...';
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        button.querySelector('.btn-text').textContent = 'Enviar Mensaje';
      }
    }

    function showContactoCaptcha() {
      const captchaContainer = document.getElementById('contacto-captcha-container');
      const captchaText = document.getElementById('contacto-captcha-text');
      
      const captchaQuestions = [
        '¿Cuál es la capital de Ecuador?',
        '¿En qué continente está Ecuador?',
        '¿Cuál es el color de la bandera de Ecuador?',
        '¿Cuál es la moneda de Ecuador?',
        '¿Cuál es el idioma oficial de Ecuador?'
      ];
      
      const captchaAnswers = [
        'quito',
        'america',
        'amarillo',
        'dolar',
        'español'
      ];
      
      const randomIndex = Math.floor(Math.random() * captchaQuestions.length);
      captchaText.textContent = captchaQuestions[randomIndex];
      captchaText.setAttribute('data-answer', captchaAnswers[randomIndex]);
      
      captchaContainer.style.display = 'block';
      announceToScreenReader('Se requiere verificación de seguridad');
    }

    function validateContactoCaptcha() {
      const captchaAnswer = document.getElementById('contacto-captcha-answer');
      const captchaText = document.getElementById('contacto-captcha-text');
      
      if (!captchaAnswer.value.trim()) {
        showFieldError('contacto-captcha-help', 'Debes responder la pregunta de verificación');
        return false;
      }
      
      const userAnswer = captchaAnswer.value.toLowerCase().trim();
      const correctAnswer = captchaText.getAttribute('data-answer');
      
      if (userAnswer !== correctAnswer) {
        showFieldError('contacto-captcha-help', 'Respuesta incorrecta. Intenta nuevamente.');
        return false;
      }
      
      return true;
    }

    function updateMensajeCounter() {
      const mensaje = document.getElementById('contacto-mensaje');
      const counter = document.getElementById('mensaje-counter');
      const currentLength = mensaje.value.length;
      const maxLength = 1000;
      
      counter.textContent = currentLength;
      
      if (currentLength > maxLength * 0.9) {
        counter.style.color = '#f44336';
      } else if (currentLength > maxLength * 0.7) {
        counter.style.color = '#ff9800';
      } else {
        counter.style.color = '#666';
      }
    }

    function setupContactoRealTimeValidation() {
      // Validación en tiempo real para nombre
      document.getElementById('contacto-nombre').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-nombre-error');
        if (this.value.trim().length >= 2) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El nombre debe tener al menos 2 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para email
      document.getElementById('contacto-email').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-email-error');
        if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'Ingresa un correo electrónico válido');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para teléfono
      document.getElementById('contacto-telefono').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-telefono-error');
        if (this.value.trim() === '' || /^[0-9]{10}$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El teléfono debe tener 10 dígitos');
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para asunto
      document.getElementById('contacto-asunto').addEventListener('change', function() {
        const errorElement = document.getElementById('contacto-asunto-error');
        if (this.value) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else {
          showFieldError(errorElement, 'Debes seleccionar un asunto');
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para mensaje
      document.getElementById('contacto-mensaje').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-mensaje-error');
        updateMensajeCounter();
        
        if (this.value.trim().length >= 10) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El mensaje debe tener al menos 10 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // Validación en tiempo real para CAPTCHA
      document.getElementById('contacto-captcha-answer').addEventListener('input', function() {
        const helpElement = document.getElementById('contacto-captcha-help');
        if (this.value.trim()) {
          helpElement.style.display = 'none';
          this.classList.add('valid');
        } else {
          this.classList.remove('valid');
        }
      });
    }

    function mostrarModalContacto() {
      mostrarModal('modal-contacto');
      showContactoCaptcha();
      setupContactoRealTimeValidation();
      announceToScreenReader('Formulario de contacto abierto');
    }

    // Formulario de contacto mejorado
    const formContacto = document.getElementById('form-contacto');
    if (formContacto) {
      formContacto.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Limpiar estado anterior
        clearContactoStatus();
        
        // Validar formulario
        if (!validateContactoForm()) {
          return;
        }
        
        // Obtener datos del formulario
        const formData = {
          nombre: document.getElementById('contacto-nombre').value.trim(),
          email: document.getElementById('contacto-email').value.trim(),
          telefono: document.getElementById('contacto-telefono').value.trim() || null,
          asunto: document.getElementById('contacto-asunto').value,
          mensaje: document.getElementById('contacto-mensaje').value.trim(),
          urgencia: document.querySelector('input[name="urgencia"]:checked').value,
          notificaciones: document.getElementById('contacto-notificaciones').checked
        };
        
        // Mostrar estado de carga
        setContactoButtonLoading(true);
        showContactoStatus('Enviando tu mensaje...', 'info');
        
        try {
          const startTime = Date.now();
          
          // Simular envío (en producción sería una llamada real a la API)
          const res = await fetch(`${API_BASE_URL}/contacto`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          
          const data = await res.json();
          const endTime = Date.now();
          const responseTime = endTime - startTime;
          
          // Verificar tiempo de respuesta
          if (responseTime > 10000) {
            showContactoStatus('La respuesta del servidor fue lenta. Intenta nuevamente.', 'error');
            setContactoButtonLoading(false);
            return;
          }
          
          if (res.ok) {
            // Envío exitoso
            showContactoStatus('¡Mensaje enviado exitosamente! Te responderemos pronto.', 'success');
            announceToScreenReader('Mensaje enviado exitosamente');
            
            // Mostrar tiempo de respuesta estimado
            const urgencia = formData.urgencia;
            let tiempoRespuesta = '';
            switch (urgencia) {
              case 'alta':
                tiempoRespuesta = '2-6 horas';
                break;
              case 'media':
                tiempoRespuesta = '12-24 horas';
                break;
              default:
                tiempoRespuesta = '24-48 horas';
            }
            
            setTimeout(() => {
              showContactoStatus(`Gracias por contactarnos. Te responderemos en ${tiempoRespuesta}.`, 'info');
            }, 2000);
            
            // Cerrar modal después de un delay
            setTimeout(() => {
              cerrarModal('modal-contacto');
              showNotification('Mensaje enviado correctamente', 'success');
            }, 4000);
            
          } else {
            // Envío fallido
            const errorMessage = data.mensaje || 'Error al enviar el mensaje. Intenta nuevamente.';
            showContactoStatus(errorMessage, 'error');
            announceToScreenReader('Error al enviar mensaje');
            setContactoButtonLoading(false);
          }
          
        } catch (error) {
          console.error('Error en contacto:', error);
          showContactoStatus('Error de conexión. Verifica tu conexión a internet e intenta nuevamente.', 'error');
          setContactoButtonLoading(false);
        }
              });
      }

    // Funciones de guardar registro
    function mostrarModalGuardar() {
      mostrarModal('modal-guardar-registro');
      announceToScreenReader('Formulario de guardar destino turístico abierto');
      inicializarFormularioGuardar();
    }

    function confirmarCerrarGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const hasData = Array.from(form.elements).some(element => 
        element.value && element.type !== 'submit' && element.type !== 'button'
      );
      
      if (hasData) {
        if (confirm('¿Estás seguro de que quieres cerrar? Los datos no guardados se perderán.')) {
          cerrarModalGuardar();
        }
      } else {
        cerrarModalGuardar();
      }
    }

    function cerrarModalGuardar() {
      cerrarModal('modal-guardar-registro');
      limpiarFormularioGuardar();
      announceToScreenReader('Formulario de guardar destino cerrado');
    }

    function inicializarFormularioGuardar() {
      // Configurar contador de caracteres
      const textarea = document.getElementById('destino-descripcion');
      const counter = document.getElementById('descripcion-counter');
      
      if (textarea && counter) {
        textarea.addEventListener('input', function() {
          counter.textContent = this.value.length;
          if (this.value.length > 900) {
            counter.style.color = '#dc3545';
          } else if (this.value.length > 800) {
            counter.style.color = '#ffc107';
          } else {
            counter.style.color = '#6c757d';
          }
        });
      }

      // Configurar validación en tiempo real
      configurarValidacionGuardar();
      
      // Cargar borrador si existe
      cargarBorrador();
    }

    function configurarValidacionGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const campos = form.querySelectorAll('input, select, textarea');
      
      campos.forEach(campo => {
        campo.addEventListener('blur', function() {
          validarCampoGuardar(this);
        });
        
        campo.addEventListener('input', function() {
          if (this.classList.contains('error')) {
            validarCampoGuardar(this);
          }
        });
      });
    }

    function validarCampoGuardar(campo) {
      const errorElement = document.getElementById(`${campo.id}-error`);
      let error = '';
      
      // Limpiar estado anterior
      campo.classList.remove('error');
      if (errorElement) {
        errorElement.textContent = '';
        errorElement.classList.remove('show');
      }
      
      // Validaciones específicas
      if (campo.hasAttribute('required') && !campo.value.trim()) {
        error = 'Este campo es obligatorio';
      } else if (campo.type === 'email' && campo.value && !validarEmail(campo.value)) {
        error = 'Ingresa un email válido';
      } else if (campo.type === 'url' && campo.value && !validarURL(campo.value)) {
        error = 'Ingresa una URL válida';
      } else if (campo.type === 'tel' && campo.value && !validarTelefono(campo.value)) {
        error = 'Ingresa un teléfono válido';
      } else if (campo.type === 'number') {
        const valor = parseFloat(campo.value);
        if (campo.value && (isNaN(valor) || valor < parseFloat(campo.min) || valor > parseFloat(campo.max))) {
          error = `El valor debe estar entre ${campo.min} y ${campo.max}`;
        }
      } else if (campo.type === 'textarea' && campo.value) {
        if (campo.value.length < parseInt(campo.minlength)) {
          error = `Mínimo ${campo.minlength} caracteres`;
        } else if (campo.value.length > parseInt(campo.maxlength)) {
          error = `Máximo ${campo.maxlength} caracteres`;
        }
      }
      
      // Mostrar error si existe
      if (error && errorElement) {
        errorElement.textContent = error;
        errorElement.classList.add('show');
        campo.classList.add('error');
        campo.style.borderColor = '#dc3545';
      } else if (campo.classList.contains('error')) {
        campo.style.borderColor = '';
      }
    }

    function validarEmail(email) {
      const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return regex.test(email);
    }

    function validarURL(url) {
      try {
        new URL(url);
        return true;
      } catch {
        return false;
      }
    }

    function validarTelefono(telefono) {
      const regex = /^[0-9\s\-\(\)]+$/;
      return regex.test(telefono) && telefono.length >= 7;
    }

    function guardarBorrador() {
      const form = document.getElementById('form-guardar-registro');
      const formData = new FormData(form);
      const datos = {};
      
      // Recopilar datos del formulario
      for (let [key, value] of formData.entries()) {
        if (key === 'caracteristicas') {
          if (!datos[key]) datos[key] = [];
          datos[key].push(value);
        } else {
          datos[key] = value;
        }
      }
      
      // Guardar en localStorage
      localStorage.setItem('borradorDestino', JSON.stringify(datos));
      
      // Mostrar confirmación
      mostrarEstadoGuardar('Borrador guardado exitosamente', 'success');
      announceToScreenReader('Borrador guardado exitosamente');
      
      // Auto-guardar cada 30 segundos
      setTimeout(guardarBorrador, 30000);
    }

    function cargarBorrador() {
      const borrador = localStorage.getItem('borradorDestino');
      if (borrador) {
        const datos = JSON.parse(borrador);
        const form = document.getElementById('form-guardar-registro');
        
        // Llenar campos con datos del borrador
        Object.keys(datos).forEach(key => {
          const campo = form.querySelector(`[name="${key}"]`);
          if (campo) {
            if (campo.type === 'checkbox') {
              campo.checked = datos[key].includes(campo.value);
            } else {
              campo.value = datos[key];
            }
          }
        });
        
        // Actualizar contador de caracteres
        const textarea = document.getElementById('destino-descripcion');
        const counter = document.getElementById('descripcion-counter');
        if (textarea && counter) {
          counter.textContent = textarea.value.length;
        }
        
        mostrarEstadoGuardar('Borrador cargado automáticamente', 'info');
      }
    }

    function limpiarFormularioGuardar() {
      const form = document.getElementById('form-guardar-registro');
      form.reset();
      
      // Limpiar errores
      const errores = form.querySelectorAll('.error-message');
      errores.forEach(error => {
        error.textContent = '';
        error.classList.remove('show');
      });
      
      // Limpiar estados de campos
      const campos = form.querySelectorAll('input, select, textarea');
      campos.forEach(campo => {
        campo.classList.remove('error');
        campo.style.borderColor = '';
      });
      
      // Resetear contador
      const counter = document.getElementById('descripcion-counter');
      if (counter) counter.textContent = '0';
      
      // Limpiar estado
      mostrarEstadoGuardar('', '');
    }

    function mostrarEstadoGuardar(mensaje, tipo) {
      const statusElement = document.getElementById('guardar-status');
      if (statusElement) {
        statusElement.textContent = mensaje;
        statusElement.className = `guardar-status ${tipo}`;
        
        if (mensaje) {
          setTimeout(() => {
            statusElement.textContent = '';
            statusElement.className = 'guardar-status';
          }, 5000);
        }
      }
    }

    // Manejo del envío del formulario
    document.addEventListener('DOMContentLoaded', function() {
      const formGuardar = document.getElementById('form-guardar-registro');
      if (formGuardar) {
        formGuardar.addEventListener('submit', function(e) {
          e.preventDefault();
          enviarFormularioGuardar();
        });
      }
    });

    function enviarFormularioGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const submitBtn = document.getElementById('guardar-submit-btn');
      
      // Validar todo el formulario
      const campos = form.querySelectorAll('input, select, textarea');
      let hayErrores = false;
      
      campos.forEach(campo => {
        validarCampoGuardar(campo);
        if (campo.classList.contains('error')) {
          hayErrores = true;
        }
      });
      
      if (hayErrores) {
        mostrarEstadoGuardar('Por favor, corrige los errores antes de continuar', 'error');
        announceToScreenReader('Hay errores en el formulario que deben corregirse');
        return;
      }
      
      // Mostrar estado de carga
      submitBtn.classList.add('loading');
      submitBtn.disabled = true;
      mostrarEstadoGuardar('Guardando destino...', 'info');
      
      // Simular envío (aquí iría la llamada real al backend)
      setTimeout(() => {
        // Simular respuesta exitosa
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        
        mostrarEstadoGuardar('¡Destino guardado exitosamente!', 'success');
        announceToScreenReader('Destino turístico guardado exitosamente');
        
        // Limpiar borrador
        localStorage.removeItem('borradorDestino');
        
        // Cerrar modal después de 2 segundos
        setTimeout(() => {
          cerrarModalGuardar();
        }, 2000);
        
      }, 2000);
    }
    </script>

  <!-- Modal de Formulario de Contacto -->
  <div id="modal-contacto" class="modal oculto" role="dialog" aria-labelledby="modal-contacto-titulo" aria-hidden="true">
    <div class="modal-content contacto-modal">
      <span class="cerrar" onclick="cerrarModal('modal-contacto')" aria-label="Cerrar formulario de contacto">&times;</span>
      
      <div class="contacto-header">
        <div class="contacto-icon" aria-hidden="true">📞</div>
        <h2 id="modal-contacto-titulo">Contáctanos</h2>
        <p class="contacto-subtitle">Estamos aquí para ayudarte con tu viaje a Ecuador</p>
      </div>
      
      <div class="contacto-instructions">
        <p>Completa el formulario a continuación y nos pondremos en contacto contigo en menos de 24 horas. Los campos marcados con <span class="required-mark">*</span> son obligatorios.</p>
      </div>
      
      <form id="form-contacto" role="form" aria-describedby="contacto-descripcion" novalidate>
        <p id="contacto-descripcion" class="sr-only">Formulario de contacto para consultas sobre turismo en Ecuador</p>
        
        <!-- Información Personal -->
        <div class="form-section" aria-labelledby="info-personal-titulo">
          <h3 id="info-personal-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">👤</span>
            Información Personal
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="contacto-nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">📛</span>
                Nombre Completo
              </label>
              <input 
                type="text" 
                id="contacto-nombre" 
                name="nombre" 
                placeholder="Ingresa tu nombre completo" 
                required 
                autocomplete="given-name"
                aria-describedby="contacto-nombre-error contacto-nombre-help"
                class="form-input"
                minlength="2"
                maxlength="50"
              />
              <div id="contacto-nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="contacto-nombre-help" class="help-text">Ingresa tu nombre y apellidos</div>
            </div>
            
            <div class="form-group">
              <label for="contacto-email" class="form-label required">
                <span class="label-icon" aria-hidden="true">📧</span>
                Correo Electrónico
              </label>
              <input 
                type="email" 
                id="contacto-email" 
                name="email" 
                placeholder="tu@email.com" 
                required 
                autocomplete="email"
                aria-describedby="contacto-email-error contacto-email-help"
                class="form-input"
              />
              <div id="contacto-email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="contacto-email-help" class="help-text">Usaremos este correo para responderte</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="contacto-telefono" class="form-label">
              <span class="label-icon" aria-hidden="true">📱</span>
              Teléfono (Opcional)
            </label>
            <input 
              type="tel" 
              id="contacto-telefono" 
              name="telefono" 
              placeholder="Ej: 0991234567" 
              autocomplete="tel"
              aria-describedby="contacto-telefono-error contacto-telefono-help"
              class="form-input"
              pattern="[0-9]{10}"
              maxlength="10"
            />
            <div id="contacto-telefono-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="contacto-telefono-help" class="help-text">Para contacto telefónico si lo prefieres</div>
          </div>
        </div>
        
        <!-- Información de la Consulta -->
        <div class="form-section" aria-labelledby="consulta-titulo">
          <h3 id="consulta-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">❓</span>
            Información de la Consulta
          </h3>
          
          <div class="form-group">
            <label for="contacto-asunto" class="form-label required">
              <span class="label-icon" aria-hidden="true">📋</span>
              Asunto
            </label>
            <select 
              id="contacto-asunto" 
              name="asunto" 
              required 
              aria-describedby="contacto-asunto-error contacto-asunto-help"
              class="form-input"
            >
              <option value="">Selecciona un asunto</option>
              <option value="informacion-destinos">Información sobre destinos</option>
              <option value="reservas-hoteles">Reservas de hoteles</option>
              <option value="paquetes-turisticos">Paquetes turísticos</option>
              <option value="transporte">Información de transporte</option>
              <option value="actividades">Actividades y excursiones</option>
              <option value="documentacion">Documentación y visas</option>
              <option value="clima">Información del clima</option>
              <option value="seguridad">Seguridad y recomendaciones</option>
              <option value="accesibilidad">Información de accesibilidad</option>
              <option value="otro">Otro</option>
            </select>
            <div id="contacto-asunto-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="contacto-asunto-help" class="help-text">Selecciona el tema principal de tu consulta</div>
          </div>
          
          <div class="form-group">
            <label for="contacto-mensaje" class="form-label required">
              <span class="label-icon" aria-hidden="true">💬</span>
              Mensaje
            </label>
            <textarea 
              id="contacto-mensaje" 
              name="mensaje" 
              placeholder="Describe tu consulta o solicitud aquí..." 
              required 
              aria-describedby="contacto-mensaje-error contacto-mensaje-help"
              class="form-textarea"
              rows="6"
              minlength="10"
              maxlength="1000"
            ></textarea>
            <div class="textarea-counter">
              <span id="mensaje-counter">0</span> / 1000 caracteres
            </div>
            <div id="contacto-mensaje-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="contacto-mensaje-help" class="help-text">Mínimo 10 caracteres. Sé específico para una mejor respuesta</div>
          </div>
          
          <div class="form-group">
            <label for="contacto-urgencia" class="form-label">
              <span class="label-icon" aria-hidden="true">⏰</span>
              Urgencia de la Consulta
            </label>
            <div class="radio-group">
              <label class="radio-wrapper">
                <input 
                  type="radio" 
                  name="urgencia" 
                  value="baja" 
                  checked
                  aria-describedby="urgencia-help"
                />
                <span class="radio-mark"></span>
                <span class="radio-text">Baja (Respuesta en 24-48 horas)</span>
              </label>
              <label class="radio-wrapper">
                <input 
                  type="radio" 
                  name="urgencia" 
                  value="media"
                  aria-describedby="urgencia-help"
                />
                <span class="radio-mark"></span>
                <span class="radio-text">Media (Respuesta en 12-24 horas)</span>
              </label>
              <label class="radio-wrapper">
                <input 
                  type="radio" 
                  name="urgencia" 
                  value="alta"
                  aria-describedby="urgencia-help"
                />
                <span class="radio-mark"></span>
                <span class="radio-text">Alta (Respuesta en 2-6 horas)</span>
              </label>
            </div>
            <div id="urgencia-help" class="help-text">Selecciona la urgencia de tu consulta</div>
          </div>
        </div>
        
        <!-- Verificación Anti-Spam -->
        <div class="form-section" aria-labelledby="verificacion-titulo">
          <h3 id="verificacion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">🛡️</span>
            Verificación de Seguridad
          </h3>
          
          <div class="captcha-container" id="contacto-captcha-container">
            <div class="captcha-challenge">
              <span class="captcha-text" id="contacto-captcha-text">¿Cuál es la capital de Ecuador?</span>
              <input 
                type="text" 
                id="contacto-captcha-answer" 
                placeholder="Respuesta"
                class="form-input captcha-input"
                aria-describedby="contacto-captcha-help"
                required
              />
              <div id="contacto-captcha-help" class="help-text">Responde la pregunta para verificar que eres humano</div>
            </div>
          </div>
          
          <div class="form-options">
            <label class="checkbox-wrapper">
              <input 
                type="checkbox" 
                id="contacto-notificaciones" 
                name="notificaciones"
                aria-describedby="contacto-notificaciones-help"
              />
              <span class="checkmark"></span>
              <span class="checkbox-text">Deseo recibir notificaciones sobre ofertas turísticas</span>
            </label>
            <div id="contacto-notificaciones-help" class="help-text">Puedes cambiar esta opción después</div>
          </div>
        </div>
        
        <!-- Botones de acción -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-contacto-submit"
            aria-label="Enviar formulario de contacto"
            id="contacto-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">📤</span>
            <span class="btn-text">Enviar Mensaje</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-contacto-cancel"
            onclick="cerrarModal('modal-contacto')"
            aria-label="Cancelar envío de mensaje"
          >
            <span class="btn-icon" aria-hidden="true">❌</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="contacto-status" class="contacto-status" role="status" aria-live="polite"></div>
      </form>
      
      <!-- Información adicional -->
      <div class="contacto-footer">
        <div class="contacto-info">
          <h4>Información de Contacto Directo</h4>
          <div class="contacto-details">
            <p><span class="contact-icon" aria-hidden="true">📧</span> Email: info@turismoecuador.com</p>
            <p><span class="contact-icon" aria-hidden="true">📱</span> WhatsApp: +593 99 123 4567</p>
            <p><span class="contact-icon" aria-hidden="true">🕒</span> Horario: Lunes a Viernes 8:00 - 18:00</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Formulario de Guardar Registro -->
  <div id="modal-guardar-registro" class="modal oculto" role="dialog" aria-labelledby="modal-guardar-titulo" aria-hidden="true">
    <div class="modal-content guardar-modal">
      <span class="cerrar" onclick="confirmarCerrarGuardar()" aria-label="Cerrar formulario de guardar registro">&times;</span>
      
      <div class="guardar-header">
        <div class="guardar-icon" aria-hidden="true">💾</div>
        <h2 id="modal-guardar-titulo">Guardar Destino Turístico</h2>
        <p class="guardar-subtitle">Registra información detallada de un nuevo destino</p>
      </div>
      
      <div class="guardar-instructions">
        <p>Completa la información del destino turístico. Los campos marcados con <span class="required-mark">*</span> son obligatorios. Puedes guardar borradores y continuar después.</p>
      </div>
      
      <form id="form-guardar-registro" role="form" aria-describedby="guardar-descripcion" novalidate>
        <p id="guardar-descripcion" class="sr-only">Formulario para guardar información de un nuevo destino turístico en Ecuador</p>
        
        <!-- Información Básica del Destino -->
        <div class="form-section" aria-labelledby="info-basica-titulo">
          <h3 id="info-basica-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📍</span>
            Información Básica
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">🏷️</span>
                Nombre del Destino
              </label>
              <input 
                type="text" 
                id="destino-nombre" 
                name="nombre" 
                placeholder="Ej: Centro Histórico de Cuenca" 
                required 
                autocomplete="off"
                aria-describedby="destino-nombre-error destino-nombre-help"
                class="form-input"
                maxlength="100"
              />
              <div id="destino-nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-nombre-help" class="help-text">Nombre oficial o popular del destino</div>
            </div>
            
            <div class="form-group">
              <label for="destino-tipo" class="form-label required">
                <span class="label-icon" aria-hidden="true">🏛️</span>
                Tipo de Destino
              </label>
              <select 
                id="destino-tipo" 
                name="tipo" 
                required 
                aria-describedby="destino-tipo-error destino-tipo-help"
                class="form-input"
              >
                <option value="">Selecciona el tipo</option>
                <option value="ciudad">Ciudad</option>
                <option value="playa">Playa</option>
                <option value="montaña">Montaña</option>
                <option value="selva">Selva</option>
                <option value="isla">Isla</option>
                <option value="parque">Parque Nacional</option>
                <option value="monumento">Monumento</option>
                <option value="museo">Museo</option>
                <option value="restaurante">Restaurante</option>
                <option value="hotel">Hotel</option>
                <option value="otro">Otro</option>
              </select>
              <div id="destino-tipo-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-tipo-help" class="help-text">Categoría principal del destino</div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-provincia" class="form-label required">
                <span class="label-icon" aria-hidden="true">🗺️</span>
                Provincia
              </label>
              <select 
                id="destino-provincia" 
                name="provincia" 
                required 
                aria-describedby="destino-provincia-error destino-provincia-help"
                class="form-input"
              >
                <option value="">Selecciona la provincia</option>
                <option value="azuay">Azuay</option>
                <option value="bolivar">Bolívar</option>
                <option value="canar">Cañar</option>
                <option value="carchi">Carchi</option>
                <option value="chimborazo">Chimborazo</option>
                <option value="cotopaxi">Cotopaxi</option>
                <option value="el-oro">El Oro</option>
                <option value="esmeraldas">Esmeraldas</option>
                <option value="galapagos">Galápagos</option>
                <option value="guayas">Guayas</option>
                <option value="imbabura">Imbabura</option>
                <option value="loja">Loja</option>
                <option value="los-rios">Los Ríos</option>
                <option value="manabi">Manabí</option>
                <option value="morona-santiago">Morona Santiago</option>
                <option value="napo">Napo</option>
                <option value="orellana">Orellana</option>
                <option value="pastaza">Pastaza</option>
                <option value="pichincha">Pichincha</option>
                <option value="santa-elena">Santa Elena</option>
                <option value="santo-domingo">Santo Domingo</option>
                <option value="sucumbios">Sucumbíos</option>
                <option value="tungurahua">Tungurahua</option>
                <option value="zamora-chinchipe">Zamora Chinchipe</option>
              </select>
              <div id="destino-provincia-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-provincia-help" class="help-text">Provincia donde se encuentra el destino</div>
            </div>
            
            <div class="form-group">
              <label for="destino-ciudad" class="form-label">
                <span class="label-icon" aria-hidden="true">🏙️</span>
                Ciudad (Opcional)
              </label>
              <input 
                type="text" 
                id="destino-ciudad" 
                name="ciudad" 
                placeholder="Ej: Cuenca, Guayaquil" 
                autocomplete="off"
                aria-describedby="destino-ciudad-error destino-ciudad-help"
                class="form-input"
                maxlength="50"
              />
              <div id="destino-ciudad-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-ciudad-help" class="help-text">Ciudad específica si aplica</div>
            </div>
          </div>
        </div>
        
        <!-- Información de Ubicación -->
        <div class="form-section" aria-labelledby="ubicacion-titulo">
          <h3 id="ubicacion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">🌍</span>
            Ubicación y Coordenadas
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-latitud" class="form-label">
                <span class="label-icon" aria-hidden="true">📡</span>
                Latitud
              </label>
              <input 
                type="number" 
                id="destino-latitud" 
                name="latitud" 
                placeholder="Ej: -2.8968" 
                step="0.0001"
                min="-5"
                max="2"
                autocomplete="off"
                aria-describedby="destino-latitud-error destino-latitud-help"
                class="form-input"
              />
              <div id="destino-latitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-latitud-help" class="help-text">Coordenada de latitud (entre -5 y 2)</div>
            </div>
            
            <div class="form-group">
              <label for="destino-longitud" class="form-label">
                <span class="label-icon" aria-hidden="true">📡</span>
                Longitud
              </label>
              <input 
                type="number" 
                id="destino-longitud" 
                name="longitud" 
                placeholder="Ej: -79.0045" 
                step="0.0001"
                min="-82"
                max="-75"
                autocomplete="off"
                aria-describedby="destino-longitud-error destino-longitud-help"
                class="form-input"
              />
              <div id="destino-longitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-longitud-help" class="help-text">Coordenada de longitud (entre -82 y -75)</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="destino-direccion" class="form-label">
              <span class="label-icon" aria-hidden="true">📍</span>
              Dirección
            </label>
            <input 
              type="text" 
              id="destino-direccion" 
              name="direccion" 
              placeholder="Ej: Calle Larga 10-77, Centro Histórico" 
              autocomplete="off"
              aria-describedby="destino-direccion-error destino-direccion-help"
              class="form-input"
              maxlength="200"
            />
            <div id="destino-direccion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="destino-direccion-help" class="help-text">Dirección específica del destino</div>
          </div>
        </div>
        
        <!-- Información de Contacto -->
        <div class="form-section" aria-labelledby="contacto-destino-titulo">
          <h3 id="contacto-destino-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📞</span>
            Información de Contacto
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-telefono" class="form-label">
                <span class="label-icon" aria-hidden="true">📱</span>
                Teléfono
              </label>
              <input 
                type="tel" 
                id="destino-telefono" 
                name="telefono" 
                placeholder="Ej: 07 2840 123" 
                autocomplete="tel"
                aria-describedby="destino-telefono-error destino-telefono-help"
                class="form-input"
                pattern="[0-9\s\-\(\)]+"
                maxlength="20"
              />
              <div id="destino-telefono-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-telefono-help" class="help-text">Número de teléfono del destino</div>
            </div>
            
            <div class="form-group">
              <label for="destino-email" class="form-label">
                <span class="label-icon" aria-hidden="true">📧</span>
                Email
              </label>
              <input 
                type="email" 
                id="destino-email" 
                name="email" 
                placeholder="Ej: info@destino.com" 
                autocomplete="email"
                aria-describedby="destino-email-error destino-email-help"
                class="form-input"
              />
              <div id="destino-email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-email-help" class="help-text">Correo electrónico de contacto</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="destino-web" class="form-label">
              <span class="label-icon" aria-hidden="true">🌐</span>
              Sitio Web
            </label>
            <input 
              type="url" 
              id="destino-web" 
              name="sitio_web" 
              placeholder="Ej: https://www.destino.com" 
              autocomplete="url"
              aria-describedby="destino-web-error destino-web-help"
              class="form-input"
            />
            <div id="destino-web-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="destino-web-help" class="help-text">URL del sitio web oficial</div>
          </div>
        </div>
        
        <!-- Información de Horarios y Precios -->
        <div class="form-section" aria-labelledby="horarios-precios-titulo">
          <h3 id="horarios-precios-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">⏰</span>
            Horarios y Precios
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-horario" class="form-label">
                <span class="label-icon" aria-hidden="true">🕒</span>
                Horario de Atención
              </label>
              <input 
                type="text" 
                id="destino-horario" 
                name="horario" 
                placeholder="Ej: Lunes a Domingo 8:00 - 18:00" 
                autocomplete="off"
                aria-describedby="destino-horario-error destino-horario-help"
                class="form-input"
                maxlength="100"
              />
              <div id="destino-horario-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-horario-help" class="help-text">Horarios de apertura y cierre</div>
            </div>
            
            <div class="form-group">
              <label for="destino-precio" class="form-label">
                <span class="label-icon" aria-hidden="true">💰</span>
                Precio de Entrada
              </label>
              <input 
                type="text" 
                id="destino-precio" 
                name="precio" 
                placeholder="Ej: Gratis, $5, $10-20" 
                autocomplete="off"
                aria-describedby="destino-precio-error destino-precio-help"
                class="form-input"
                maxlength="50"
              />
              <div id="destino-precio-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-precio-help" class="help-text">Costo de entrada o visita</div>
            </div>
          </div>
        </div>
        
        <!-- Descripción y Características -->
        <div class="form-section" aria-labelledby="descripcion-titulo">
          <h3 id="descripcion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📝</span>
            Descripción y Características
          </h3>
          
          <div class="form-group">
            <label for="destino-descripcion" class="form-label required">
              <span class="label-icon" aria-hidden="true">📄</span>
              Descripción
            </label>
            <textarea 
              id="destino-descripcion" 
              name="descripcion" 
              placeholder="Describe el destino, sus atractivos principales, historia, etc..." 
              required 
              aria-describedby="destino-descripcion-error destino-descripcion-help"
              class="form-textarea"
              rows="4"
              minlength="20"
              maxlength="1000"
            ></textarea>
            <div class="textarea-counter">
              <span id="descripcion-counter">0</span> / 1000 caracteres
            </div>
            <div id="destino-descripcion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="destino-descripcion-help" class="help-text">Descripción detallada del destino (mínimo 20 caracteres)</div>
          </div>
          
          <div class="form-group">
            <label for="destino-caracteristicas" class="form-label">
              <span class="label-icon" aria-hidden="true">🏷️</span>
              Características Especiales
            </label>
            <div class="checkbox-group">
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="accesible" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Accesible para personas con discapacidad</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="familiar" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Apto para familias</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="aventura" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de aventura</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="cultural" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo cultural</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="naturaleza" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de naturaleza</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="gastronomico" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo gastronómico</span>
              </label>
            </div>
            <div class="help-text">Selecciona las características que aplican al destino</div>
          </div>
        </div>
        
        <!-- Botones de acción -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-guardar-submit"
            aria-label="Guardar destino turístico"
            id="guardar-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">💾</span>
            <span class="btn-text">Guardar Destino</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-guardar-borrador"
            onclick="guardarBorrador()"
            aria-label="Guardar como borrador"
          >
            <span class="btn-icon" aria-hidden="true">📝</span>
            <span class="btn-text">Guardar Borrador</span>
          </button>
          
          <button 
            type="button" 
            class="btn-guardar-cancel"
            onclick="confirmarCerrarGuardar()"
            aria-label="Cancelar guardado"
          >
            <span class="btn-icon" aria-hidden="true">❌</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="guardar-status" class="guardar-status" role="status" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- Modal de Formulario de Editar Registro -->
  <div id="modal-editar-registro" class="modal oculto" role="dialog" aria-labelledby="modal-editar-titulo" aria-hidden="true">
    <div class="modal-content editar-modal">
      <span class="cerrar" onclick="confirmarCerrarEditar()" aria-label="Cerrar formulario de editar registro">&times;</span>
      
      <div class="editar-header">
        <div class="editar-icon" aria-hidden="true">✏️</div>
        <h2 id="modal-editar-titulo">Editar Destino Turístico</h2>
        <p class="editar-subtitle">Modifica la información del destino seleccionado</p>
      </div>
      
      <div class="editar-instructions">
        <p>Modifica los campos que necesites. Los campos marcados con <span class="required-mark">*</span> son obligatorios. Los cambios se resaltarán automáticamente.</p>
        <div class="editar-info">
          <span class="editar-id">ID: <span id="editar-destino-id">-</span></span>
          <span class="editar-fecha">Última modificación: <span id="editar-fecha-modificacion">-</span></span>
        </div>
      </div>
      
      <form id="form-editar-registro" role="form" aria-describedby="editar-descripcion" novalidate>
        <p id="editar-descripcion" class="sr-only">Formulario para editar información de un destino turístico existente</p>
        
        <!-- Información Básica del Destino -->
        <div class="form-section" aria-labelledby="editar-info-basica-titulo">
          <h3 id="editar-info-basica-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📍</span>
            Información Básica
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">🏷️</span>
                Nombre del Destino
              </label>
              <input 
                type="text" 
                id="editar-destino-nombre" 
                name="nombre" 
                placeholder="Ej: Centro Histórico de Cuenca" 
                required 
                autocomplete="off"
                aria-describedby="editar-destino-nombre-error editar-destino-nombre-help"
                class="form-input"
                maxlength="100"
                data-original-value=""
              />
              <div id="editar-destino-nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-nombre-help" class="help-text">Nombre oficial o popular del destino</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-tipo" class="form-label required">
                <span class="label-icon" aria-hidden="true">🏛️</span>
                Tipo de Destino
              </label>
              <select 
                id="editar-destino-tipo" 
                name="tipo" 
                required 
                aria-describedby="editar-destino-tipo-error editar-destino-tipo-help"
                class="form-input"
                data-original-value=""
              >
                <option value="">Selecciona el tipo</option>
                <option value="ciudad">Ciudad</option>
                <option value="playa">Playa</option>
                <option value="montaña">Montaña</option>
                <option value="selva">Selva</option>
                <option value="isla">Isla</option>
                <option value="parque">Parque Nacional</option>
                <option value="monumento">Monumento</option>
                <option value="museo">Museo</option>
                <option value="restaurante">Restaurante</option>
                <option value="hotel">Hotel</option>
                <option value="otro">Otro</option>
              </select>
              <div id="editar-destino-tipo-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-tipo-help" class="help-text">Categoría principal del destino</div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-provincia" class="form-label required">
                <span class="label-icon" aria-hidden="true">🗺️</span>
                Provincia
              </label>
              <select 
                id="editar-destino-provincia" 
                name="provincia" 
                required 
                aria-describedby="editar-destino-provincia-error editar-destino-provincia-help"
                class="form-input"
                data-original-value=""
              >
                <option value="">Selecciona la provincia</option>
                <option value="azuay">Azuay</option>
                <option value="bolivar">Bolívar</option>
                <option value="canar">Cañar</option>
                <option value="carchi">Carchi</option>
                <option value="chimborazo">Chimborazo</option>
                <option value="cotopaxi">Cotopaxi</option>
                <option value="el-oro">El Oro</option>
                <option value="esmeraldas">Esmeraldas</option>
                <option value="galapagos">Galápagos</option>
                <option value="guayas">Guayas</option>
                <option value="imbabura">Imbabura</option>
                <option value="loja">Loja</option>
                <option value="los-rios">Los Ríos</option>
                <option value="manabi">Manabí</option>
                <option value="morona-santiago">Morona Santiago</option>
                <option value="napo">Napo</option>
                <option value="orellana">Orellana</option>
                <option value="pastaza">Pastaza</option>
                <option value="pichincha">Pichincha</option>
                <option value="santa-elena">Santa Elena</option>
                <option value="santo-domingo">Santo Domingo</option>
                <option value="sucumbios">Sucumbíos</option>
                <option value="tungurahua">Tungurahua</option>
                <option value="zamora-chinchipe">Zamora Chinchipe</option>
              </select>
              <div id="editar-destino-provincia-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-provincia-help" class="help-text">Provincia donde se encuentra el destino</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-ciudad" class="form-label">
                <span class="label-icon" aria-hidden="true">🏙️</span>
                Ciudad (Opcional)
              </label>
              <input 
                type="text" 
                id="editar-destino-ciudad" 
                name="ciudad" 
                placeholder="Ej: Cuenca, Guayaquil" 
                autocomplete="off"
                aria-describedby="editar-destino-ciudad-error editar-destino-ciudad-help"
                class="form-input"
                maxlength="50"
                data-original-value=""
              />
              <div id="editar-destino-ciudad-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-ciudad-help" class="help-text">Ciudad específica si aplica</div>
            </div>
          </div>
        </div>
        
        <!-- Información de Ubicación -->
        <div class="form-section" aria-labelledby="editar-ubicacion-titulo">
          <h3 id="editar-ubicacion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">🌍</span>
            Ubicación y Coordenadas
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-latitud" class="form-label">
                <span class="label-icon" aria-hidden="true">📡</span>
                Latitud
              </label>
              <input 
                type="number" 
                id="editar-destino-latitud" 
                name="latitud" 
                placeholder="Ej: -2.8968" 
                step="0.0001"
                min="-5"
                max="2"
                autocomplete="off"
                aria-describedby="editar-destino-latitud-error editar-destino-latitud-help"
                class="form-input"
                data-original-value=""
              />
              <div id="editar-destino-latitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-latitud-help" class="help-text">Coordenada de latitud (entre -5 y 2)</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-longitud" class="form-label">
                <span class="label-icon" aria-hidden="true">📡</span>
                Longitud
              </label>
              <input 
                type="number" 
                id="editar-destino-longitud" 
                name="longitud" 
                placeholder="Ej: -79.0045" 
                step="0.0001"
                min="-82"
                max="-75"
                autocomplete="off"
                aria-describedby="editar-destino-longitud-error editar-destino-longitud-help"
                class="form-input"
                data-original-value=""
              />
              <div id="editar-destino-longitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-longitud-help" class="help-text">Coordenada de longitud (entre -82 y -75)</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="editar-destino-direccion" class="form-label">
              <span class="label-icon" aria-hidden="true">📍</span>
              Dirección
            </label>
            <input 
              type="text" 
              id="editar-destino-direccion" 
              name="direccion" 
              placeholder="Ej: Calle Larga 10-77, Centro Histórico" 
              autocomplete="off"
              aria-describedby="editar-destino-direccion-error editar-destino-direccion-help"
              class="form-input"
              maxlength="200"
              data-original-value=""
            />
            <div id="editar-destino-direccion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="editar-destino-direccion-help" class="help-text">Dirección específica del destino</div>
          </div>
        </div>
        
        <!-- Información de Contacto -->
        <div class="form-section" aria-labelledby="editar-contacto-destino-titulo">
          <h3 id="editar-contacto-destino-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📞</span>
            Información de Contacto
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-telefono" class="form-label">
                <span class="label-icon" aria-hidden="true">📱</span>
                Teléfono
              </label>
              <input 
                type="tel" 
                id="editar-destino-telefono" 
                name="telefono" 
                placeholder="Ej: 07 2840 123" 
                autocomplete="tel"
                aria-describedby="editar-destino-telefono-error editar-destino-telefono-help"
                class="form-input"
                pattern="[0-9\s\-\(\)]+"
                maxlength="20"
                data-original-value=""
              />
              <div id="editar-destino-telefono-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-telefono-help" class="help-text">Número de teléfono del destino</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-email" class="form-label">
                <span class="label-icon" aria-hidden="true">📧</span>
                Email
              </label>
              <input 
                type="email" 
                id="editar-destino-email" 
                name="email" 
                placeholder="Ej: info@destino.com" 
                autocomplete="email"
                aria-describedby="editar-destino-email-error editar-destino-email-help"
                class="form-input"
                data-original-value=""
              />
              <div id="editar-destino-email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-email-help" class="help-text">Correo electrónico de contacto</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="editar-destino-web" class="form-label">
              <span class="label-icon" aria-hidden="true">🌐</span>
              Sitio Web
            </label>
            <input 
              type="url" 
              id="editar-destino-web" 
              name="sitio_web" 
              placeholder="Ej: https://www.destino.com" 
              autocomplete="url"
              aria-describedby="editar-destino-web-error editar-destino-web-help"
              class="form-input"
              data-original-value=""
            />
            <div id="editar-destino-web-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="editar-destino-web-help" class="help-text">URL del sitio web oficial</div>
          </div>
        </div>
        
        <!-- Información de Horarios y Precios -->
        <div class="form-section" aria-labelledby="editar-horarios-precios-titulo">
          <h3 id="editar-horarios-precios-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">⏰</span>
            Horarios y Precios
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-horario" class="form-label">
                <span class="label-icon" aria-hidden="true">🕒</span>
                Horario de Atención
              </label>
              <input 
                type="text" 
                id="editar-destino-horario" 
                name="horario" 
                placeholder="Ej: Lunes a Domingo 8:00 - 18:00" 
                autocomplete="off"
                aria-describedby="editar-destino-horario-error editar-destino-horario-help"
                class="form-input"
                maxlength="100"
                data-original-value=""
              />
              <div id="editar-destino-horario-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-horario-help" class="help-text">Horarios de apertura y cierre</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-precio" class="form-label">
                <span class="label-icon" aria-hidden="true">💰</span>
                Precio de Entrada
              </label>
              <input 
                type="text" 
                id="editar-destino-precio" 
                name="precio" 
                placeholder="Ej: Gratis, $5, $10-20" 
                autocomplete="off"
                aria-describedby="editar-destino-precio-error editar-destino-precio-help"
                class="form-input"
                maxlength="50"
                data-original-value=""
              />
              <div id="editar-destino-precio-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-precio-help" class="help-text">Costo de entrada o visita</div>
            </div>
          </div>
        </div>
        
        <!-- Descripción y Características -->
        <div class="form-section" aria-labelledby="editar-descripcion-titulo">
          <h3 id="editar-descripcion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📝</span>
            Descripción y Características
          </h3>
          
          <div class="form-group">
            <label for="editar-destino-descripcion" class="form-label required">
              <span class="label-icon" aria-hidden="true">📄</span>
              Descripción
            </label>
            <textarea 
              id="editar-destino-descripcion" 
              name="descripcion" 
              placeholder="Describe el destino, sus atractivos principales, historia, etc..." 
              required 
              aria-describedby="editar-destino-descripcion-error editar-destino-descripcion-help"
              class="form-textarea"
              rows="4"
              minlength="20"
              maxlength="1000"
              data-original-value=""
            ></textarea>
            <div class="textarea-counter">
              <span id="editar-descripcion-counter">0</span> / 1000 caracteres
            </div>
            <div id="editar-destino-descripcion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="editar-destino-descripcion-help" class="help-text">Descripción detallada del destino (mínimo 20 caracteres)</div>
          </div>
          
          <div class="form-group">
            <label for="editar-destino-caracteristicas" class="form-label">
              <span class="label-icon" aria-hidden="true">🏷️</span>
              Características Especiales
            </label>
            <div class="checkbox-group">
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="accesible" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Accesible para personas con discapacidad</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="familiar" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Apto para familias</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="aventura" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de aventura</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="cultural" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo cultural</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="naturaleza" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de naturaleza</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="gastronomico" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo gastronómico</span>
              </label>
            </div>
            <div class="help-text">Selecciona las características que aplican al destino</div>
          </div>
        </div>
        
        <!-- Historial de Cambios -->
        <div class="form-section" aria-labelledby="historial-titulo">
          <h3 id="historial-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📋</span>
            Historial de Cambios
          </h3>
          <div class="historial-container">
            <div class="historial-item">
              <span class="historial-fecha">2024-01-15 14:30</span>
              <span class="historial-usuario">admin@turismo.com</span>
              <span class="historial-accion">Actualizó información de contacto</span>
            </div>
            <div class="historial-item">
              <span class="historial-fecha">2024-01-10 09:15</span>
              <span class="historial-usuario">editor@turismo.com</span>
              <span class="historial-accion">Modificó horarios de atención</span>
            </div>
          </div>
        </div>
        
        <!-- Botones de acción -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-editar-submit"
            aria-label="Actualizar destino turístico"
            id="editar-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">💾</span>
            <span class="btn-text">Actualizar Destino</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-editar-cancel"
            onclick="confirmarCerrarEditar()"
            aria-label="Cancelar edición"
          >
            <span class="btn-icon" aria-hidden="true">❌</span>
            <span class="btn-text">Cancelar</span>
          </button>
          
          <button 
            type="button" 
            class="btn-editar-restaurar"
            onclick="restaurarDatosOriginales()"
            aria-label="Restaurar datos originales"
            id="btn-restaurar"
            style="display: none;"
          >
            <span class="btn-icon" aria-hidden="true">↺</span>
            <span class="btn-text">Restaurar Original</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="editar-status" class="editar-status" role="status" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- Modal de Búsqueda con Filtros -->
  <div id="modal-busqueda-filtros" class="modal oculto" role="dialog" aria-labelledby="modal-busqueda-titulo" aria-hidden="true">
    <div class="modal-content busqueda-modal">
      <span class="cerrar" onclick="cerrarModal('modal-busqueda-filtros')" aria-label="Cerrar búsqueda con filtros">&times;</span>
      
      <div class="busqueda-header">
        <div class="busqueda-icon" aria-hidden="true">🔍</div>
        <h2 id="modal-busqueda-titulo">Búsqueda Avanzada</h2>
        <p class="busqueda-subtitle">Encuentra destinos turísticos con filtros específicos</p>
      </div>
      
      <form id="form-busqueda-filtros" role="form" aria-describedby="busqueda-descripcion">
        <p id="busqueda-descripcion" class="sr-only">Formulario de búsqueda avanzada con múltiples filtros</p>
        
        <!-- Filtros Básicos -->
        <div class="form-section" aria-labelledby="filtros-basicos-titulo">
          <h3 id="filtros-basicos-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">🎯</span>
            Filtros Básicos
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-nombre" class="form-label">
                <span class="label-icon" aria-hidden="true">🏷️</span>
                Nombre del Destino
              </label>
              <input 
                type="text" 
                id="busqueda-nombre" 
                name="nombre" 
                placeholder="Buscar por nombre..." 
                autocomplete="off"
                class="form-input"
                list="sugerencias-nombres"
              />
              <datalist id="sugerencias-nombres">
                <option value="Centro Histórico de Cuenca">
                <option value="Playa de Salinas">
                <option value="Baños de Agua Santa">
                <option value="Islas Galápagos">
              </datalist>
            </div>
            
            <div class="form-group">
              <label for="busqueda-tipo" class="form-label">
                <span class="label-icon" aria-hidden="true">🏛️</span>
                Tipo de Destino
              </label>
              <select id="busqueda-tipo" name="tipo" class="form-input">
                <option value="">Todos los tipos</option>
                <option value="ciudad">Ciudad</option>
                <option value="playa">Playa</option>
                <option value="montaña">Montaña</option>
                <option value="selva">Selva</option>
                <option value="isla">Isla</option>
                <option value="parque">Parque Nacional</option>
                <option value="monumento">Monumento</option>
                <option value="museo">Museo</option>
                <option value="restaurante">Restaurante</option>
                <option value="hotel">Hotel</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-provincia" class="form-label">
                <span class="label-icon" aria-hidden="true">🗺️</span>
                Provincia
              </label>
              <select id="busqueda-provincia" name="provincia" class="form-input">
                <option value="">Todas las provincias</option>
                <option value="azuay">Azuay</option>
                <option value="guayas">Guayas</option>
                <option value="pichincha">Pichincha</option>
                <option value="manabi">Manabí</option>
                <option value="galapagos">Galápagos</option>
                <option value="tungurahua">Tungurahua</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="busqueda-ciudad" class="form-label">
                <span class="label-icon" aria-hidden="true">🏙️</span>
                Ciudad
              </label>
              <input 
                type="text" 
                id="busqueda-ciudad" 
                name="ciudad" 
                placeholder="Buscar por ciudad..." 
                autocomplete="off"
                class="form-input"
              />
            </div>
          </div>
        </div>
        
        <!-- Filtros de Características -->
        <div class="form-section" aria-labelledby="filtros-caracteristicas-titulo">
          <h3 id="filtros-caracteristicas-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">🏷️</span>
            Características Especiales
          </h3>
          
          <div class="checkbox-group">
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="accesible" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Accesible para personas con discapacidad</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="familiar" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Apto para familias</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="aventura" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo de aventura</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="cultural" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo cultural</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="naturaleza" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo de naturaleza</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="gastronomico" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo gastronómico</span>
            </label>
          </div>
        </div>
        
        <!-- Filtros de Precio -->
        <div class="form-section" aria-labelledby="filtros-precio-titulo">
          <h3 id="filtros-precio-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">💰</span>
            Rango de Precio
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-precio-min" class="form-label">
                <span class="label-icon" aria-hidden="true">📉</span>
                Precio Mínimo
              </label>
              <input 
                type="number" 
                id="busqueda-precio-min" 
                name="precio_min" 
                placeholder="0" 
                min="0"
                class="form-input"
              />
            </div>
            
            <div class="form-group">
              <label for="busqueda-precio-max" class="form-label">
                <span class="label-icon" aria-hidden="true">📈</span>
                Precio Máximo
              </label>
              <input 
                type="number" 
                id="busqueda-precio-max" 
                name="precio_max" 
                placeholder="100" 
                min="0"
                class="form-input"
              />
            </div>
          </div>
          
          <div class="form-group">
            <label for="busqueda-gratis" class="form-label">
              <span class="label-icon" aria-hidden="true">🎫</span>
              Incluir Gratuitos
            </label>
            <div class="radio-group">
              <label class="radio-wrapper">
                <input type="radio" name="incluir_gratis" value="si" checked />
                <span class="radio-mark"></span>
                <span class="radio-text">Sí, incluir destinos gratuitos</span>
              </label>
              <label class="radio-wrapper">
                <input type="radio" name="incluir_gratis" value="no" />
                <span class="radio-mark"></span>
                <span class="radio-text">No, solo destinos con costo</span>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Filtros de Ordenamiento -->
        <div class="form-section" aria-labelledby="filtros-orden-titulo">
          <h3 id="filtros-orden-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">📊</span>
            Ordenar Por
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-orden" class="form-label">
                <span class="label-icon" aria-hidden="true">🔄</span>
                Criterio de Orden
              </label>
              <select id="busqueda-orden" name="orden" class="form-input">
                <option value="nombre">Nombre (A-Z)</option>
                <option value="nombre_desc">Nombre (Z-A)</option>
                <option value="precio">Precio (Menor a Mayor)</option>
                <option value="precio_desc">Precio (Mayor a Menor)</option>
                <option value="popularidad">Popularidad</option>
                <option value="fecha">Fecha de Registro</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="busqueda-limit" class="form-label">
                <span class="label-icon" aria-hidden="true">📄</span>
                Resultados por Página
              </label>
              <select id="busqueda-limit" name="limit" class="form-input">
                <option value="10">10 resultados</option>
                <option value="20" selected>20 resultados</option>
                <option value="50">50 resultados</option>
                <option value="100">100 resultados</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Botones de acción -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-busqueda-submit"
            aria-label="Aplicar filtros de búsqueda"
            id="busqueda-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">🔍</span>
            <span class="btn-text">Buscar Destinos</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-busqueda-limpiar"
            onclick="limpiarFiltrosBusqueda()"
            aria-label="Limpiar todos los filtros"
          >
            <span class="btn-icon" aria-hidden="true">🧹</span>
            <span class="btn-text">Limpiar Filtros</span>
          </button>
          
          <button 
            type="button" 
            class="btn-busqueda-guardar"
            onclick="guardarFiltrosFrecuentes()"
            aria-label="Guardar filtros como favoritos"
          >
            <span class="btn-icon" aria-hidden="true">⭐</span>
            <span class="btn-text">Guardar Filtros</span>
          </button>
          
          <button 
            type="button" 
            class="btn-busqueda-cancel"
            onclick="cerrarModal('modal-busqueda-filtros')"
            aria-label="Cancelar búsqueda"
          >
            <span class="btn-icon" aria-hidden="true">❌</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Resultados de búsqueda -->
        <div class="busqueda-resultados" id="busqueda-resultados">
          <div class="resultados-header">
            <h4>Resultados de Búsqueda</h4>
            <span class="resultados-contador" id="resultados-contador">0 destinos encontrados</span>
          </div>
          <div class="resultados-lista" id="resultados-lista">
            <!-- Los resultados se cargarán dinámicamente aquí -->
          </div>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="busqueda-status" class="busqueda-status" role="status" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- Modal de Eliminar Registro -->
  <div id="modal-eliminar-registro" class="modal oculto" role="dialog" aria-labelledby="modal-eliminar-titulo" aria-hidden="true">
    <div class="modal-content eliminar-modal">
      <span class="cerrar" onclick="cerrarModal('modal-eliminar-registro')" aria-label="Cerrar confirmación de eliminación">&times;</span>
      
      <div class="eliminar-header">
        <div class="eliminar-icon" aria-hidden="true">🗑️</div>
        <h2 id="modal-eliminar-titulo">Confirmar Eliminación</h2>
        <p class="eliminar-subtitle">Esta acción no se puede deshacer</p>
      </div>
      
      <div class="eliminar-content">
        <div class="eliminar-info">
          <h3>¿Estás seguro de que quieres eliminar este destino?</h3>
          <div class="destino-a-eliminar">
            <div class="destino-detalle">
              <span class="destino-id">ID: <span id="eliminar-destino-id">-</span></span>
              <span class="destino-nombre">Nombre: <span id="eliminar-destino-nombre">-</span></span>
              <span class="destino-tipo">Tipo: <span id="eliminar-destino-tipo">-</span></span>
              <span class="destino-provincia">Provincia: <span id="eliminar-destino-provincia">-</span></span>
            </div>
            <div class="destino-descripcion">
              <p id="eliminar-destino-descripcion">-</p>
            </div>
          </div>
        </div>
        
        <div class="eliminar-advertencia">
          <div class="advertencia-icon" aria-hidden="true">⚠️</div>
          <div class="advertencia-text">
            <h4>Advertencia Importante</h4>
            <ul>
              <li>Esta acción eliminará permanentemente el destino del sistema</li>
              <li>No se podrá recuperar la información eliminada</li>
              <li>Si el destino tiene reservas activas, no se podrá eliminar</li>
              <li>Se registrará esta acción en el historial de auditoría</li>
            </ul>
          </div>
        </div>
        
        <div class="eliminar-opciones">
          <label class="checkbox-wrapper">
            <input type="checkbox" id="eliminar-confirmar" required />
            <span class="checkmark"></span>
            <span class="checkbox-text">He leído y entiendo las consecuencias de esta acción</span>
          </label>
          
          <label class="checkbox-wrapper">
            <input type="checkbox" id="eliminar-backup" />
            <span class="checkmark"></span>
            <span class="checkbox-text">Crear respaldo antes de eliminar (recomendado)</span>
          </label>
        </div>
      </div>
      
      <!-- Botones de acción -->
      <div class="form-actions">
        <button 
          type="button" 
          class="btn-eliminar-confirmar"
          onclick="confirmarEliminacion()"
          aria-label="Confirmar eliminación del destino"
          id="eliminar-confirmar-btn"
          disabled
        >
          <span class="btn-icon" aria-hidden="true">🗑️</span>
          <span class="btn-text">Eliminar Destino</span>
          <div class="btn-loading" aria-hidden="true"></div>
        </button>
        
        <button 
          type="button" 
          class="btn-eliminar-cancel"
          onclick="cerrarModal('modal-eliminar-registro')"
          aria-label="Cancelar eliminación"
        >
          <span class="btn-icon" aria-hidden="true">❌</span>
          <span class="btn-text">Cancelar</span>
        </button>
        
        <button 
          type="button" 
          class="btn-eliminar-desactivar"
          onclick="desactivarDestino()"
          aria-label="Desactivar destino en lugar de eliminar"
        >
          <span class="btn-icon" aria-hidden="true">🚫</span>
          <span class="btn-text">Desactivar (Recomendado)</span>
        </button>
      </div>
      
      <!-- Mensaje de estado -->
      <div id="eliminar-status" class="eliminar-status" role="status" aria-live="polite"></div>
    </div>
  </div>

  <script>
    // ===== FUNCIONES PARA FORMULARIO DE GUARDAR REGISTRO =====
    
    // Función para manejar el formulario de guardar registro
    function manejarFormularioGuardar(event) {
      event.preventDefault();
      
      // Mostrar estado de carga
      const submitBtn = document.getElementById('guardar-submit-btn');
      const statusDiv = document.getElementById('guardar-status');
      
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Guardando destino turístico...';
      statusDiv.className = 'guardar-status info';
      
      // Simular envío (en una aplicación real, aquí se enviaría al servidor)
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        statusDiv.textContent = '¡Destino turístico guardado exitosamente!';
        statusDiv.className = 'guardar-status success';
        
        // Limpiar formulario después de 2 segundos
        setTimeout(() => {
          limpiarFormularioGuardar();
          cerrarModal('modal-guardar-registro');
        }, 2000);
      }, 2000);
    }
    
    // Función para limpiar el formulario de guardar
    function limpiarFormularioGuardar() {
      document.getElementById('form-guardar-registro').reset();
      document.getElementById('guardar-status').textContent = '';
      document.getElementById('guardar-status').className = 'guardar-status';
      
      // Limpiar contador de caracteres
      document.getElementById('descripcion-counter').textContent = '0';
      
      // Limpiar mensajes de error
      const errorMessages = document.querySelectorAll('#form-guardar-registro .error-message');
      errorMessages.forEach(error => error.textContent = '');
      
      // Limpiar clases de error
      const inputs = document.querySelectorAll('#form-guardar-registro .form-input, #form-guardar-registro .form-textarea');
      inputs.forEach(input => input.classList.remove('error'));
    }
    
    // Función para validar en tiempo real
    function validarCampoGuardar(input) {
      const value = input.value.trim();
      const errorElement = document.getElementById(input.id + '-error');
      let isValid = true;
      let errorMessage = '';
      
      // Validaciones específicas por tipo de campo
      switch(input.name) {
        case 'nombre':
          if (!value) {
            errorMessage = 'El nombre del destino es obligatorio';
            isValid = false;
          } else if (value.length < 3) {
            errorMessage = 'El nombre debe tener al menos 3 caracteres';
            isValid = false;
          }
          break;
          
        case 'tipo':
          if (!value) {
            errorMessage = 'Debe seleccionar un tipo de destino';
            isValid = false;
          }
          break;
          
        case 'provincia':
          if (!value) {
            errorMessage = 'Debe seleccionar una provincia';
            isValid = false;
          }
          break;
          
        case 'descripcion':
          if (!value) {
            errorMessage = 'La descripción es obligatoria';
            isValid = false;
          } else if (value.length < 20) {
            errorMessage = 'La descripción debe tener al menos 20 caracteres';
            isValid = false;
          }
          break;
          
        case 'email':
          if (value && !isValidEmail(value)) {
            errorMessage = 'Ingrese un email válido';
            isValid = false;
          }
          break;
          
        case 'sitio_web':
          if (value && !isValidUrl(value)) {
            errorMessage = 'Ingrese una URL válida';
            isValid = false;
          }
          break;
          
        case 'latitud':
          if (value && (isNaN(value) || value < -5 || value > 2)) {
            errorMessage = 'La latitud debe estar entre -5 y 2';
            isValid = false;
          }
          break;
          
        case 'longitud':
          if (value && (isNaN(value) || value < -82 || value > -75)) {
            errorMessage = 'La longitud debe estar entre -82 y -75';
            isValid = false;
          }
          break;
      }
      
      // Mostrar/ocultar error
      if (isValid) {
        input.classList.remove('error');
        errorElement.textContent = '';
      } else {
        input.classList.add('error');
        errorElement.textContent = errorMessage;
      }
      
      return isValid;
    }
    
    // Función para validar email
    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }
    
    // Función para validar URL
    function isValidUrl(url) {
      try {
        new URL(url);
        return true;
      } catch {
        return false;
      }
    }
    
    // Función para actualizar contador de caracteres
    function actualizarContadorGuardar() {
      const textarea = document.getElementById('destino-descripcion');
      const counter = document.getElementById('descripcion-counter');
      const length = textarea.value.length;
      counter.textContent = length;
      
      if (length > 900) {
        counter.style.color = '#dc3545';
      } else if (length > 800) {
        counter.style.color = '#ffc107';
      } else {
        counter.style.color = '#6c757d';
      }
    }
    
    // Función para guardar borrador
    function guardarBorradorGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const formData = new FormData(form);
      const data = {};
      
      formData.forEach((value, key) => {
        data[key] = value;
      });
      
      // Guardar en localStorage
      localStorage.setItem('borradorDestino', JSON.stringify(data));
      
      // Mostrar confirmación
      const statusDiv = document.getElementById('guardar-status');
      statusDiv.textContent = 'Borrador guardado automáticamente';
      statusDiv.className = 'guardar-status info';
      
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = 'guardar-status';
      }, 2000);
    }
    
    // Función para cargar borrador
    function cargarBorradorGuardar() {
      const borrador = localStorage.getItem('borradorDestino');
      if (borrador) {
        const data = JSON.parse(borrador);
        const form = document.getElementById('form-guardar-registro');
        
        // Llenar campos
        Object.keys(data).forEach(key => {
          const input = form.querySelector(`[name="${key}"]`);
          if (input) {
            if (input.type === 'checkbox') {
              input.checked = data[key] === 'on';
            } else {
              input.value = data[key];
            }
          }
        });
        
        // Actualizar contador
        actualizarContadorGuardar();
        
        // Mostrar confirmación
        const statusDiv = document.getElementById('guardar-status');
        statusDiv.textContent = 'Borrador cargado automáticamente';
        statusDiv.className = 'guardar-status info';
        
        setTimeout(() => {
          statusDiv.textContent = '';
          statusDiv.className = 'guardar-status';
        }, 2000);
      }
    }
    
    // Función para confirmar antes de cerrar
    function confirmarCerrarGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const hasData = Array.from(form.elements).some(element => {
        if (element.type === 'checkbox') {
          return element.checked;
        }
        return element.value && element.value.trim() !== '';
      });
      
      if (hasData) {
        if (confirm('¿Estás seguro de que quieres cerrar? Los datos no guardados se perderán.')) {
          cerrarModal('modal-guardar-registro');
        }
      } else {
        cerrarModal('modal-guardar-registro');
      }
    }
    
    // ===== FUNCIONES PARA FORMULARIO DE EDITAR REGISTRO =====
    
    // Función para abrir modal de editar
    function abrirModalEditar(destinoId) {
      // Simular carga de datos del destino
      const destino = {
        id: destinoId,
        nombre: 'Centro Histórico de Cuenca',
        tipo: 'ciudad',
        provincia: 'azuay',
        ciudad: 'Cuenca',
        latitud: -2.8968,
        longitud: -79.0045,
        direccion: 'Calle Larga 10-77, Centro Histórico',
        telefono: '07 2840 123',
        email: 'info@cuenca.com',
        sitio_web: 'https://www.cuenca.com',
        horario: 'Lunes a Domingo 8:00 - 18:00',
        precio: 'Gratis',
        descripcion: 'El Centro Histórico de Cuenca es uno de los más hermosos de América Latina, declarado Patrimonio Cultural de la Humanidad por la UNESCO en 1999. Sus calles empedradas, iglesias coloniales y plazas históricas transportan a los visitantes a la época colonial.',
        caracteristicas: ['cultural', 'accesible', 'familiar'],
        fecha_modificacion: '2024-01-15 14:30'
      };
      
      // Llenar formulario con datos
      document.getElementById('editar-destino-id').textContent = destino.id;
      document.getElementById('editar-fecha-modificacion').textContent = destino.fecha_modificacion;
      
      // Llenar campos del formulario
      document.getElementById('editar-destino-nombre').value = destino.nombre;
      document.getElementById('editar-destino-tipo').value = destino.tipo;
      document.getElementById('editar-destino-provincia').value = destino.provincia;
      document.getElementById('editar-destino-ciudad').value = destino.ciudad;
      document.getElementById('editar-destino-latitud').value = destino.latitud;
      document.getElementById('editar-destino-longitud').value = destino.longitud;
      document.getElementById('editar-destino-direccion').value = destino.direccion;
      document.getElementById('editar-destino-telefono').value = destino.telefono;
      document.getElementById('editar-destino-email').value = destino.email;
      document.getElementById('editar-destino-web').value = destino.sitio_web;
      document.getElementById('editar-destino-horario').value = destino.horario;
      document.getElementById('editar-destino-precio').value = destino.precio;
      document.getElementById('editar-destino-descripcion').value = destino.descripcion;
      
      // Llenar checkboxes de características
      const checkboxes = document.querySelectorAll('#form-editar-registro input[name="caracteristicas"]');
      checkboxes.forEach(checkbox => {
        checkbox.checked = destino.caracteristicas.includes(checkbox.value);
      });
      
      // Guardar valores originales
      guardarValoresOriginales();
      
      // Actualizar contador
      actualizarContadorEditar();
      
      // Abrir modal
      document.getElementById('modal-editar-registro').classList.remove('oculto');
    }
    
    // Función para guardar valores originales
    function guardarValoresOriginales() {
      const form = document.getElementById('form-editar-registro');
      const inputs = form.querySelectorAll('input, select, textarea');
      
      inputs.forEach(input => {
        if (input.type === 'checkbox') {
          input.setAttribute('data-original-value', input.checked.toString());
        } else {
          input.setAttribute('data-original-value', input.value);
        }
      });
    }
    
    // Función para detectar cambios
    function detectarCambios() {
      const form = document.getElementById('form-editar-registro');
      const inputs = form.querySelectorAll('input, select, textarea');
      const btnRestaurar = document.getElementById('btn-restaurar');
      let hayCambios = false;
      
      inputs.forEach(input => {
        const originalValue = input.getAttribute('data-original-value');
        let currentValue;
        
        if (input.type === 'checkbox') {
          currentValue = input.checked.toString();
        } else {
          currentValue = input.value;
        }
        
        if (originalValue !== currentValue) {
          input.classList.add('modificado');
          hayCambios = true;
        } else {
          input.classList.remove('modificado');
        }
      });
      
      // Mostrar/ocultar botón restaurar
      if (hayCambios) {
        btnRestaurar.style.display = 'inline-flex';
      } else {
        btnRestaurar.style.display = 'none';
      }
      
      return hayCambios;
    }
    
    // Función para restaurar datos originales
    function restaurarDatosOriginales() {
      const form = document.getElementById('form-editar-registro');
      const inputs = form.querySelectorAll('input, select, textarea');
      
      inputs.forEach(input => {
        const originalValue = input.getAttribute('data-original-value');
        
        if (input.type === 'checkbox') {
          input.checked = originalValue === 'true';
        } else {
          input.value = originalValue;
        }
        
        input.classList.remove('modificado');
      });
      
      // Ocultar botón restaurar
      document.getElementById('btn-restaurar').style.display = 'none';
      
      // Actualizar contador
      actualizarContadorEditar();
      
      // Mostrar confirmación
      const statusDiv = document.getElementById('editar-status');
      statusDiv.textContent = 'Datos originales restaurados';
      statusDiv.className = 'editar-status info';
      
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = 'editar-status';
      }, 2000);
    }
    
    // Función para manejar formulario de editar
    function manejarFormularioEditar(event) {
      event.preventDefault();
      
      // Validar formulario
      const form = event.target;
      const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
      let isValid = true;
      
      inputs.forEach(input => {
        if (!validarCampoEditar(input)) {
          isValid = false;
        }
      });
      
      if (!isValid) {
        return;
      }
      
      // Verificar si hay cambios
      if (!detectarCambios()) {
        const statusDiv = document.getElementById('editar-status');
        statusDiv.textContent = 'No se detectaron cambios para guardar';
        statusDiv.className = 'editar-status info';
        return;
      }
      
      // Mostrar estado de carga
      const submitBtn = document.getElementById('editar-submit-btn');
      const statusDiv = document.getElementById('editar-status');
      
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Actualizando destino turístico...';
      statusDiv.className = 'editar-status info';
      
      // Simular envío
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        statusDiv.textContent = '¡Destino turístico actualizado exitosamente!';
        statusDiv.className = 'editar-status success';
        
        // Cerrar modal después de 2 segundos
        setTimeout(() => {
          cerrarModal('modal-editar-registro');
        }, 2000);
      }, 2000);
    }
    
    // Función para validar campo de editar
    function validarCampoEditar(input) {
      const value = input.value.trim();
      const errorElement = document.getElementById(input.id + '-error');
      let isValid = true;
      let errorMessage = '';
      
      // Validaciones específicas por tipo de campo
      switch(input.name) {
        case 'nombre':
          if (!value) {
            errorMessage = 'El nombre del destino es obligatorio';
            isValid = false;
          } else if (value.length < 3) {
            errorMessage = 'El nombre debe tener al menos 3 caracteres';
            isValid = false;
          }
          break;
          
        case 'tipo':
          if (!value) {
            errorMessage = 'Debe seleccionar un tipo de destino';
            isValid = false;
          }
          break;
          
        case 'provincia':
          if (!value) {
            errorMessage = 'Debe seleccionar una provincia';
            isValid = false;
          }
          break;
          
        case 'descripcion':
          if (!value) {
            errorMessage = 'La descripción es obligatoria';
            isValid = false;
          } else if (value.length < 20) {
            errorMessage = 'La descripción debe tener al menos 20 caracteres';
            isValid = false;
          }
          break;
          
        case 'email':
          if (value && !isValidEmail(value)) {
            errorMessage = 'Ingrese un email válido';
            isValid = false;
          }
          break;
          
        case 'sitio_web':
          if (value && !isValidUrl(value)) {
            errorMessage = 'Ingrese una URL válida';
            isValid = false;
          }
          break;
          
        case 'latitud':
          if (value && (isNaN(value) || value < -5 || value > 2)) {
            errorMessage = 'La latitud debe estar entre -5 y 2';
            isValid = false;
          }
          break;
          
        case 'longitud':
          if (value && (isNaN(value) || value < -82 || value > -75)) {
            errorMessage = 'La longitud debe estar entre -82 y -75';
            isValid = false;
          }
          break;
      }
      
      // Mostrar/ocultar error
      if (isValid) {
        input.classList.remove('error');
        errorElement.textContent = '';
      } else {
        input.classList.add('error');
        errorElement.textContent = errorMessage;
      }
      
      return isValid;
    }
    
    // Función para actualizar contador de editar
    function actualizarContadorEditar() {
      const textarea = document.getElementById('editar-destino-descripcion');
      const counter = document.getElementById('editar-descripcion-counter');
      const length = textarea.value.length;
      counter.textContent = length;
      
      if (length > 900) {
        counter.style.color = '#dc3545';
      } else if (length > 800) {
        counter.style.color = '#ffc107';
      } else {
        counter.style.color = '#6c757d';
      }
    }
    
    // Función para confirmar cerrar editar
    function confirmarCerrarEditar() {
      if (detectarCambios()) {
        if (confirm('¿Estás seguro de que quieres cerrar? Los cambios no guardados se perderán.')) {
          cerrarModal('modal-editar-registro');
        }
      } else {
        cerrarModal('modal-editar-registro');
      }
    }
    
    // ===== FUNCIONES PARA FORMULARIO DE BÚSQUEDA CON FILTROS =====
    
    // Función para abrir modal de búsqueda
    function abrirModalBusqueda() {
      document.getElementById('modal-busqueda-filtros').classList.remove('oculto');
      cargarFiltrosGuardados();
    }
    
    // Función para manejar formulario de búsqueda
    function manejarFormularioBusqueda(event) {
      event.preventDefault();
      
      // Mostrar estado de carga
      const submitBtn = document.getElementById('busqueda-submit-btn');
      const statusDiv = document.getElementById('busqueda-status');
      
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Buscando destinos...';
      statusDiv.className = 'busqueda-status info';
      
      // Simular búsqueda
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        realizarBusqueda();
      }, 1500);
    }
    
    // Función para realizar búsqueda
    function realizarBusqueda() {
      const form = document.getElementById('form-busqueda-filtros');
      const formData = new FormData(form);
      const filtros = {};
      
      formData.forEach((value, key) => {
        if (value) {
          filtros[key] = value;
        }
      });
      
      // Simular resultados
      const resultados = [
        {
          id: 1,
          nombre: 'Centro Histórico de Cuenca',
          tipo: 'Ciudad',
          provincia: 'Azuay',
          descripcion: 'Patrimonio Cultural de la Humanidad con arquitectura colonial.',
          precio: 'Gratis'
        },
        {
          id: 2,
          nombre: 'Playa de Salinas',
          tipo: 'Playa',
          provincia: 'Santa Elena',
          descripcion: 'Hermosa playa con aguas cristalinas y arena blanca.',
          precio: '$5'
        },
        {
          id: 3,
          nombre: 'Baños de Agua Santa',
          tipo: 'Montaña',
          provincia: 'Tungurahua',
          descripcion: 'Destino de aventura con cascadas y aguas termales.',
          precio: '$10-20'
        }
      ];
      
      mostrarResultadosBusqueda(resultados);
    }
    
    // Función para mostrar resultados
    function mostrarResultadosBusqueda(resultados) {
      const contador = document.getElementById('resultados-contador');
      const lista = document.getElementById('resultados-lista');
      const statusDiv = document.getElementById('busqueda-status');
      
      contador.textContent = `${resultados.length} destinos encontrados`;
      
      if (resultados.length === 0) {
        lista.innerHTML = '<div class="no-resultados">No se encontraron destinos con los filtros aplicados</div>';
        statusDiv.textContent = 'No se encontraron resultados';
        statusDiv.className = 'busqueda-status info';
      } else {
        lista.innerHTML = resultados.map(destino => `
          <div class="resultado-item">
            <div class="resultado-nombre">${destino.nombre}</div>
            <div class="resultado-tipo">${destino.tipo}</div>
            <div class="resultado-provincia">${destino.provincia}</div>
            <div class="resultado-descripcion">${destino.descripcion}</div>
            <div class="resultado-precio">Precio: ${destino.precio}</div>
            <div class="resultado-acciones">
              <button class="btn-resultado ver" onclick="verDestino(${destino.id})">👁️ Ver</button>
              <button class="btn-resultado editar" onclick="abrirModalEditar(${destino.id})">✏️ Editar</button>
              <button class="btn-resultado eliminar" onclick="abrirModalEliminar(${destino.id})">🗑️ Eliminar</button>
            </div>
          </div>
        `).join('');
        
        statusDiv.textContent = 'Búsqueda completada exitosamente';
        statusDiv.className = 'busqueda-status success';
      }
    }
    
    // Función para limpiar filtros
    function limpiarFiltrosBusqueda() {
      document.getElementById('form-busqueda-filtros').reset();
      document.getElementById('resultados-lista').innerHTML = '';
      document.getElementById('resultados-contador').textContent = '0 destinos encontrados';
      document.getElementById('busqueda-status').textContent = '';
      document.getElementById('busqueda-status').className = 'busqueda-status';
    }
    
    // Función para guardar filtros frecuentes
    function guardarFiltrosFrecuentes() {
      const form = document.getElementById('form-busqueda-filtros');
      const formData = new FormData(form);
      const filtros = {};
      
      formData.forEach((value, key) => {
        if (value) {
          filtros[key] = value;
        }
      });
      
      // Guardar en localStorage
      const filtrosGuardados = JSON.parse(localStorage.getItem('filtrosFrecuentes') || '[]');
      filtrosGuardados.push({
        id: Date.now(),
        nombre: 'Filtros ' + new Date().toLocaleDateString(),
        filtros: filtros
      });
      
      localStorage.setItem('filtrosFrecuentes', JSON.stringify(filtrosGuardados));
      
      // Mostrar confirmación
      const statusDiv = document.getElementById('busqueda-status');
      statusDiv.textContent = 'Filtros guardados como favoritos';
      statusDiv.className = 'busqueda-status success';
      
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = 'busqueda-status';
      }, 2000);
    }
    
    // Función para cargar filtros guardados
    function cargarFiltrosGuardados() {
      const filtrosGuardados = JSON.parse(localStorage.getItem('filtrosFrecuentes') || '[]');
      if (filtrosGuardados.length > 0) {
        // Aquí se podrían mostrar los filtros guardados en un menú desplegable
        console.log('Filtros guardados:', filtrosGuardados);
      }
    }
    
    // ===== FUNCIONES PARA FORMULARIO DE ELIMINAR REGISTRO =====
    
    // Función para abrir modal de eliminar
    function abrirModalEliminar(destinoId) {
      // Simular carga de datos del destino
      const destino = {
        id: destinoId,
        nombre: 'Centro Histórico de Cuenca',
        tipo: 'Ciudad',
        provincia: 'Azuay',
        descripcion: 'Patrimonio Cultural de la Humanidad con arquitectura colonial.'
      };
      
      // Llenar información del destino
      document.getElementById('eliminar-destino-id').textContent = destino.id;
      document.getElementById('eliminar-destino-nombre').textContent = destino.nombre;
      document.getElementById('eliminar-destino-tipo').textContent = destino.tipo;
      document.getElementById('eliminar-destino-provincia').textContent = destino.provincia;
      document.getElementById('eliminar-destino-descripcion').textContent = destino.descripcion;
      
      // Resetear checkboxes
      document.getElementById('eliminar-confirmar').checked = false;
      document.getElementById('eliminar-backup').checked = false;
      
      // Deshabilitar botón de confirmar
      document.getElementById('eliminar-confirmar-btn').disabled = true;
      
      // Limpiar estado
      document.getElementById('eliminar-status').textContent = '';
      document.getElementById('eliminar-status').className = 'eliminar-status';
      
      // Abrir modal
      document.getElementById('modal-eliminar-registro').classList.remove('oculto');
    }
    
    // Función para confirmar eliminación
    function confirmarEliminacion() {
      const confirmarCheckbox = document.getElementById('eliminar-confirmar');
      const backupCheckbox = document.getElementById('eliminar-backup');
      const submitBtn = document.getElementById('eliminar-confirmar-btn');
      const statusDiv = document.getElementById('eliminar-status');
      
      if (!confirmarCheckbox.checked) {
        statusDiv.textContent = 'Debe confirmar que entiende las consecuencias';
        statusDiv.className = 'eliminar-status error';
        return;
      }
      
      // Mostrar estado de carga
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Eliminando destino...';
      statusDiv.className = 'eliminar-status info';
      
      // Simular eliminación
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        statusDiv.textContent = '¡Destino eliminado exitosamente!';
        statusDiv.className = 'eliminar-status success';
        
        // Cerrar modal después de 2 segundos
        setTimeout(() => {
          cerrarModal('modal-eliminar-registro');
        }, 2000);
      }, 2000);
    }
    
    // Función para desactivar destino
    function desactivarDestino() {
      const statusDiv = document.getElementById('eliminar-status');
      statusDiv.textContent = 'Destino desactivado (recomendado)';
      statusDiv.className = 'eliminar-status success';
      
      // Cerrar modal después de 2 segundos
      setTimeout(() => {
        cerrarModal('modal-eliminar-registro');
      }, 2000);
    }
    
    // Función para ver destino
    function verDestino(destinoId) {
      alert(`Viendo destino con ID: ${destinoId}`);
      // Aquí se abriría una vista detallada del destino
    }
    
    // Event listeners para todos los formularios
    document.addEventListener('DOMContentLoaded', function() {
      // Formulario de guardar
      const formGuardar = document.getElementById('form-guardar-registro');
      if (formGuardar) {
        formGuardar.addEventListener('submit', manejarFormularioGuardar);
        
        // Validación en tiempo real
        const inputs = formGuardar.querySelectorAll('.form-input, .form-textarea');
        inputs.forEach(input => {
          input.addEventListener('blur', () => validarCampoGuardar(input));
          input.addEventListener('input', () => {
            validarCampoGuardar(input);
            guardarBorradorGuardar();
          });
        });
        
        // Contador de caracteres
        const textarea = document.getElementById('destino-descripcion');
        if (textarea) {
          textarea.addEventListener('input', actualizarContadorGuardar);
        }
        
        // Cargar borrador al abrir
        cargarBorradorGuardar();
      }
      
      // Formulario de editar
      const formEditar = document.getElementById('form-editar-registro');
      if (formEditar) {
        formEditar.addEventListener('submit', manejarFormularioEditar);
        
        // Validación en tiempo real
        const inputs = formEditar.querySelectorAll('.form-input, .form-textarea');
        inputs.forEach(input => {
          input.addEventListener('blur', () => validarCampoEditar(input));
          input.addEventListener('input', () => {
            validarCampoEditar(input);
            detectarCambios();
          });
        });
        
        // Contador de caracteres
        const textareaEditar = document.getElementById('editar-destino-descripcion');
        if (textareaEditar) {
          textareaEditar.addEventListener('input', actualizarContadorEditar);
        }
      }
      
      // Formulario de búsqueda
      const formBusqueda = document.getElementById('form-busqueda-filtros');
      if (formBusqueda) {
        formBusqueda.addEventListener('submit', manejarFormularioBusqueda);
      }
      
      // Checkbox de confirmación para eliminar
      const confirmarCheckbox = document.getElementById('eliminar-confirmar');
      if (confirmarCheckbox) {
        confirmarCheckbox.addEventListener('change', function() {
          document.getElementById('eliminar-confirmar-btn').disabled = !this.checked;
        });
      }
    });
  </script>
</body>
</html>
