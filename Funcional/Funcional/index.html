<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Turismo Inclusivo Ecuador - Portal TurÃ­stico Accesible</title>
  <meta name="description" content="Portal turÃ­stico inclusivo de Ecuador con informaciÃ³n accesible sobre destinos, rutas y servicios turÃ­sticos" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <!-- Skip to main content link for screen readers -->
  <a href="#main-content" class="skip-link">Saltar al contenido principal</a>
  
  <!-- Indicador de estado de accesibilidad -->
  <div id="accessibility-status" class="accessibility-status" role="status" aria-live="polite">
    <span id="status-text">Accesibilidad: Normal</span>
  </div>
  
  <header role="banner">
    <div class="logo">
      <img src="img/logo-ecuador.png" alt="Logo oficial de Ecuador Turismo" class="logo-img" />
      <span class="logo-text">PORTAL TURÃSTICO EC</span>
    </div>

    <div class="menu-accesibilidad" role="navigation" aria-label="Herramientas de accesibilidad">
      <button class="menu-toggle" onclick="toggleAccMenu()" aria-expanded="false" aria-controls="accesibilidad-lista">
        <span aria-hidden="true">â™¿</span> Accesibilidad <span aria-hidden="true">â–¾</span>
      </button>
      <ul id="accesibilidad-lista" class="accesibilidad-lista oculto" role="menu">
        <li role="none"><button role="menuitem" onclick="activarContraste()" aria-label="Activar modo alto contraste">
          <span aria-hidden="true">ğŸŒ“</span> Alto contraste
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarModoMonocromatico()" aria-label="Activar modo monocromÃ¡tico">
          <span aria-hidden="true">ğŸ¨</span> Modo monocromÃ¡tico
        </button></li>
        <li role="none"><button role="menuitem" onclick="aumentarTexto()" aria-label="Aumentar tamaÃ±o del texto">
          <span aria-hidden="true">ğŸ‘ï¸</span> Aumentar texto
        </button></li>
        <li role="none"><button role="menuitem" onclick="reducirTexto()" aria-label="Reducir tamaÃ±o del texto">
          <span aria-hidden="true">ğŸ‘ï¸</span> Reducir texto
        </button></li>
        <li role="none"><button role="menuitem" onclick="ajustarEspaciado()" aria-label="Ajustar espaciado de texto">
          <span aria-hidden="true">ğŸ“</span> Ajustar espaciado
        </button></li>
        <li role="none"><button role="menuitem" onclick="usarFuenteLegible()" aria-label="Cambiar a fuente mÃ¡s legible">
          <span aria-hidden="true">ğŸ…°ï¸</span> Fuente legible
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarZoom()" aria-label="Activar zoom de pÃ¡gina">
          <span aria-hidden="true">ğŸ”</span> Zoom de pÃ¡gina
        </button></li>
        <li role="none"><button role="menuitem" onclick="resaltarEnlaces()" aria-label="Resaltar enlaces y foco">
          <span aria-hidden="true">âœ¨</span> Resaltar enlaces
        </button></li>
        <li role="none"><button role="menuitem" onclick="pausarAnimaciones()" aria-label="Pausar animaciones">
          <span aria-hidden="true">â¸ï¸</span> Pausar animaciones
        </button></li>
        <li role="none"><button role="menuitem" onclick="leerTexto()" aria-label="Activar lectura de texto en voz alta">
          <span aria-hidden="true">ğŸ‘‚</span> Lectura de texto
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarDescripcionAudio()" aria-label="Activar descripciÃ³n de audio">
          <span aria-hidden="true">ğŸ§</span> DescripciÃ³n de audio
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarSubtitulos()" aria-label="Activar subtÃ­tulos cerrados">
          <span aria-hidden="true">ğŸ“º</span> SubtÃ­tulos cerrados
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarSubtitulosDirecto()" aria-label="Activar subtÃ­tulos en directo">
          <span aria-hidden="true">ğŸ“¡</span> SubtÃ­tulos en directo
        </button></li>
        <li role="none"><button role="menuitem" onclick="descargarTranscripcion()" aria-label="Descargar transcripciÃ³n">
          <span aria-hidden="true">ğŸ“„</span> Descargar transcripciÃ³n
        </button></li>
        <li role="none"><button role="menuitem" onclick="mostrarControlesAudio()" aria-label="Mostrar controles de audio">
          <span aria-hidden="true">ğŸ”Š</span> Controles de audio
        </button></li>
        <li role="none"><button role="menuitem" onclick="activarAlertasVisuales()" aria-label="Activar alertas visuales">
          <span aria-hidden="true">âš ï¸</span> Alertas visuales
        </button></li>
        <li role="none"><button role="menuitem" onclick="restablecerAccesibilidad()" aria-label="Restablecer configuraciÃ³n de accesibilidad">
          <span aria-hidden="true">â™»ï¸</span> Restablecer
        </button></li>
        <li role="none"><button role="menuitem" onclick="mostrarInfoAccesibilidad()" aria-label="Mostrar informaciÃ³n de accesibilidad">
          <span aria-hidden="true">â„¹ï¸</span> InformaciÃ³n
        </button></li>
      </ul>
    </div>

    <!-- MenÃº principal mejorado -->
    <nav class="nav-main" role="navigation" aria-label="NavegaciÃ³n principal">
      <button class="menu-toggle-mobile" onclick="toggleMobileMenu()" aria-expanded="false" aria-controls="menu-principal" aria-label="Abrir menÃº principal">
        <span class="hamburger-icon" aria-hidden="true">â˜°</span>
        <span class="menu-text">MenÃº</span>
      </button>
      
      <ul id="menu-principal" class="menu-principal" role="menubar">
        <!-- SecciÃ³n: NavegaciÃ³n Principal -->
        <li class="menu-section" role="none">
          <span class="menu-section-title" aria-hidden="true">NavegaciÃ³n</span>
          <ul class="menu-items" role="group" aria-label="NavegaciÃ³n principal">
            <li role="none">
              <a href="#inicio" class="menu-item active" role="menuitem" aria-current="page">
                <span class="menu-icon" aria-hidden="true">ğŸ </span>
                <span class="menu-text">Inicio</span>
              </a>
            </li>
            <li role="none">
              <a href="#rutas" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸ›£ï¸</span>
                <span class="menu-text">Rutas</span>
              </a>
            </li>
            <li role="none">
              <a href="#alojamientos" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸ¨</span>
                <span class="menu-text">Alojamientos</span>
              </a>
            </li>
            <li role="none">
              <a href="#accesibilidad" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸš¶â€â™‚ï¸</span>
                <span class="menu-text">Accesibilidad</span>
              </a>
            </li>
            <li role="none">
              <a href="#contacto" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸ“</span>
                <span class="menu-text">Contacto</span>
              </a>
            </li>
            <li role="none" class="menu-item-user">
              <button class="menu-item btn-login" onclick="mostrarModal('modal-login')" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸ‘¤</span>
                <span class="menu-text">Iniciar SesiÃ³n</span>
              </button>
            </li>
            <li role="none" class="menu-item-user">
              <button class="menu-item btn-register" onclick="mostrarModal('modal-auth')" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸ“</span>
                <span class="menu-text">Registrarse</span>
              </button>
            </li>
          </ul>
        </li>

        <!-- SecciÃ³n: Servicios -->
        <li class="menu-section" role="none">
          <span class="menu-section-title" aria-hidden="true">Servicios</span>
          <ul class="menu-items" role="group" aria-label="Servicios turÃ­sticos">
            <li role="none">
              <a href="#multimedia" class="menu-item" role="menuitem">
                <span class="menu-icon" aria-hidden="true">ğŸ¥</span>
                <span class="menu-text">Multimedia</span>
              </a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Accesos rÃ¡pidos -->
    <div class="quick-access" role="complementary" aria-label="Accesos rÃ¡pidos">
      <button class="quick-btn" onclick="scrollToSection('destinos')" aria-label="Ir a destinos destacados">
        <span class="quick-icon" aria-hidden="true">â­</span>
        <span class="quick-text">Destinos</span>
      </button>
      <button class="quick-btn" onclick="scrollToSection('multimedia')" aria-label="Ir a contenido multimedia">
        <span class="quick-icon" aria-hidden="true">ğŸ¬</span>
        <span class="quick-text">Videos</span>
      </button>
      <button class="quick-btn" onclick="mostrarModal('modal-login')" aria-label="Acceso rÃ¡pido a inicio de sesiÃ³n">
        <span class="quick-icon" aria-hidden="true">ğŸ”‘</span>
        <span class="quick-text">Acceder</span>
      </button>
    </div>
  </header>

  <main id="main-content" role="main">
    <!-- Breadcrumbs -->
    <nav id="breadcrumbs" class="breadcrumbs" aria-label="NavegaciÃ³n de migas de pan">
      <a href="#inicio">Inicio</a>
    </nav>
    
    <section class="banner-rotativo" aria-label="ImÃ¡genes de destinos turÃ­sticos de Ecuador">
      <img src="img/banner1.jpg" class="active" alt="Vista panorÃ¡mica de Cuenca, ciudad patrimonio de la humanidad" />
      <img src="img/banner2.jpg" alt="Playa de Salinas con aguas cristalinas del PacÃ­fico" />
      <img src="img/banner3.jpg" alt="Paisaje montaÃ±oso de los Andes ecuatorianos" />
    </section>

    <section aria-labelledby="mapa-titulo">
      <h2 id="mapa-titulo" style="text-align:center; margin-top: 2rem;">Mapa de Rutas TurÃ­sticas</h2>
      <div id="map" style="height: 400px; margin: 20px auto; width: 90%; max-width: 1000px;" 
           role="application" aria-label="Mapa interactivo de destinos turÃ­sticos de Ecuador"></div>
    </section>

    <!-- SecciÃ³n de destinos destacados -->
    <section class="destinos-destacados" aria-labelledby="destinos-titulo">
      <h2 id="destinos-titulo">Destinos Destacados</h2>
      <div class="destinos-grid">
        <article class="destino-card">
          <img src="img/cuenca.jpg" alt="Centro histÃ³rico de Cuenca" />
          <h3>Cuenca</h3>
          <p>Ciudad patrimonio de la humanidad con arquitectura colonial y artesanÃ­as tradicionales.</p>
          <button class="btn-destino" aria-label="Ver mÃ¡s informaciÃ³n sobre Cuenca">Ver mÃ¡s</button>
        </article>
        <article class="destino-card">
          <img src="img/salinas.jpg" alt="Playa de Salinas" />
          <h3>Salinas</h3>
          <p>Hermosa playa del PacÃ­fico con excelente infraestructura turÃ­stica y accesibilidad.</p>
          <button class="btn-destino" aria-label="Ver mÃ¡s informaciÃ³n sobre Salinas">Ver mÃ¡s</button>
        </article>
        <article class="destino-card">
          <img src="img/manta.jpg" alt="Ciudad de Manta" />
          <h3>Manta</h3>
          <p>Puerto pesquero con hermosas playas y deliciosa gastronomÃ­a marina.</p>
          <button class="btn-destino" aria-label="Ver mÃ¡s informaciÃ³n sobre Manta">Ver mÃ¡s</button>
        </article>
      </div>
    </section>

    <!-- SecciÃ³n de contenido multimedia accesible -->
    <section class="multimedia-accesible" aria-labelledby="multimedia-titulo">
      <h2 id="multimedia-titulo">Contenido Multimedia Accesible</h2>
      
      <!-- Video con subtÃ­tulos -->
      <div class="video-container" aria-labelledby="video-titulo">
        <h3 id="video-titulo">Video Promocional de Ecuador</h3>
        <div class="video-wrapper">
          <video id="video-ecuador" controls preload="metadata" aria-describedby="video-descripcion">
            <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
            <track kind="subtitles" src="subtitulos-ecuador.vtt" srclang="es" label="EspaÃ±ol" default>
            <track kind="subtitles" src="subtitulos-ecuador-en.vtt" srclang="en" label="English">
            Tu navegador no soporta el elemento de video.
          </video>
          <div id="subtitulos-custom" class="subtitulos-custom oculto" aria-live="polite"></div>
        </div>
        <p id="video-descripcion" class="video-descripcion">
          Video promocional que muestra los paisajes mÃ¡s hermosos de Ecuador, incluyendo la costa, sierra y AmazonÃ­a.
        </p>
        <div class="video-controls">
          <button onclick="toggleSubtitulos()" class="btn-control" aria-label="Activar o desactivar subtÃ­tulos">
            <span aria-hidden="true">ğŸ“º</span> SubtÃ­tulos
          </button>
          <button onclick="toggleTranscripcion()" class="btn-control" aria-label="Mostrar transcripciÃ³n">
            <span aria-hidden="true">ğŸ“„</span> TranscripciÃ³n
          </button>
          <button onclick="descargarVideoTranscripcion()" class="btn-control" aria-label="Descargar transcripciÃ³n del video">
            <span aria-hidden="true">ğŸ’¾</span> Descargar
          </button>
        </div>
      </div>

      <!-- Audio con controles -->
      <div class="audio-container" aria-labelledby="audio-titulo">
        <h3 id="audio-titulo">Audio GuÃ­a TurÃ­stica</h3>
        <div class="audio-wrapper">
          <audio id="audio-guia" controls preload="metadata" aria-describedby="audio-descripcion">
            <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
            Tu navegador no soporta el elemento de audio.
          </audio>
        </div>
        <p id="audio-descripcion" class="audio-descripcion">
          Audio guÃ­a que describe los principales atractivos turÃ­sticos de Ecuador.
        </p>
        <div class="audio-controls">
          <button onclick="toggleMute()" class="btn-control" aria-label="Silenciar o activar audio">
            <span aria-hidden="true">ğŸ”‡</span> Silenciar
          </button>
          <button onclick="ajustarVolumen(0.5)" class="btn-control" aria-label="Ajustar volumen al 50%">
            <span aria-hidden="true">ğŸ”Š</span> Volumen 50%
          </button>
          <button onclick="ajustarVolumen(1.0)" class="btn-control" aria-label="Ajustar volumen al 100%">
            <span aria-hidden="true">ğŸ”Š</span> Volumen 100%
          </button>
          <button onclick="descargarAudioTranscripcion()" class="btn-control" aria-label="Descargar transcripciÃ³n del audio">
            <span aria-hidden="true">ğŸ’¾</span> Descargar
          </button>
        </div>
      </div>

      <!-- TranscripciÃ³n en tiempo real -->
      <div id="transcripcion-container" class="transcripcion-container oculto" aria-labelledby="transcripcion-titulo">
        <h3 id="transcripcion-titulo">TranscripciÃ³n en Tiempo Real</h3>
        <div id="transcripcion-texto" class="transcripcion-texto" role="log" aria-live="polite">
          <p>La transcripciÃ³n aparecerÃ¡ aquÃ­ cuando se active...</p>
        </div>
        <div class="transcripcion-controls">
          <button onclick="iniciarTranscripcion()" class="btn-control" aria-label="Iniciar transcripciÃ³n en tiempo real">
            <span aria-hidden="true">ğŸ¤</span> Iniciar
          </button>
          <button onclick="detenerTranscripcion()" class="btn-control" aria-label="Detener transcripciÃ³n en tiempo real">
            <span aria-hidden="true">â¹ï¸</span> Detener
          </button>
          <button onclick="limpiarTranscripcion()" class="btn-control" aria-label="Limpiar transcripciÃ³n">
            <span aria-hidden="true">ğŸ—‘ï¸</span> Limpiar
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de Registro de Usuario Mejorado -->
  <div id="modal-auth" class="modal oculto" role="dialog" aria-labelledby="modal-registro-titulo" aria-hidden="true">
    <div class="modal-content registro-modal">
      <span class="cerrar" onclick="cerrarModal('modal-auth')" aria-label="Cerrar ventana de registro">&times;</span>
      
      <div class="registro-header">
        <div class="registro-icon" aria-hidden="true">ğŸ“</div>
        <h2 id="modal-registro-titulo">Crear Cuenta</h2>
        <p class="registro-subtitle">Ãšnete al Portal TurÃ­stico Ecuador</p>
      </div>
      
      <form id="form-registro" role="form" aria-describedby="registro-descripcion" novalidate>
        <p id="registro-descripcion" class="sr-only">Formulario completo para crear una nueva cuenta de usuario en el portal turÃ­stico</p>
        
        <!-- SecciÃ³n: Datos Personales -->
        <div class="form-section" aria-labelledby="datos-personales-titulo">
          <h3 id="datos-personales-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ‘¤</span>
            Datos Personales
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ“›</span>
                Nombre Completo
              </label>
              <input 
                type="text" 
                id="nombre" 
                name="nombre" 
                placeholder="Ingresa tu nombre completo" 
                required 
                autocomplete="given-name"
                aria-describedby="nombre-error nombre-help"
                class="form-input"
                minlength="2"
                maxlength="50"
              />
              <div id="nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="nombre-help" class="help-text">Ingresa tu nombre y apellidos</div>
            </div>
            
            <div class="form-group">
              <label for="cedula" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ†”</span>
                CÃ©dula de Identidad
              </label>
              <input 
                type="text" 
                id="cedula" 
                name="cedula" 
                placeholder="Ej: 1234567890" 
                required 
                autocomplete="off"
                aria-describedby="cedula-error cedula-help"
                class="form-input"
                pattern="[0-9]{10}"
                maxlength="10"
              />
              <div id="cedula-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="cedula-help" class="help-text">Ingresa tu nÃºmero de cÃ©dula (10 dÃ­gitos)</div>
            </div>
          </div>
        </div>
        
        <!-- SecciÃ³n: InformaciÃ³n de Contacto -->
        <div class="form-section" aria-labelledby="contacto-titulo">
          <h3 id="contacto-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“§</span>
            InformaciÃ³n de Contacto
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="email" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ“§</span>
                Correo ElectrÃ³nico
              </label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                placeholder="tu@email.com" 
                required 
                autocomplete="email"
                aria-describedby="email-error email-help"
                class="form-input"
              />
              <div id="email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="email-help" class="help-text">Ingresa un correo vÃ¡lido para confirmar tu cuenta</div>
            </div>
            
            <div class="form-group">
              <label for="telefono" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“±</span>
                TelÃ©fono (Opcional)
              </label>
              <input 
                type="tel" 
                id="telefono" 
                name="telefono" 
                placeholder="Ej: 0991234567" 
                autocomplete="tel"
                aria-describedby="telefono-error telefono-help"
                class="form-input"
                pattern="[0-9]{10}"
                maxlength="10"
              />
              <div id="telefono-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="telefono-help" class="help-text">Ingresa tu nÃºmero de telÃ©fono mÃ³vil</div>
            </div>
          </div>
        </div>
        
        <!-- SecciÃ³n: Credenciales de Acceso -->
        <div class="form-section" aria-labelledby="credenciales-titulo">
          <h3 id="credenciales-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ”</span>
            Credenciales de Acceso
          </h3>
          
          <div class="form-group">
            <label for="usuario" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ‘¤</span>
              Nombre de Usuario
            </label>
            <div class="input-wrapper">
              <input 
                type="text" 
                id="usuario" 
                name="usuario" 
                placeholder="Elige un nombre de usuario Ãºnico" 
                required 
                autocomplete="username"
                aria-describedby="usuario-error usuario-help"
                class="form-input"
                minlength="3"
                maxlength="20"
                pattern="[a-zA-Z0-9_]+"
              />
              <div class="input-status" aria-hidden="true"></div>
            </div>
            <div id="usuario-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="usuario-help" class="help-text">MÃ­nimo 3 caracteres, solo letras, nÃºmeros y guiones bajos</div>
          </div>
          
          <div class="form-group">
            <label for="clave" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ”’</span>
              ContraseÃ±a
            </label>
            <div class="input-wrapper">
              <input 
                type="password" 
                id="clave" 
                name="clave" 
                placeholder="Crea una contraseÃ±a segura" 
                required 
                autocomplete="new-password"
                aria-describedby="clave-error clave-help password-strength"
                class="form-input"
                minlength="8"
              />
              <button 
                type="button" 
                class="password-toggle" 
                onclick="togglePasswordVisibility('clave')"
                aria-label="Mostrar contraseÃ±a"
                aria-pressed="false"
              >
                <span class="toggle-icon" aria-hidden="true">ğŸ‘ï¸</span>
              </button>
              <div class="input-status" aria-hidden="true"></div>
            </div>
            <div id="clave-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="clave-help" class="help-text">MÃ­nimo 8 caracteres, incluye mayÃºsculas, minÃºsculas y nÃºmeros</div>
            
            <!-- Barra de fortaleza de contraseÃ±a -->
            <div class="password-strength-container">
              <div class="strength-bar">
                <div id="password-strength-bar" class="strength-fill"></div>
              </div>
              <span id="password-strength-text" class="strength-text">Fortaleza de la contraseÃ±a</span>
            </div>
          </div>
          
          <div class="form-group">
            <label for="confirmar-clave" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ”</span>
              Confirmar ContraseÃ±a
            </label>
            <div class="input-wrapper">
              <input 
                type="password" 
                id="confirmar-clave" 
                name="confirmar-clave" 
                placeholder="Repite tu contraseÃ±a" 
                required 
                autocomplete="new-password"
                aria-describedby="confirmar-clave-error confirmar-clave-help"
                class="form-input"
              />
              <div class="input-status" aria-hidden="true"></div>
            </div>
            <div id="confirmar-clave-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="confirmar-clave-help" class="help-text">Repite exactamente la misma contraseÃ±a</div>
          </div>
        </div>
        
        <!-- SecciÃ³n: TÃ©rminos y Condiciones -->
        <div class="form-section" aria-labelledby="terminos-titulo">
          <h3 id="terminos-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“‹</span>
            TÃ©rminos y Condiciones
          </h3>
          
          <div class="form-options">
            <label class="checkbox-wrapper required">
              <input 
                type="checkbox" 
                id="aceptar-terminos" 
                name="aceptar-terminos"
                required
                aria-describedby="terminos-help"
              />
              <span class="checkmark"></span>
              <span class="checkbox-text">
                Acepto los <a href="#terminos-uso" class="link-inline">TÃ©rminos de Uso</a> y la 
                <a href="#politica-privacidad" class="link-inline">PolÃ­tica de Privacidad</a>
              </span>
            </label>
            <div id="terminos-help" class="help-text">Debes aceptar los tÃ©rminos para continuar</div>
          </div>
          
          <div class="form-options">
            <label class="checkbox-wrapper">
              <input 
                type="checkbox" 
                id="recibir-notificaciones" 
                name="recibir-notificaciones"
                aria-describedby="notificaciones-help"
              />
              <span class="checkmark"></span>
              <span class="checkbox-text">Deseo recibir notificaciones sobre ofertas turÃ­sticas</span>
            </label>
            <div id="notificaciones-help" class="help-text">Puedes cambiar esta opciÃ³n despuÃ©s</div>
          </div>
        </div>
        
        <!-- Botones de acciÃ³n -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-registro-submit"
            aria-label="Crear cuenta de usuario"
            id="registro-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">âœ…</span>
            <span class="btn-text">Crear Cuenta</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-registro-cancel"
            onclick="cerrarModal('modal-auth')"
            aria-label="Cancelar registro"
          >
            <span class="btn-icon" aria-hidden="true">âŒ</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="registro-status" class="registro-status" role="status" aria-live="polite"></div>
      </form>
      
      <!-- Enlaces adicionales -->
      <div class="registro-footer">
        <p class="registro-links">
          <a href="#" onclick="cerrarModal('modal-auth'); mostrarModal('modal-login')" class="link-secondary">
            Â¿Ya tienes cuenta? Inicia sesiÃ³n aquÃ­
          </a>
        </p>
      </div>
    </div>
  </div>

  <!-- Modal de Registro de Administrador (solo visible para admins) -->
  <div id="modal-admin" class="modal oculto" role="dialog" aria-labelledby="modal-admin-titulo" aria-hidden="true">
    <div class="modal-content">
      <span class="cerrar" onclick="cerrarModal('modal-admin')" aria-label="Cerrar ventana de registro de admin">&times;</span>
      <h2 id="modal-admin-titulo">Registrar Administrador</h2>
      <form id="form-registro-admin" role="form" aria-describedby="admin-descripcion">
        <p id="admin-descripcion" class="sr-only">Formulario para crear una nueva cuenta de administrador</p>
        <div class="form-group">
          <label for="admin-usuario">Usuario:</label>
          <input type="text" id="admin-usuario" name="usuario" placeholder="Nombre de usuario" required />
        </div>
        <div class="form-group">
          <label for="admin-clave">ContraseÃ±a:</label>
          <input type="password" id="admin-clave" name="clave" placeholder="ContraseÃ±a" required />
        </div>
        <div class="form-group">
          <label for="admin-email">Email:</label>
          <input type="email" id="admin-email" name="email" placeholder="Correo electrÃ³nico" required />
        </div>
        <button type="submit" aria-label="Registrar administrador">Registrar Admin</button>
      </form>
    </div>
  </div>

  <!-- Modal de Login Mejorado -->
  <div id="modal-login" class="modal oculto" role="dialog" aria-labelledby="modal-login-titulo" aria-hidden="true">
    <div class="modal-content login-modal">
      <span class="cerrar" onclick="cerrarModal('modal-login')" aria-label="Cerrar ventana de inicio de sesiÃ³n">&times;</span>
      
      <div class="login-header">
        <div class="login-icon" aria-hidden="true">ğŸ”</div>
        <h2 id="modal-login-titulo">Iniciar SesiÃ³n</h2>
        <p class="login-subtitle">Accede a tu cuenta del Portal TurÃ­stico Ecuador</p>
      </div>
      
      <form id="form-login" role="form" aria-describedby="login-descripcion" novalidate>
        <p id="login-descripcion" class="sr-only">Formulario para iniciar sesiÃ³n en el portal turÃ­stico de Ecuador</p>
        
        <!-- Campo Usuario -->
        <div class="form-group">
          <label for="login-usuario" class="form-label">
            <span class="label-icon" aria-hidden="true">ğŸ‘¤</span>
            Nombre de Usuario
          </label>
          <div class="input-wrapper">
            <input 
              type="text" 
              id="login-usuario" 
              name="usuario" 
              placeholder="Ingresa tu nombre de usuario" 
              required 
              autocomplete="username"
              aria-describedby="login-usuario-error login-usuario-help"
              class="form-input"
              autofocus
            />
            <div class="input-status" aria-hidden="true"></div>
          </div>
          <div id="login-usuario-error" class="error-message" role="alert" aria-live="polite"></div>
          <div id="login-usuario-help" class="help-text">Ingresa el nombre de usuario que registraste</div>
        </div>
        
        <!-- Campo ContraseÃ±a -->
        <div class="form-group">
          <label for="login-clave" class="form-label">
            <span class="label-icon" aria-hidden="true">ğŸ”’</span>
            ContraseÃ±a
          </label>
          <div class="input-wrapper">
            <input 
              type="password" 
              id="login-clave" 
              name="clave" 
              placeholder="Ingresa tu contraseÃ±a" 
              required 
              autocomplete="current-password"
              aria-describedby="login-clave-error login-clave-help"
              class="form-input"
            />
            <button 
              type="button" 
              class="password-toggle" 
              onclick="togglePasswordVisibility('login-clave')"
              aria-label="Mostrar contraseÃ±a"
              aria-pressed="false"
            >
              <span class="toggle-icon" aria-hidden="true">ğŸ‘ï¸</span>
            </button>
            <div class="input-status" aria-hidden="true"></div>
          </div>
          <div id="login-clave-error" class="error-message" role="alert" aria-live="polite"></div>
          <div id="login-clave-help" class="help-text">Ingresa la contraseÃ±a de tu cuenta</div>
        </div>
        
        <!-- Opciones adicionales -->
        <div class="form-options">
          <label class="checkbox-wrapper">
            <input 
              type="checkbox" 
              id="remember-user" 
              name="remember"
              aria-describedby="remember-help"
            />
            <span class="checkmark"></span>
            <span class="checkbox-text">Recordar mi usuario</span>
          </label>
          <div id="remember-help" class="sr-only">Marcar esta opciÃ³n para recordar tu nombre de usuario</div>
        </div>
        
        <!-- CAPTCHA para prevenir intentos mÃºltiples -->
        <div class="captcha-container" id="captcha-container" style="display: none;">
          <div class="captcha-challenge">
            <span class="captcha-text" id="captcha-text">Â¿CuÃ¡l es la capital de Ecuador?</span>
            <input 
              type="text" 
              id="captcha-answer" 
              placeholder="Respuesta"
              class="form-input captcha-input"
              aria-describedby="captcha-help"
            />
            <div id="captcha-help" class="help-text">Responde la pregunta para verificar que eres humano</div>
          </div>
        </div>
        
        <!-- BotÃ³n de envÃ­o -->
        <button 
          type="submit" 
          class="btn-login-submit"
          aria-label="Iniciar sesiÃ³n en el portal"
          id="login-submit-btn"
        >
          <span class="btn-icon" aria-hidden="true">ğŸš€</span>
          <span class="btn-text">Iniciar SesiÃ³n</span>
          <div class="btn-loading" aria-hidden="true"></div>
        </button>
        
        <!-- Mensaje de estado -->
        <div id="login-status" class="login-status" role="status" aria-live="polite"></div>
      </form>
      
      <!-- Enlaces adicionales -->
      <div class="login-footer">
        <p class="login-links">
          <a href="#" onclick="cerrarModal('modal-login'); mostrarModal('modal-auth')" class="link-secondary">
            Â¿No tienes cuenta? RegÃ­strate aquÃ­
          </a>
        </p>
        <p class="login-links">
          <a href="#" onclick="mostrarRecuperarPassword()" class="link-secondary">
            Â¿Olvidaste tu contraseÃ±a?
          </a>
        </p>
      </div>
    </div>
  </div>

  <footer role="contentinfo">
    <div class="footer-content">
      <p>&copy; 2024 Portal TurÃ­stico Ecuador. Todos los derechos reservados.</p>
      <nav aria-label="Enlaces de pie de pÃ¡gina">
        <a href="#politica-privacidad">PolÃ­tica de Privacidad</a> |
        <a href="#terminos-uso">TÃ©rminos de Uso</a> |
        <a href="#" onclick="abrirModal('modal-guardar-registro')">Guardar Destino</a> |
        <a href="#" onclick="abrirModalEditar(1)">Editar Destino</a> |
        <a href="#" onclick="abrirModalBusqueda()">BÃºsqueda Avanzada</a> |
        <a href="#" onclick="abrirModalEliminar(1)">Eliminar Destino</a> |
        <a href="#" onclick="mostrarModalContacto()">Contacto</a>
      </nav>
    </div>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // ConfiguraciÃ³n global
    const API_BASE_URL = 'http://192.168.18.27:5000';
    let currentUser = null;
    let speechSynthesis = window.speechSynthesis;

    // Utilidades de accesibilidad
    function announceToScreenReader(message) {
      const announcement = document.createElement('div');
      announcement.setAttribute('aria-live', 'polite');
      announcement.setAttribute('aria-atomic', 'true');
      announcement.className = 'sr-only';
      announcement.textContent = message;
      document.body.appendChild(announcement);
      setTimeout(() => document.body.removeChild(announcement), 1000);
    }

    function updateAccessibilityStatus() {
      const statusElement = document.getElementById('accessibility-status');
      const statusText = document.getElementById('status-text');
      const activeFeatures = [];
      
      if (document.body.classList.contains('alto-contraste')) activeFeatures.push('Alto contraste');
      if (document.body.classList.contains('monocromatico')) activeFeatures.push('MonocromÃ¡tico');
      if (document.body.classList.contains('texto-grande')) activeFeatures.push('Texto grande');
      if (document.body.classList.contains('texto-pequeno')) activeFeatures.push('Texto pequeÃ±o');
      if (document.body.classList.contains('espaciado-ajustado')) activeFeatures.push('Espaciado ajustado');
      if (document.body.classList.contains('fuente-legible')) activeFeatures.push('Fuente legible');
      if (document.body.classList.contains('zoom-pagina')) activeFeatures.push('Zoom');
      if (document.body.classList.contains('resaltar-enlaces')) activeFeatures.push('Enlaces resaltados');
      if (document.body.classList.contains('pausar-animaciones')) activeFeatures.push('Animaciones pausadas');
      if (document.body.classList.contains('descripcion-audio')) activeFeatures.push('DescripciÃ³n de audio');
      if (subtitulosActivos) activeFeatures.push('SubtÃ­tulos');
      if (alertasVisualesActivas) activeFeatures.push('Alertas visuales');
      
      if (activeFeatures.length > 0) {
        statusText.textContent = `Accesibilidad: ${activeFeatures.join(', ')}`;
        statusElement.classList.add('active');
        setTimeout(() => statusElement.classList.remove('active'), 3000);
      } else {
        statusText.textContent = 'Accesibilidad: Normal';
        statusElement.classList.remove('active');
      }
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.setAttribute('role', 'alert');
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.classList.add('fade-out');
        setTimeout(() => document.body.removeChild(notification), 300);
      }, 3000);
    }

    // ValidaciÃ³n de formularios
    function validateForm(formData) {
      const errors = {};
      
      if (!formData.usuario || formData.usuario.trim().length < 3) {
        errors.usuario = 'El usuario debe tener al menos 3 caracteres';
      }
      
      if (!formData.clave || formData.clave.length < 6) {
        errors.clave = 'La contraseÃ±a debe tener al menos 6 caracteres';
      }
      
      return errors;
    }

    function displayFormErrors(errors) {
      Object.keys(errors).forEach(field => {
        const errorElement = document.getElementById(`${field}-error`);
        if (errorElement) {
          errorElement.textContent = errors[field];
          errorElement.style.display = 'block';
        }
      });
    }

    function clearFormErrors() {
      const errorElements = document.querySelectorAll('.error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    // Mapa interactivo mejorado
    function initializeMap() {
      const map = L.map('map').setView([-1.8312, -78.1834], 6);
      
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
      }).addTo(map);

      const destinations = [
        { 
          lat: -2.9006, 
          lng: -79.0045, 
          name: "Cuenca",
          description: "Ciudad patrimonio de la humanidad",
          accessibility: "Accesible para sillas de ruedas"
        },
        { 
          lat: -0.9683, 
          lng: -80.7128, 
          name: "Salinas",
          description: "Playa del PacÃ­fico",
          accessibility: "Rampas de acceso disponibles"
        },
        { 
          lat: -0.9462, 
          lng: -80.7214, 
          name: "Manta",
          description: "Puerto pesquero",
          accessibility: "Transporte adaptado disponible"
        },
        { 
          lat: -1.2547, 
          lng: -78.6229, 
          name: "BaÃ±os",
          description: "Aventura en los Andes",
          accessibility: "GuÃ­as especializados en accesibilidad"
        }
      ];

      destinations.forEach(dest => {
        const marker = L.marker([dest.lat, dest.lng]).addTo(map);
        const popupContent = `
          <div class="map-popup">
            <h3>${dest.name}</h3>
            <p>${dest.description}</p>
            <p><strong>Accesibilidad:</strong> ${dest.accessibility}</p>
            <button onclick="showDestinationDetails('${dest.name}')" class="btn-destino">
              Ver mÃ¡s informaciÃ³n
            </button>
          </div>
        `;
        marker.bindPopup(popupContent);
      });

      return map;
    }

    // Banner rotativo mejorado
    function initializeBanner() {
      const banners = document.querySelectorAll('.banner-rotativo img');
      let bannerIndex = 0;
      
      function rotateBanner() {
        banners.forEach((img, i) => {
          img.classList.toggle('active', i === bannerIndex);
          img.setAttribute('aria-hidden', i !== bannerIndex);
        });
        bannerIndex = (bannerIndex + 1) % banners.length;
      }
      
      // Controles de banner para accesibilidad
      const bannerControls = document.createElement('div');
      bannerControls.className = 'banner-controls';
      bannerControls.innerHTML = `
        <button onclick="previousBanner()" aria-label="Imagen anterior">â€¹</button>
        <span class="banner-counter">1 de ${banners.length}</span>
        <button onclick="nextBanner()" aria-label="Siguiente imagen">â€º</button>
      `;
      document.querySelector('.banner-rotativo').appendChild(bannerControls);
      
      setInterval(rotateBanner, 5000);
    }

    function previousBanner() {
      const banners = document.querySelectorAll('.banner-rotativo img');
      const currentIndex = Array.from(banners).findIndex(img => img.classList.contains('active'));
      const newIndex = currentIndex > 0 ? currentIndex - 1 : banners.length - 1;
      
      banners.forEach((img, i) => {
        img.classList.toggle('active', i === newIndex);
        img.setAttribute('aria-hidden', i !== newIndex);
      });
      
      updateBannerCounter(newIndex + 1);
    }

    function nextBanner() {
      const banners = document.querySelectorAll('.banner-rotativo img');
      const currentIndex = Array.from(banners).findIndex(img => img.classList.contains('active'));
      const newIndex = (currentIndex + 1) % banners.length;
      
      banners.forEach((img, i) => {
        img.classList.toggle('active', i === newIndex);
        img.setAttribute('aria-hidden', i !== newIndex);
      });
      
      updateBannerCounter(newIndex + 1);
    }

    function updateBannerCounter(current) {
      const counter = document.querySelector('.banner-counter');
      if (counter) {
        counter.textContent = `${current} de ${document.querySelectorAll('.banner-rotativo img').length}`;
      }
    }

    // Modales mejorados
    function showModal(id) {
      const modal = document.getElementById(id);
      modal.classList.remove('oculto');
      modal.setAttribute('aria-hidden', 'false');
      
      // Enfoque en el primer elemento interactivo
      const firstFocusable = modal.querySelector('input, button, select');
      if (firstFocusable) {
        firstFocusable.focus();
      }
      
      // Cerrar con Escape
      document.addEventListener('keydown', handleEscapeKey);
      
      announceToScreenReader(`Ventana ${id === 'modal-login' ? 'de inicio de sesiÃ³n' : 'de registro'} abierta`);
    }

    function closeModal(id) {
      const modal = document.getElementById(id);
      modal.classList.add('oculto');
      modal.setAttribute('aria-hidden', 'true');
      
      document.removeEventListener('keydown', handleEscapeKey);
      clearFormErrors();
      
      announceToScreenReader('Ventana cerrada');
    }

    function handleEscapeKey(event) {
      if (event.key === 'Escape') {
        const openModal = document.querySelector('.modal:not(.oculto)');
        if (openModal) {
          closeModal(openModal.id);
        }
      }
    }

    // Registro mejorado
    document.getElementById("form-registro").addEventListener("submit", async (e) => {
      e.preventDefault();
      clearFormErrors();
      
      const formData = {
        usuario: document.getElementById("usuario").value.trim(),
        clave: document.getElementById("clave").value,
        rol: document.getElementById("rol").value
      };
      
      const errors = validateForm(formData);
      if (Object.keys(errors).length > 0) {
        displayFormErrors(errors);
        announceToScreenReader('Hay errores en el formulario. Por favor, revÃ­selos.');
        return;
      }
      
      try {
        showNotification('Registrando usuario...', 'info');
        
        const response = await fetch(`${API_BASE_URL}/registro`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          showNotification(data.mensaje, 'success');
          announceToScreenReader('Usuario registrado exitosamente');
          closeModal('modal-auth');
        } else {
          showNotification(data.mensaje, 'error');
          announceToScreenReader('Error al registrar usuario');
        }
      } catch (error) {
        showNotification("Error de conexiÃ³n. Intente nuevamente.", 'error');
        announceToScreenReader('Error de conexiÃ³n');
      }
    });

    // Login mejorado
    document.getElementById("form-login").addEventListener("submit", async (e) => {
      e.preventDefault();
      clearFormErrors();
      
      const formData = {
        usuario: document.getElementById("login-usuario").value.trim(),
        clave: document.getElementById("login-clave").value
      };
      
      const errors = validateForm(formData);
      if (Object.keys(errors).length > 0) {
        displayFormErrors(errors);
        announceToScreenReader('Hay errores en el formulario. Por favor, revÃ­selos.');
        return;
      }
      
      try {
        showNotification('Iniciando sesiÃ³n...', 'info');
        
        const response = await fetch(`${API_BASE_URL}/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          currentUser = { usuario: formData.usuario, rol: data.rol };
          showNotification(data.mensaje, 'success');
          announceToScreenReader(`Bienvenido ${formData.usuario}`);
          closeModal('modal-login');
          
          if (data.rol === 'admin') {
            showAdminPanel();
          }
        } else {
          showNotification(data.mensaje, 'error');
          announceToScreenReader('Credenciales incorrectas');
        }
      } catch (error) {
        showNotification("Error de conexiÃ³n. Intente nuevamente.", 'error');
        announceToScreenReader('Error de conexiÃ³n');
      }
    });

    // Panel de administraciÃ³n mejorado
    function showAdminPanel() {
      if (document.getElementById('panel-admin')) return;
      
      const panel = document.createElement('div');
      panel.id = 'panel-admin';
      panel.className = 'admin-panel';
      panel.innerHTML = `
        <div class="admin-header">
          <h2>Panel de Administrador</h2>
          <button onclick="closeAdminPanel()" aria-label="Cerrar panel de administrador">Ã—</button>
        </div>
        <div class="admin-content">
          <h3>Usuarios Registrados</h3>
          <div id="users-list" class="users-list">
            <p>Cargando usuarios...</p>
          </div>
        </div>
      `;
      
      document.body.appendChild(panel);
      loadUsers();
      announceToScreenReader('Panel de administrador abierto');
    }

    function closeAdminPanel() {
      const panel = document.getElementById('panel-admin');
      if (panel) {
        document.body.removeChild(panel);
        announceToScreenReader('Panel de administrador cerrado');
      }
    }

    async function loadUsers() {
      try {
        const response = await fetch(`${API_BASE_URL}/admin/usuarios`);
        const users = await response.json();
        
        const usersList = document.getElementById('users-list');
        if (users.length > 0) {
          usersList.innerHTML = users.map(user => `
            <div class="user-item">
              <span class="user-name">${user.usuario}</span>
              <span class="user-id">ID: ${user.id}</span>
            </div>
          `).join('');
        } else {
          usersList.innerHTML = '<p>No hay usuarios registrados</p>';
        }
      } catch (error) {
        document.getElementById('users-list').innerHTML = '<p>Error al cargar usuarios</p>';
      }
    }

    // Funciones de accesibilidad mejoradas
    function toggleAccMenu() {
      const menu = document.getElementById('accesibilidad-lista');
      const button = document.querySelector('.menu-toggle');
      const isExpanded = menu.classList.contains('oculto');
      
      menu.classList.toggle('oculto');
      button.setAttribute('aria-expanded', !isExpanded);
      
      announceToScreenReader(`MenÃº de accesibilidad ${isExpanded ? 'abierto' : 'cerrado'}`);
    }

    function activateHighContrast() {
      document.body.classList.toggle('alto-contraste');
      const isActive = document.body.classList.contains('alto-contraste');
      announceToScreenReader(`Modo alto contraste ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function activateMonochromaticMode() {
      document.body.classList.toggle('monocromatico');
      const isActive = document.body.classList.contains('monocromatico');
      announceToScreenReader(`Modo monocromÃ¡tico ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function increaseTextSize() {
      document.body.classList.remove('texto-pequeno');
      document.body.classList.add('texto-grande');
      announceToScreenReader('TamaÃ±o de texto aumentado');
      updateAccessibilityStatus();
    }

    function decreaseTextSize() {
      document.body.classList.remove('texto-grande');
      document.body.classList.add('texto-pequeno');
      announceToScreenReader('TamaÃ±o de texto reducido');
      updateAccessibilityStatus();
    }

    function adjustSpacing() {
      document.body.classList.toggle('espaciado-ajustado');
      const isActive = document.body.classList.contains('espaciado-ajustado');
      announceToScreenReader(`Espaciado de texto ${isActive ? 'ajustado' : 'normalizado'}`);
      updateAccessibilityStatus();
    }

    function useReadableFont() {
      document.body.classList.toggle('fuente-legible');
      const isActive = document.body.classList.contains('fuente-legible');
      announceToScreenReader(`Fuente legible ${isActive ? 'activada' : 'desactivada'}`);
      updateAccessibilityStatus();
    }

    function activateZoom() {
      document.body.classList.toggle('zoom-pagina');
      const isActive = document.body.classList.contains('zoom-pagina');
      announceToScreenReader(`Zoom de pÃ¡gina ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function highlightLinks() {
      document.body.classList.toggle('resaltar-enlaces');
      const isActive = document.body.classList.contains('resaltar-enlaces');
      announceToScreenReader(`Enlaces resaltados ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function pauseAnimations() {
      document.body.classList.toggle('pausar-animaciones');
      const isActive = document.body.classList.contains('pausar-animaciones');
      announceToScreenReader(`Animaciones pausadas ${isActive ? 'activado' : 'desactivado'}`);
      updateAccessibilityStatus();
    }

    function readText() {
      if (speechSynthesis.speaking) {
        speechSynthesis.cancel();
        announceToScreenReader('Lectura detenida');
        return;
      }
      
      const textToRead = document.querySelector('main').innerText;
      const speech = new SpeechSynthesisUtterance(textToRead);
      speech.lang = "es-ES";
      speech.rate = 0.9;
      
      speech.onend = () => announceToScreenReader('Lectura completada');
      speech.onerror = () => announceToScreenReader('Error en la lectura');
      
      speechSynthesis.speak(speech);
      announceToScreenReader('Iniciando lectura del contenido');
    }

    function activateAudioDescription() {
      document.body.classList.toggle('descripcion-audio');
      const isActive = document.body.classList.contains('descripcion-audio');
      announceToScreenReader(`DescripciÃ³n de audio ${isActive ? 'activada' : 'desactivada'}`);
      updateAccessibilityStatus();
    }

    function resetAccessibility() {
      document.body.classList.remove('alto-contraste', 'texto-grande', 'texto-pequeno', 'fuente-legible', 'monocromatico', 'espaciado-ajustado', 'zoom-pagina', 'resaltar-enlaces', 'pausar-animaciones', 'descripcion-audio');
      
      // Resetear funcionalidades de accesibilidad auditiva
      subtitulosActivos = false;
      alertasVisualesActivas = false;
      
      // Detener reconocimiento de voz si estÃ¡ activo
      if (recognition && recognition.state !== 'inactive') {
        recognition.stop();
      }
      
      // Ocultar subtÃ­tulos personalizados
      const subtitulosDiv = document.getElementById('subtitulos-custom');
      if (subtitulosDiv) {
        subtitulosDiv.classList.add('oculto');
      }
      
      // Ocultar transcripciÃ³n
      const transcripcionContainer = document.getElementById('transcripcion-container');
      if (transcripcionContainer) {
        transcripcionContainer.classList.add('oculto');
      }
      
      // Remover indicador de alertas
      const alertIndicator = document.getElementById('alert-indicator');
      if (alertIndicator) {
        alertIndicator.remove();
      }
      
      if (speechSynthesis.speaking) {
        speechSynthesis.cancel();
      }
      
      announceToScreenReader('ConfiguraciÃ³n de accesibilidad restablecida');
      updateAccessibilityStatus();
    }

    // Funciones para accesibilidad auditiva
    let subtitulosActivos = false;
    let transcripcionActiva = false;
    let alertasVisualesActivas = false;
    let recognition = null;

    function activateSubtitles() {
      subtitulosActivos = !subtitulosActivos;
      const video = document.getElementById('video-ecuador');
      if (video) {
        const tracks = video.textTracks;
        for (let i = 0; i < tracks.length; i++) {
          tracks[i].mode = subtitulosActivos ? 'showing' : 'hidden';
        }
      }
      announceToScreenReader(`SubtÃ­tulos cerrados ${subtitulosActivos ? 'activados' : 'desactivados'}`);
      updateAccessibilityStatus();
    }

    function activateLiveSubtitles() {
      if (!recognition) {
        recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = 'es-ES';
        
        recognition.onresult = function(event) {
          const subtitulosDiv = document.getElementById('subtitulos-custom');
          let interimTranscript = '';
          let finalTranscript = '';
          
          for (let i = event.resultIndex; i < event.results.length; i++) {
            const transcript = event.results[i][0].transcript;
            if (event.results[i].isFinal) {
              finalTranscript += transcript;
            } else {
              interimTranscript += transcript;
            }
          }
          
          if (subtitulosDiv) {
            subtitulosDiv.innerHTML = `<span class="final">${finalTranscript}</span><span class="interim">${interimTranscript}</span>`;
          }
        };
      }
      
      if (recognition && recognition.state === 'inactive') {
        recognition.start();
        announceToScreenReader('SubtÃ­tulos en directo activados');
      } else if (recognition) {
        recognition.stop();
        announceToScreenReader('SubtÃ­tulos en directo desactivados');
      }
    }

    function downloadTranscription() {
      const transcription = `
TRANSCRIPCIÃ“N DEL CONTENIDO MULTIMEDIA
Portal TurÃ­stico Ecuador
Fecha: ${new Date().toLocaleDateString()}

VIDEO PROMOCIONAL DE ECUADOR:
"Bienvenidos a Ecuador, un paÃ­s lleno de diversidad y belleza natural. 
Desde las playas del PacÃ­fico hasta las cumbres de los Andes, 
Ecuador ofrece experiencias Ãºnicas para todos los viajeros.

En la costa, podrÃ¡s disfrutar de hermosas playas como Salinas y Manta, 
con aguas cÃ¡lidas y excelente gastronomÃ­a marina.

En la sierra, ciudades como Cuenca te transportarÃ¡n al pasado colonial, 
con su arquitectura histÃ³rica y artesanÃ­as tradicionales.

Y en la AmazonÃ­a, la selva mÃ¡s biodiversa del mundo te espera 
con sus rÃ­os, cascadas y comunidades indÃ­genas.

Ecuador, un paÃ­s pequeÃ±o pero gigante en experiencias."

AUDIO GUÃA TURÃSTICA:
"Esta guÃ­a te llevarÃ¡ por los principales destinos turÃ­sticos de Ecuador.
Cada regiÃ³n tiene su propio encanto y cultura Ãºnica.
Te invitamos a explorar y descubrir la magia de nuestro paÃ­s."

---
Generado automÃ¡ticamente por el Portal TurÃ­stico Ecuador
      `;
      
      const blob = new Blob([transcription], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'transcripcion-ecuador.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      announceToScreenReader('TranscripciÃ³n descargada exitosamente');
    }

    function showAudioControls() {
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `
        <div class="modal-content">
          <span class="cerrar" onclick="this.parentElement.parentElement.remove()">&times;</span>
          <h3>Controles de Audio</h3>
          <div class="audio-controls-panel">
            <div class="control-group">
              <label for="volume-slider">Volumen:</label>
              <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1" 
                     onchange="setVolume(this.value)" aria-label="Control de volumen">
              <span id="volume-display">100%</span>
            </div>
            <div class="control-group">
              <button onclick="muteAll()" class="btn-control">
                <span aria-hidden="true">ğŸ”‡</span> Silenciar todo
              </button>
              <button onclick="unmuteAll()" class="btn-control">
                <span aria-hidden="true">ğŸ”Š</span> Activar todo
              </button>
            </div>
            <div class="control-group">
              <label>
                <input type="checkbox" id="disable-autoplay" onchange="toggleAutoplay(this.checked)">
                Deshabilitar reproducciÃ³n automÃ¡tica
              </label>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      modal.classList.remove('oculto');
      announceToScreenReader('Panel de controles de audio abierto');
    }

    function activateVisualAlerts() {
      alertasVisualesActivas = !alertasVisualesActivas;
      document.body.classList.toggle('alertas-visuales', alertasVisualesActivas);
      
      if (alertasVisualesActivas) {
        // Crear indicador visual de alertas
        const alertIndicator = document.createElement('div');
        alertIndicator.id = 'alert-indicator';
        alertIndicator.className = 'alert-indicator';
        alertIndicator.innerHTML = `
          <div class="alert-light"></div>
          <span>Alertas visuales activas</span>
        `;
        document.body.appendChild(alertIndicator);
        
        // Simular alerta visual
        setTimeout(() => {
          showVisualAlert('Nueva notificaciÃ³n disponible');
        }, 2000);
      } else {
        const indicator = document.getElementById('alert-indicator');
        if (indicator) {
          indicator.remove();
        }
      }
      
      announceToScreenReader(`Alertas visuales ${alertasVisualesActivas ? 'activadas' : 'desactivadas'}`);
      updateAccessibilityStatus();
    }

    // Funciones auxiliares para multimedia
    function toggleSubtitulos() {
      const video = document.getElementById('video-ecuador');
      const subtitulosDiv = document.getElementById('subtitulos-custom');
      
      if (video && subtitulosDiv) {
        subtitulosDiv.classList.toggle('oculto');
        if (!subtitulosDiv.classList.contains('oculto')) {
          // Simular subtÃ­tulos personalizados
          const subtitulos = [
            { tiempo: 0, texto: "Bienvenidos a Ecuador" },
            { tiempo: 3, texto: "Un paÃ­s lleno de diversidad" },
            { tiempo: 6, texto: "Desde las playas hasta las montaÃ±as" },
            { tiempo: 9, texto: "Descubre la magia de nuestro paÃ­s" }
          ];
          
          let currentIndex = 0;
          const interval = setInterval(() => {
            if (currentIndex < subtitulos.length) {
              subtitulosDiv.textContent = subtitulos[currentIndex].texto;
              currentIndex++;
            } else {
              clearInterval(interval);
            }
          }, 3000);
        }
      }
    }

    function toggleTranscripcion() {
      const container = document.getElementById('transcripcion-container');
      if (container) {
        container.classList.toggle('oculto');
        if (!container.classList.contains('oculto')) {
          const texto = document.getElementById('transcripcion-texto');
          texto.innerHTML = `
            <p><strong>TranscripciÃ³n del video:</strong></p>
            <p>Bienvenidos a Ecuador, un paÃ­s lleno de diversidad y belleza natural. 
            Desde las playas del PacÃ­fico hasta las cumbres de los Andes, 
            Ecuador ofrece experiencias Ãºnicas para todos los viajeros.</p>
            <p>En la costa, podrÃ¡s disfrutar de hermosas playas como Salinas y Manta, 
            con aguas cÃ¡lidas y excelente gastronomÃ­a marina.</p>
            <p>En la sierra, ciudades como Cuenca te transportarÃ¡n al pasado colonial, 
            con su arquitectura histÃ³rica y artesanÃ­as tradicionales.</p>
          `;
        }
      }
    }

    function toggleMute() {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.muted = !audio.muted;
        announceToScreenReader(`Audio ${audio.muted ? 'silenciado' : 'activado'}`);
      }
    }

    function ajustarVolumen(nivel) {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.volume = nivel;
        announceToScreenReader(`Volumen ajustado al ${Math.round(nivel * 100)}%`);
      }
    }

    function showVisualAlert(message) {
      if (!alertasVisualesActivas) return;
      
      const alert = document.createElement('div');
      alert.className = 'visual-alert';
      alert.innerHTML = `
        <div class="alert-content">
          <span class="alert-icon">âš ï¸</span>
          <span class="alert-message">${message}</span>
        </div>
      `;
      document.body.appendChild(alert);
      
      setTimeout(() => {
        alert.classList.add('fade-out');
        setTimeout(() => alert.remove(), 500);
      }, 3000);
    }

    function setVolume(value) {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.volume = value;
        document.getElementById('volume-display').textContent = `${Math.round(value * 100)}%`;
      }
    }

    function muteAll() {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.muted = true;
        audio.volume = 0;
        document.getElementById('volume-slider').value = 0;
        document.getElementById('volume-display').textContent = '0%';
      }
      announceToScreenReader('Todo el audio ha sido silenciado');
    }

    function unmuteAll() {
      const audio = document.getElementById('audio-guia');
      if (audio) {
        audio.muted = false;
        audio.volume = 1;
        document.getElementById('volume-slider').value = 1;
        document.getElementById('volume-display').textContent = '100%';
      }
      announceToScreenReader('Audio activado');
    }

    function toggleAutoplay(disabled) {
      const video = document.getElementById('video-ecuador');
      const audio = document.getElementById('audio-guia');
      
      if (video) video.autoplay = !disabled;
      if (audio) audio.autoplay = !disabled;
      
      announceToScreenReader(`ReproducciÃ³n automÃ¡tica ${disabled ? 'deshabilitada' : 'habilitada'}`);
    }

    // Funciones para destinos
    function showDestinationDetails(destinationName) {
      const destinations = {
        'Cuenca': {
          description: 'Cuenca es una ciudad del sur de Ecuador, capital de la provincia del Azuay. Es conocida por su centro histÃ³rico declarado Patrimonio de la Humanidad por la UNESCO.',
          accessibility: 'La ciudad cuenta con rampas de acceso en la mayorÃ­a de edificios histÃ³ricos y transporte pÃºblico adaptado.',
          attractions: ['Centro HistÃ³rico', 'Catedral Nueva', 'Museo Pumapungo', 'Mercado 10 de Agosto']
        },
        'Salinas': {
          description: 'Salinas es una ciudad costera en la provincia de Santa Elena, conocida por sus hermosas playas y excelente infraestructura turÃ­stica.',
          accessibility: 'Playas con acceso para sillas de ruedas y hoteles con habitaciones adaptadas.',
          attractions: ['Playa de Salinas', 'MalecÃ³n', 'Museo del Mar', 'Restaurantes de mariscos']
        },
        'Manta': {
          description: 'Manta es un importante puerto pesquero y ciudad turÃ­stica en la provincia de ManabÃ­.',
          accessibility: 'Transporte pÃºblico adaptado y guÃ­as turÃ­sticos especializados en accesibilidad.',
          attractions: ['Puerto Pesquero', 'Playa de Manta', 'Museo del Banco Central', 'Malecon 2000']
        }
      };
      
      const dest = destinations[destinationName];
      if (dest) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = `
          <div class="modal-content destination-modal">
            <span class="cerrar" onclick="this.parentElement.parentElement.remove()">&times;</span>
            <h2>${destinationName}</h2>
            <p>${dest.description}</p>
            <h3>Accesibilidad</h3>
            <p>${dest.accessibility}</p>
            <h3>Atracciones Principales</h3>
            <ul>
              ${dest.attractions.map(attr => `<li>${attr}</li>`).join('')}
            </ul>
            <button onclick="this.parentElement.parentElement.remove()" class="btn-destino">Cerrar</button>
          </div>
        `;
        document.body.appendChild(modal);
        modal.classList.remove('oculto');
      }
    }

    // Funciones para el menÃº principal mejorado
    let currentPage = 'inicio';
    let mobileMenuOpen = false;

    function toggleMobileMenu() {
      const menu = document.getElementById('menu-principal');
      const button = document.querySelector('.menu-toggle-mobile');
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      
      mobileMenuOpen = !mobileMenuOpen;
      menu.classList.toggle('active', mobileMenuOpen);
      button.setAttribute('aria-expanded', !isExpanded);
      
      if (mobileMenuOpen) {
        button.innerHTML = '<span class="hamburger-icon" aria-hidden="true">âœ•</span><span class="menu-text">Cerrar</span>';
        announceToScreenReader('MenÃº mÃ³vil abierto');
      } else {
        button.innerHTML = '<span class="hamburger-icon" aria-hidden="true">â˜°</span><span class="menu-text">MenÃº</span>';
        announceToScreenReader('MenÃº mÃ³vil cerrado');
      }
    }

    function setActiveMenuItem(pageId) {
      // Remover clase active de todos los elementos
      const menuItems = document.querySelectorAll('.menu-item');
      menuItems.forEach(item => {
        item.classList.remove('active');
        item.removeAttribute('aria-current');
      });
      
      // Agregar clase active al elemento correspondiente
      const activeItem = document.querySelector(`[href="#${pageId}"]`);
      if (activeItem) {
        activeItem.classList.add('active');
        activeItem.setAttribute('aria-current', 'page');
      }
      
      currentPage = pageId;
      announceToScreenReader(`Navegando a ${pageId}`);
    }

    function scrollToSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) {
        section.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start' 
        });
        setActiveMenuItem(sectionId);
        announceToScreenReader(`SecciÃ³n ${sectionId} visible`);
      }
    }

    // NavegaciÃ³n por teclado mejorada para el menÃº
    function setupMenuKeyboardNavigation() {
      const menuItems = document.querySelectorAll('.menu-item');
      const menuSections = document.querySelectorAll('.menu-section');
      
      // NavegaciÃ³n entre secciones
      menuSections.forEach((section, sectionIndex) => {
        const sectionItems = section.querySelectorAll('.menu-item');
        
        sectionItems.forEach((item, itemIndex) => {
          item.addEventListener('keydown', function(event) {
            switch(event.key) {
              case 'ArrowRight':
                event.preventDefault();
                const nextItem = itemIndex < sectionItems.length - 1 ? 
                  sectionItems[itemIndex + 1] : 
                  (sectionIndex < menuSections.length - 1 ? 
                    menuSections[sectionIndex + 1].querySelector('.menu-item') : 
                    sectionItems[0]);
                nextItem.focus();
                break;
                
              case 'ArrowLeft':
                event.preventDefault();
                const prevItem = itemIndex > 0 ? 
                  sectionItems[itemIndex - 1] : 
                  (sectionIndex > 0 ? 
                    menuSections[sectionIndex - 1].querySelectorAll('.menu-item') : 
                    sectionItems);
                const prevItemElement = Array.isArray(prevItem) ? 
                  prevItem[prevItem.length - 1] : prevItem;
                prevItemElement.focus();
                break;
                
              case 'ArrowDown':
                event.preventDefault();
                const nextSection = sectionIndex < menuSections.length - 1 ? 
                  menuSections[sectionIndex + 1] : menuSections[0];
                const nextSectionItem = nextSection.querySelector('.menu-item');
                nextSectionItem.focus();
                break;
                
              case 'ArrowUp':
                event.preventDefault();
                const prevSection = sectionIndex > 0 ? 
                  menuSections[sectionIndex - 1] : menuSections[menuSections.length - 1];
                const prevSectionItem = prevSection.querySelector('.menu-item');
                prevSectionItem.focus();
                break;
                
              case 'Enter':
              case ' ':
                event.preventDefault();
                if (item.tagName === 'A') {
                  item.click();
                } else if (item.tagName === 'BUTTON') {
                  item.click();
                }
                break;
                
              case 'Escape':
                if (mobileMenuOpen) {
                  toggleMobileMenu();
                }
                break;
            }
          });
        });
      });
    }

    // FunciÃ³n para cerrar menÃº mÃ³vil al hacer clic fuera
    function setupMenuClickOutside() {
      document.addEventListener('click', function(event) {
        const menu = document.getElementById('menu-principal');
        const menuToggle = document.querySelector('.menu-toggle-mobile');
        
        if (mobileMenuOpen && 
            !menu.contains(event.target) && 
            !menuToggle.contains(event.target)) {
          toggleMobileMenu();
        }
      });
    }

    // FunciÃ³n para manejar cambios de tamaÃ±o de ventana
    function handleResize() {
      if (window.innerWidth > 768 && mobileMenuOpen) {
        toggleMobileMenu();
      }
    }

    // FunciÃ³n para mostrar breadcrumbs
    function updateBreadcrumbs() {
      const breadcrumbs = document.getElementById('breadcrumbs');
      if (breadcrumbs) {
        const pageNames = {
          'inicio': 'Inicio',
          'rutas': 'Rutas',
          'alojamientos': 'Alojamientos',
          'accesibilidad': 'Accesibilidad',
          'contacto': 'Contacto',
          'login': 'Iniciar SesiÃ³n',
          'register': 'Registrarse'
        };
        
        breadcrumbs.innerHTML = `
          <a href="#inicio">Inicio</a>
          ${currentPage !== 'inicio' ? ` > <span>${pageNames[currentPage] || currentPage}</span>` : ''}
        `;
      }
    }

    // FunciÃ³n para mostrar indicador de progreso
    function showProgressIndicator() {
      const progress = document.createElement('div');
      progress.className = 'progress-indicator';
      progress.innerHTML = `
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
      `;
      document.body.appendChild(progress);
      
      setTimeout(() => {
        progress.remove();
      }, 1000);
    }

    // NavegaciÃ³n por teclado
    document.addEventListener('keydown', function(event) {
      // NavegaciÃ³n con Tab
      if (event.key === 'Tab') {
        document.body.classList.add('keyboard-navigation');
      }
      
      // NavegaciÃ³n con teclas de flecha en el menÃº de accesibilidad
      if (event.key === 'ArrowDown' || event.key === 'ArrowUp') {
        const menu = document.getElementById('accesibilidad-lista');
        if (!menu.classList.contains('oculto')) {
          event.preventDefault();
          const buttons = menu.querySelectorAll('button');
          const currentIndex = Array.from(buttons).findIndex(btn => btn === document.activeElement);
          
          if (currentIndex !== -1) {
            let newIndex;
            if (event.key === 'ArrowDown') {
              newIndex = (currentIndex + 1) % buttons.length;
            } else {
              newIndex = currentIndex > 0 ? currentIndex - 1 : buttons.length - 1;
            }
            buttons[newIndex].focus();
          }
        }
      }
      
      // Cerrar menÃº con Escape
      if (event.key === 'Escape') {
        const menu = document.getElementById('accesibilidad-lista');
        if (!menu.classList.contains('oculto')) {
          toggleAccMenu();
        }
      }
      
      // Atajos de teclado para accesibilidad
      if (event.ctrlKey || event.metaKey) {
        switch(event.key) {
          case '1':
            event.preventDefault();
            activateHighContrast();
            break;
          case '2':
            event.preventDefault();
            activateMonochromaticMode();
            break;
          case '3':
            event.preventDefault();
            increaseTextSize();
            break;
          case '4':
            event.preventDefault();
            decreaseTextSize();
            break;
          case '5':
            event.preventDefault();
            adjustSpacing();
            break;
          case '6':
            event.preventDefault();
            useReadableFont();
            break;
          case '7':
            event.preventDefault();
            activateZoom();
            break;
          case '8':
            event.preventDefault();
            highlightLinks();
            break;
          case '9':
            event.preventDefault();
            pauseAnimations();
            break;
          case '0':
            event.preventDefault();
            resetAccessibility();
            break;
        }
      }
    });

    document.addEventListener('mousedown', function() {
      document.body.classList.remove('keyboard-navigation');
    });

    // Mejorar navegaciÃ³n por teclado para el menÃº principal
    function setupKeyboardNavigation() {
      const navItems = document.querySelectorAll('.nav a');
      navItems.forEach((item, index) => {
        item.addEventListener('keydown', function(event) {
          if (event.key === 'ArrowRight') {
            event.preventDefault();
            const nextIndex = (index + 1) % navItems.length;
            navItems[nextIndex].focus();
          } else if (event.key === 'ArrowLeft') {
            event.preventDefault();
            const prevIndex = index > 0 ? index - 1 : navItems.length - 1;
            navItems[prevIndex].focus();
          }
        });
      });
    }

    // FunciÃ³n para mostrar informaciÃ³n de accesibilidad
    function showAccessibilityInfo() {
      const info = `
        <div class="accessibility-info">
          <h3>InformaciÃ³n de Accesibilidad</h3>
          <p>Este sitio web incluye las siguientes caracterÃ­sticas de accesibilidad:</p>
          <ul>
            <li><strong>Alto contraste:</strong> Mejora la visibilidad del texto y elementos</li>
            <li><strong>Modo monocromÃ¡tico:</strong> Convierte todos los colores a escala de grises</li>
            <li><strong>Ajuste de texto:</strong> Aumentar o reducir el tamaÃ±o del texto</li>
            <li><strong>Espaciado:</strong> Ajustar el espaciado entre lÃ­neas, palabras y caracteres</li>
            <li><strong>Fuente legible:</strong> Cambiar a una fuente mÃ¡s fÃ¡cil de leer</li>
            <li><strong>Zoom de pÃ¡gina:</strong> Ampliar todo el contenido de la pÃ¡gina</li>
            <li><strong>Resaltado de enlaces:</strong> Destacar enlaces y elementos de foco</li>
            <li><strong>Pausar animaciones:</strong> Detener todas las animaciones</li>
            <li><strong>Lectura de texto:</strong> Leer el contenido en voz alta</li>
            <li><strong>DescripciÃ³n de audio:</strong> Proporcionar descripciones de audio</li>
          </ul>
          <p><strong>Atajos de teclado:</strong></p>
          <ul>
            <li>Ctrl+1: Alto contraste</li>
            <li>Ctrl+2: Modo monocromÃ¡tico</li>
            <li>Ctrl+3: Aumentar texto</li>
            <li>Ctrl+4: Reducir texto</li>
            <li>Ctrl+5: Ajustar espaciado</li>
            <li>Ctrl+6: Fuente legible</li>
            <li>Ctrl+7: Zoom de pÃ¡gina</li>
            <li>Ctrl+8: Resaltar enlaces</li>
            <li>Ctrl+9: Pausar animaciones</li>
            <li>Ctrl+0: Restablecer todo</li>
          </ul>
          <button onclick="this.parentElement.remove()" class="btn-destino">Cerrar</button>
        </div>
      `;
      
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `<div class="modal-content">${info}</div>`;
      document.body.appendChild(modal);
      modal.classList.remove('oculto');
    }

    // InicializaciÃ³n
    document.addEventListener('DOMContentLoaded', function() {
      initializeMap();
      initializeBanner();
      
      // Alias para compatibilidad
      window.mostrarModal = showModal;
      window.cerrarModal = closeModal;
      window.activarContraste = activateHighContrast;
      window.activarModoMonocromatico = activateMonochromaticMode;
      window.aumentarTexto = increaseTextSize;
      window.reducirTexto = decreaseTextSize;
      window.ajustarEspaciado = adjustSpacing;
      window.usarFuenteLegible = useReadableFont;
      window.activarZoom = activateZoom;
      window.resaltarEnlaces = highlightLinks;
      window.pausarAnimaciones = pauseAnimations;
      window.restablecerAccesibilidad = resetAccessibility;
      window.leerTexto = readText;
      window.activarDescripcionAudio = activateAudioDescription;
      window.activarSubtitulos = activateSubtitles;
      window.activarSubtitulosDirecto = activateLiveSubtitles;
      window.descargarTranscripcion = downloadTranscription;
      window.mostrarControlesAudio = showAudioControls;
      window.activarAlertasVisuales = activateVisualAlerts;
      window.mostrarInfoAccesibilidad = showAccessibilityInfo;
      window.mostrarPanelAdmin = showAdminPanel;
      window.showDestinationDetails = showDestinationDetails;
      window.togglePasswordVisibility = togglePasswordVisibility;
      window.mostrarRecuperarPassword = mostrarRecuperarPassword;
      window.enviarRecuperacion = enviarRecuperacion;
      window.mostrarModalContacto = mostrarModalContacto;
      
      setupKeyboardNavigation(); // Inicializar la navegaciÃ³n por teclado para el menÃº principal
      setupMenuKeyboardNavigation(); // Inicializar la navegaciÃ³n por teclado para el menÃº principal mejorado
      setupMenuClickOutside(); // Inicializar el cierre de menÃº al hacer clic fuera
      window.addEventListener('resize', handleResize); // Inicializar el manejo de tamaÃ±o de ventana
      updateBreadcrumbs(); // Inicializar las breadcrumbs
      showProgressIndicator(); // Inicializar el indicador de progreso
      
      // Inicializar funciones del formulario de login
      setupRealTimeValidation();
      loadRememberedUser();
      
      // Inicializar funciones del formulario de registro
      setupRegistroRealTimeValidation();
    });

    // Guardar token y rol tras login
    function guardarSesion(token, rol) {
      localStorage.setItem('token', token);
      localStorage.setItem('rol', rol);
    }

    // Mostrar/ocultar botÃ³n de registro de admin segÃºn el rol
    function actualizarUIporRol() {
      const rol = localStorage.getItem('rol');
      const btnAdmin = document.getElementById('btn-registro-admin');
      if (rol === 'admin') {
        if (!btnAdmin) {
          const btn = document.createElement('button');
          btn.id = 'btn-registro-admin';
          btn.className = 'btn-outline';
          btn.innerText = 'Registrar Admin';
          btn.onclick = () => mostrarModal('modal-admin');
          document.querySelector('.custom-buttons').appendChild(btn);
        }
      } else if (btnAdmin) {
        btnAdmin.remove();
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      actualizarUIporRol();
    });

    // Login mejorado: guardar token y rol
    const formLogin = document.getElementById('form-login');
    if (formLogin) {
      formLogin.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Limpiar estado anterior
        clearLoginStatus();
        
        // Validar formulario
        if (!validateLoginForm()) {
          return;
        }
        
        // Verificar intentos de login
        if (!checkLoginAttempts()) {
          return;
        }
        
        // Mostrar CAPTCHA si es necesario
        if (loginAttempts >= 2) {
          showCaptcha();
          if (!validateCaptcha()) {
            return;
          }
        }
        
        const usuario = document.getElementById('login-usuario').value.trim();
        const clave = document.getElementById('login-clave').value;
        
        // Mostrar estado de carga
        setLoginButtonLoading(true);
        showLoginStatus('Verificando credenciales...', 'info');
        
        try {
          const startTime = Date.now();
          
          const res = await fetch(`${API_BASE_URL}/login`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ usuario, clave })
          });
          
          const data = await res.json();
          const endTime = Date.now();
          const responseTime = endTime - startTime;
          
          // Verificar tiempo de respuesta
          if (responseTime > 15000) {
            showLoginStatus('La respuesta del servidor fue lenta. Intenta nuevamente.', 'error');
            setLoginButtonLoading(false);
            return;
          }
          
          if (res.ok) {
            // Login exitoso
            guardarSesion(data.token, data.rol);
            actualizarUIporRol();
            
            // Recordar usuario si estÃ¡ marcado
            rememberUser(usuario);
            
            // Resetear intentos
            loginAttempts = 0;
            
            showLoginStatus('Â¡Inicio de sesiÃ³n exitoso! Redirigiendo...', 'success');
            announceToScreenReader('Inicio de sesiÃ³n exitoso');
            
            // Cerrar modal despuÃ©s de un breve delay
            setTimeout(() => {
              cerrarModal('modal-login');
              showNotification('Bienvenido al Portal TurÃ­stico Ecuador', 'success');
            }, 1500);
            
          } else {
            // Login fallido
            loginAttempts++;
            lastLoginAttempt = Date.now();
            
            // Mensaje neutro para evitar ataques de enumeraciÃ³n
            const errorMessage = 'Usuario o contraseÃ±a incorrectos. Verifica tus credenciales.';
            showLoginStatus(errorMessage, 'error');
            announceToScreenReader('Error de autenticaciÃ³n');
            
            // Mostrar CAPTCHA en el siguiente intento
            if (loginAttempts >= 2) {
              showLoginStatus('Se requiere verificaciÃ³n adicional para continuar.', 'info');
            }
            
            setLoginButtonLoading(false);
          }
          
        } catch (error) {
          console.error('Error en login:', error);
          showLoginStatus('Error de conexiÃ³n. Verifica tu conexiÃ³n a internet e intenta nuevamente.', 'error');
          setLoginButtonLoading(false);
        }
      });
    }

    // Registro usuario normal mejorado
    const formRegistro = document.getElementById('form-registro');
    if (formRegistro) {
      formRegistro.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Limpiar estado anterior
        clearRegistroStatus();
        
        // Validar formulario
        if (!validateRegistroForm()) {
          return;
        }
        
        // Obtener datos del formulario
        const formData = {
          nombre: document.getElementById('nombre').value.trim(),
          cedula: document.getElementById('cedula').value.trim(),
          email: document.getElementById('email').value.trim(),
          telefono: document.getElementById('telefono').value.trim() || null,
          usuario: document.getElementById('usuario').value.trim(),
          clave: document.getElementById('clave').value,
          recibirNotificaciones: document.getElementById('recibir-notificaciones').checked
        };
        
        // Mostrar estado de carga
        setRegistroButtonLoading(true);
        showRegistroStatus('Creando tu cuenta...', 'info');
        
        try {
          const startTime = Date.now();
          
          const res = await fetch(`${API_BASE_URL}/registro`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          
          const data = await res.json();
          const endTime = Date.now();
          const responseTime = endTime - startTime;
          
          // Verificar tiempo de respuesta
          if (responseTime > 15000) {
            showRegistroStatus('La respuesta del servidor fue lenta. Intenta nuevamente.', 'error');
            setRegistroButtonLoading(false);
            return;
          }
          
          if (res.ok) {
            // Registro exitoso
            showRegistroStatus('Â¡Cuenta creada exitosamente! Redirigiendo...', 'success');
            announceToScreenReader('Cuenta creada exitosamente');
            
            // Cerrar modal despuÃ©s de un breve delay
            setTimeout(() => {
              cerrarModal('modal-auth');
              showNotification('Â¡Bienvenido al Portal TurÃ­stico Ecuador!', 'success');
              
              // Opcional: abrir modal de login
              setTimeout(() => {
                mostrarModal('modal-login');
              }, 1000);
            }, 2000);
            
          } else {
            // Registro fallido
            const errorMessage = data.mensaje || 'Error al crear la cuenta. Verifica los datos e intenta nuevamente.';
            showRegistroStatus(errorMessage, 'error');
            announceToScreenReader('Error al crear cuenta');
            setRegistroButtonLoading(false);
          }
          
        } catch (error) {
          console.error('Error en registro:', error);
          showRegistroStatus('Error de conexiÃ³n. Verifica tu conexiÃ³n a internet e intenta nuevamente.', 'error');
          setRegistroButtonLoading(false);
        }
      });
    }

    // Registro administrador (solo admins)
    const formRegistroAdmin = document.getElementById('form-registro-admin');
    if (formRegistroAdmin) {
      formRegistroAdmin.addEventListener('submit', async (e) => {
        e.preventDefault();
        const usuario = document.getElementById('admin-usuario').value;
        const clave = document.getElementById('admin-clave').value;
        const email = document.getElementById('admin-email').value;
        const token = localStorage.getItem('token');
        const res = await fetch(`${API_BASE_URL}/registro_admin`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ usuario, clave, email })
        });
        const data = await res.json();
        if (res.ok) {
          showNotification('Administrador registrado con Ã©xito', 'success');
          cerrarModal('modal-admin');
        } else {
          showNotification(data.mensaje || 'Error al registrar admin', 'error');
        }
      });
    }

    // Funciones para el formulario de login mejorado
    let loginAttempts = 0;
    let lastLoginAttempt = 0;
    const MAX_LOGIN_ATTEMPTS = 3;
    const LOCKOUT_TIME = 300000; // 5 minutos

    function togglePasswordVisibility(inputId) {
      const input = document.getElementById(inputId);
      const toggle = input.parentElement.querySelector('.password-toggle');
      const icon = toggle.querySelector('.toggle-icon');
      
      if (input.type === 'password') {
        input.type = 'text';
        toggle.setAttribute('aria-pressed', 'true');
        toggle.setAttribute('aria-label', 'Ocultar contraseÃ±a');
        icon.textContent = 'ğŸ™ˆ';
      } else {
        input.type = 'password';
        toggle.setAttribute('aria-pressed', 'false');
        toggle.setAttribute('aria-label', 'Mostrar contraseÃ±a');
        icon.textContent = 'ğŸ‘ï¸';
      }
    }

    function validateLoginForm() {
      const usuario = document.getElementById('login-usuario');
      const clave = document.getElementById('login-clave');
      const usuarioError = document.getElementById('login-usuario-error');
      const claveError = document.getElementById('login-clave-error');
      
      let isValid = true;
      
      // Limpiar errores anteriores
      clearLoginErrors();
      
      // Validar usuario
      if (!usuario.value.trim()) {
        showFieldError(usuarioError, 'El nombre de usuario es requerido');
        isValid = false;
      } else if (usuario.value.trim().length < 3) {
        showFieldError(usuarioError, 'El nombre de usuario debe tener al menos 3 caracteres');
        isValid = false;
      }
      
      // Validar contraseÃ±a
      if (!clave.value) {
        showFieldError(claveError, 'La contraseÃ±a es requerida');
        isValid = false;
      } else if (clave.value.length < 6) {
        showFieldError(claveError, 'La contraseÃ±a debe tener al menos 6 caracteres');
        isValid = false;
      }
      
      return isValid;
    }

    function showFieldError(errorElement, message) {
      errorElement.textContent = message;
      errorElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearLoginErrors() {
      const errorElements = document.querySelectorAll('#form-login .error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    function showLoginStatus(message, type = 'info') {
      const statusElement = document.getElementById('login-status');
      statusElement.textContent = message;
      statusElement.className = `login-status ${type}`;
      statusElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearLoginStatus() {
      const statusElement = document.getElementById('login-status');
      statusElement.style.display = 'none';
      statusElement.textContent = '';
    }

    function setLoginButtonLoading(loading) {
      const button = document.getElementById('login-submit-btn');
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        button.querySelector('.btn-text').textContent = 'Iniciando sesiÃ³n...';
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        button.querySelector('.btn-text').textContent = 'Iniciar SesiÃ³n';
      }
    }

    function checkLoginAttempts() {
      const now = Date.now();
      
      // Si han pasado mÃ¡s de 5 minutos, resetear intentos
      if (now - lastLoginAttempt > LOCKOUT_TIME) {
        loginAttempts = 0;
      }
      
      if (loginAttempts >= MAX_LOGIN_ATTEMPTS) {
        const remainingTime = Math.ceil((LOCKOUT_TIME - (now - lastLoginAttempt)) / 1000);
        showLoginStatus(`Demasiados intentos fallidos. Intenta nuevamente en ${remainingTime} segundos.`, 'error');
        setLoginButtonLoading(false);
        return false;
      }
      
      return true;
    }

    function showCaptcha() {
      const captchaContainer = document.getElementById('captcha-container');
      const captchaText = document.getElementById('captcha-text');
      
      const captchaQuestions = [
        'Â¿CuÃ¡l es la capital de Ecuador?',
        'Â¿En quÃ© continente estÃ¡ Ecuador?',
        'Â¿CuÃ¡l es el color de la bandera de Ecuador?',
        'Â¿CuÃ¡l es la moneda de Ecuador?'
      ];
      
      const captchaAnswers = [
        'quito',
        'america',
        'amarillo',
        'dolar'
      ];
      
      const randomIndex = Math.floor(Math.random() * captchaQuestions.length);
      captchaText.textContent = captchaQuestions[randomIndex];
      captchaText.setAttribute('data-answer', captchaAnswers[randomIndex]);
      
      captchaContainer.style.display = 'block';
      announceToScreenReader('Se requiere verificaciÃ³n de seguridad');
    }

    function validateCaptcha() {
      const captchaContainer = document.getElementById('captcha-container');
      const captchaAnswer = document.getElementById('captcha-answer');
      const captchaText = document.getElementById('captcha-text');
      
      if (captchaContainer.style.display === 'block') {
        const userAnswer = captchaAnswer.value.toLowerCase().trim();
        const correctAnswer = captchaText.getAttribute('data-answer');
        
        if (userAnswer !== correctAnswer) {
          showLoginStatus('Respuesta de verificaciÃ³n incorrecta. Intenta nuevamente.', 'error');
          return false;
        }
      }
      
      return true;
    }

    function rememberUser(username) {
      const rememberCheckbox = document.getElementById('remember-user');
      if (rememberCheckbox.checked) {
        localStorage.setItem('rememberedUser', username);
        announceToScreenReader('Usuario recordado');
      } else {
        localStorage.removeItem('rememberedUser');
      }
    }

    function loadRememberedUser() {
      const rememberedUser = localStorage.getItem('rememberedUser');
      if (rememberedUser) {
        const usuarioInput = document.getElementById('login-usuario');
        usuarioInput.value = rememberedUser;
        document.getElementById('remember-user').checked = true;
        announceToScreenReader('Usuario recordado cargado');
      }
    }

    function mostrarRecuperarPassword() {
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `
        <div class="modal-content login-modal">
          <span class="cerrar" onclick="this.parentElement.parentElement.remove()">&times;</span>
          <div class="login-header">
            <div class="login-icon" aria-hidden="true">ğŸ”‘</div>
            <h2>Recuperar ContraseÃ±a</h2>
            <p>Ingresa tu correo electrÃ³nico para recibir instrucciones</p>
          </div>
          <form onsubmit="enviarRecuperacion(event)">
            <div class="form-group">
              <label for="recovery-email" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“§</span>
                Correo ElectrÃ³nico
              </label>
              <input 
                type="email" 
                id="recovery-email" 
                required 
                class="form-input"
                placeholder="tu@email.com"
                autocomplete="email"
              />
            </div>
            <button type="submit" class="btn-login-submit">
              <span class="btn-icon" aria-hidden="true">ğŸ“¤</span>
              <span class="btn-text">Enviar Instrucciones</span>
            </button>
          </form>
        </div>
      `;
      document.body.appendChild(modal);
      modal.classList.remove('oculto');
      announceToScreenReader('Modal de recuperaciÃ³n de contraseÃ±a abierto');
    }

    function enviarRecuperacion(event) {
      event.preventDefault();
      const email = document.getElementById('recovery-email').value;
      
      // Simular envÃ­o de recuperaciÃ³n
      showNotification('Instrucciones enviadas a tu correo electrÃ³nico', 'success');
      announceToScreenReader('Instrucciones de recuperaciÃ³n enviadas');
      
      // Cerrar modal
      event.target.closest('.modal').remove();
    }

    // ValidaciÃ³n en tiempo real
    function setupRealTimeValidation() {
      const usuario = document.getElementById('login-usuario');
      const clave = document.getElementById('login-clave');
      
      usuario.addEventListener('input', function() {
        const errorElement = document.getElementById('login-usuario-error');
        if (this.value.trim().length >= 3) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El nombre de usuario debe tener al menos 3 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      clave.addEventListener('input', function() {
        const errorElement = document.getElementById('login-clave-error');
        if (this.value.length >= 6) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.length > 0) {
          showFieldError(errorElement, 'La contraseÃ±a debe tener al menos 6 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
    }

    // Funciones para el formulario de registro mejorado
    function validateRegistroForm() {
      const nombre = document.getElementById('nombre');
      const cedula = document.getElementById('cedula');
      const email = document.getElementById('email');
      const telefono = document.getElementById('telefono');
      const usuario = document.getElementById('usuario');
      const clave = document.getElementById('clave');
      const confirmarClave = document.getElementById('confirmar-clave');
      const aceptarTerminos = document.getElementById('aceptar-terminos');
      
      let isValid = true;
      
      // Limpiar errores anteriores
      clearRegistroErrors();
      
      // Validar nombre
      if (!nombre.value.trim()) {
        showFieldError('nombre-error', 'El nombre completo es requerido');
        isValid = false;
      } else if (nombre.value.trim().length < 2) {
        showFieldError('nombre-error', 'El nombre debe tener al menos 2 caracteres');
        isValid = false;
      }
      
      // Validar cÃ©dula
      if (!cedula.value.trim()) {
        showFieldError('cedula-error', 'La cÃ©dula de identidad es requerida');
        isValid = false;
      } else if (!/^[0-9]{10}$/.test(cedula.value.trim())) {
        showFieldError('cedula-error', 'La cÃ©dula debe tener exactamente 10 dÃ­gitos');
        isValid = false;
      }
      
      // Validar email
      if (!email.value.trim()) {
        showFieldError('email-error', 'El correo electrÃ³nico es requerido');
        isValid = false;
      } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) {
        showFieldError('email-error', 'Ingresa un correo electrÃ³nico vÃ¡lido');
        isValid = false;
      }
      
      // Validar telÃ©fono (opcional)
      if (telefono.value.trim() && !/^[0-9]{10}$/.test(telefono.value.trim())) {
        showFieldError('telefono-error', 'El telÃ©fono debe tener 10 dÃ­gitos');
        isValid = false;
      }
      
      // Validar usuario
      if (!usuario.value.trim()) {
        showFieldError('usuario-error', 'El nombre de usuario es requerido');
        isValid = false;
      } else if (usuario.value.trim().length < 3) {
        showFieldError('usuario-error', 'El nombre de usuario debe tener al menos 3 caracteres');
        isValid = false;
      } else if (!/^[a-zA-Z0-9_]+$/.test(usuario.value.trim())) {
        showFieldError('usuario-error', 'Solo se permiten letras, nÃºmeros y guiones bajos');
        isValid = false;
      }
      
      // Validar contraseÃ±a
      if (!clave.value) {
        showFieldError('clave-error', 'La contraseÃ±a es requerida');
        isValid = false;
      } else if (clave.value.length < 8) {
        showFieldError('clave-error', 'La contraseÃ±a debe tener al menos 8 caracteres');
        isValid = false;
      } else if (!/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(clave.value)) {
        showFieldError('clave-error', 'La contraseÃ±a debe incluir mayÃºsculas, minÃºsculas y nÃºmeros');
        isValid = false;
      }
      
      // Validar confirmaciÃ³n de contraseÃ±a
      if (!confirmarClave.value) {
        showFieldError('confirmar-clave-error', 'Debes confirmar tu contraseÃ±a');
        isValid = false;
      } else if (clave.value !== confirmarClave.value) {
        showFieldError('confirmar-clave-error', 'Las contraseÃ±as no coinciden');
        isValid = false;
      }
      
      // Validar tÃ©rminos y condiciones
      if (!aceptarTerminos.checked) {
        showFieldError('terminos-help', 'Debes aceptar los tÃ©rminos y condiciones');
        isValid = false;
      }
      
      return isValid;
    }

    function clearRegistroErrors() {
      const errorElements = document.querySelectorAll('#form-registro .error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    function showRegistroStatus(message, type = 'info') {
      const statusElement = document.getElementById('registro-status');
      statusElement.textContent = message;
      statusElement.className = `registro-status ${type}`;
      statusElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearRegistroStatus() {
      const statusElement = document.getElementById('registro-status');
      statusElement.style.display = 'none';
      statusElement.textContent = '';
    }

    function setRegistroButtonLoading(loading) {
      const button = document.getElementById('registro-submit-btn');
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        button.querySelector('.btn-text').textContent = 'Creando cuenta...';
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        button.querySelector('.btn-text').textContent = 'Crear Cuenta';
      }
    }

    function checkPasswordStrength(password) {
      let strength = 0;
      let feedback = [];
      
      // Longitud mÃ­nima
      if (password.length >= 8) strength += 1;
      else feedback.push('Al menos 8 caracteres');
      
      // Letras minÃºsculas
      if (/[a-z]/.test(password)) strength += 1;
      else feedback.push('Letras minÃºsculas');
      
      // Letras mayÃºsculas
      if (/[A-Z]/.test(password)) strength += 1;
      else feedback.push('Letras mayÃºsculas');
      
      // NÃºmeros
      if (/\d/.test(password)) strength += 1;
      else feedback.push('NÃºmeros');
      
      // Caracteres especiales
      if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength += 1;
      else feedback.push('Caracteres especiales');
      
      const strengthBar = document.getElementById('password-strength-bar');
      const strengthText = document.getElementById('password-strength-text');
      
      // Remover clases anteriores
      strengthBar.className = 'strength-fill';
      
      // Aplicar clase segÃºn fortaleza
      if (strength <= 1) {
        strengthBar.classList.add('weak');
        strengthText.textContent = 'DÃ©bil';
      } else if (strength <= 2) {
        strengthBar.classList.add('fair');
        strengthText.textContent = 'Regular';
      } else if (strength <= 3) {
        strengthBar.classList.add('good');
        strengthText.textContent = 'Buena';
      } else {
        strengthBar.classList.add('strong');
        strengthText.textContent = 'Fuerte';
      }
      
      return { strength, feedback };
    }

    function setupRegistroRealTimeValidation() {
      // ValidaciÃ³n en tiempo real para nombre
      document.getElementById('nombre').addEventListener('input', function() {
        const errorElement = document.getElementById('nombre-error');
        if (this.value.trim().length >= 2) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El nombre debe tener al menos 2 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para cÃ©dula
      document.getElementById('cedula').addEventListener('input', function() {
        const errorElement = document.getElementById('cedula-error');
        if (/^[0-9]{10}$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'La cÃ©dula debe tener exactamente 10 dÃ­gitos');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para email
      document.getElementById('email').addEventListener('input', function() {
        const errorElement = document.getElementById('email-error');
        if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'Ingresa un correo electrÃ³nico vÃ¡lido');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para telÃ©fono
      document.getElementById('telefono').addEventListener('input', function() {
        const errorElement = document.getElementById('telefono-error');
        if (this.value.trim() === '' || /^[0-9]{10}$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El telÃ©fono debe tener 10 dÃ­gitos');
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para usuario
      document.getElementById('usuario').addEventListener('input', function() {
        const errorElement = document.getElementById('usuario-error');
        if (this.value.trim().length >= 3 && /^[a-zA-Z0-9_]+$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          if (this.value.trim().length < 3) {
            showFieldError(errorElement, 'El nombre de usuario debe tener al menos 3 caracteres');
          } else {
            showFieldError(errorElement, 'Solo se permiten letras, nÃºmeros y guiones bajos');
          }
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para contraseÃ±a
      document.getElementById('clave').addEventListener('input', function() {
        const errorElement = document.getElementById('clave-error');
        const strength = checkPasswordStrength(this.value);
        
        if (this.value.length >= 8 && /(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(this.value)) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.length > 0) {
          if (this.value.length < 8) {
            showFieldError(errorElement, 'La contraseÃ±a debe tener al menos 8 caracteres');
          } else {
            showFieldError(errorElement, 'La contraseÃ±a debe incluir mayÃºsculas, minÃºsculas y nÃºmeros');
          }
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
        
        // Validar confirmaciÃ³n de contraseÃ±a
        const confirmarClave = document.getElementById('confirmar-clave');
        if (confirmarClave.value && this.value !== confirmarClave.value) {
          showFieldError('confirmar-clave-error', 'Las contraseÃ±as no coinciden');
        } else if (confirmarClave.value && this.value === confirmarClave.value) {
          document.getElementById('confirmar-clave-error').style.display = 'none';
          confirmarClave.classList.add('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para confirmaciÃ³n de contraseÃ±a
      document.getElementById('confirmar-clave').addEventListener('input', function() {
        const errorElement = document.getElementById('confirmar-clave-error');
        const clave = document.getElementById('clave').value;
        
        if (this.value === clave && clave.length > 0) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.length > 0) {
          showFieldError(errorElement, 'Las contraseÃ±as no coinciden');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
    }

    // Funciones para el formulario de contacto
    function validateContactoForm() {
      const nombre = document.getElementById('contacto-nombre');
      const email = document.getElementById('contacto-email');
      const telefono = document.getElementById('contacto-telefono');
      const asunto = document.getElementById('contacto-asunto');
      const mensaje = document.getElementById('contacto-mensaje');
      const captchaAnswer = document.getElementById('contacto-captcha-answer');
      
      let isValid = true;
      
      // Limpiar errores anteriores
      clearContactoErrors();
      
      // Validar nombre
      if (!nombre.value.trim()) {
        showFieldError('contacto-nombre-error', 'El nombre completo es requerido');
        isValid = false;
      } else if (nombre.value.trim().length < 2) {
        showFieldError('contacto-nombre-error', 'El nombre debe tener al menos 2 caracteres');
        isValid = false;
      }
      
      // Validar email
      if (!email.value.trim()) {
        showFieldError('contacto-email-error', 'El correo electrÃ³nico es requerido');
        isValid = false;
      } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) {
        showFieldError('contacto-email-error', 'Ingresa un correo electrÃ³nico vÃ¡lido');
        isValid = false;
      }
      
      // Validar telÃ©fono (opcional)
      if (telefono.value.trim() && !/^[0-9]{10}$/.test(telefono.value.trim())) {
        showFieldError('contacto-telefono-error', 'El telÃ©fono debe tener 10 dÃ­gitos');
        isValid = false;
      }
      
      // Validar asunto
      if (!asunto.value) {
        showFieldError('contacto-asunto-error', 'Debes seleccionar un asunto');
        isValid = false;
      }
      
      // Validar mensaje
      if (!mensaje.value.trim()) {
        showFieldError('contacto-mensaje-error', 'El mensaje es requerido');
        isValid = false;
      } else if (mensaje.value.trim().length < 10) {
        showFieldError('contacto-mensaje-error', 'El mensaje debe tener al menos 10 caracteres');
        isValid = false;
      }
      
      // Validar CAPTCHA
      if (!validateContactoCaptcha()) {
        isValid = false;
      }
      
      return isValid;
    }

    function clearContactoErrors() {
      const errorElements = document.querySelectorAll('#form-contacto .error-message');
      errorElements.forEach(element => {
        element.textContent = '';
        element.style.display = 'none';
      });
    }

    function showContactoStatus(message, type = 'info') {
      const statusElement = document.getElementById('contacto-status');
      statusElement.textContent = message;
      statusElement.className = `contacto-status ${type}`;
      statusElement.style.display = 'block';
      announceToScreenReader(message);
    }

    function clearContactoStatus() {
      const statusElement = document.getElementById('contacto-status');
      statusElement.style.display = 'none';
      statusElement.textContent = '';
    }

    function setContactoButtonLoading(loading) {
      const button = document.getElementById('contacto-submit-btn');
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        button.querySelector('.btn-text').textContent = 'Enviando mensaje...';
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        button.querySelector('.btn-text').textContent = 'Enviar Mensaje';
      }
    }

    function showContactoCaptcha() {
      const captchaContainer = document.getElementById('contacto-captcha-container');
      const captchaText = document.getElementById('contacto-captcha-text');
      
      const captchaQuestions = [
        'Â¿CuÃ¡l es la capital de Ecuador?',
        'Â¿En quÃ© continente estÃ¡ Ecuador?',
        'Â¿CuÃ¡l es el color de la bandera de Ecuador?',
        'Â¿CuÃ¡l es la moneda de Ecuador?',
        'Â¿CuÃ¡l es el idioma oficial de Ecuador?'
      ];
      
      const captchaAnswers = [
        'quito',
        'america',
        'amarillo',
        'dolar',
        'espaÃ±ol'
      ];
      
      const randomIndex = Math.floor(Math.random() * captchaQuestions.length);
      captchaText.textContent = captchaQuestions[randomIndex];
      captchaText.setAttribute('data-answer', captchaAnswers[randomIndex]);
      
      captchaContainer.style.display = 'block';
      announceToScreenReader('Se requiere verificaciÃ³n de seguridad');
    }

    function validateContactoCaptcha() {
      const captchaAnswer = document.getElementById('contacto-captcha-answer');
      const captchaText = document.getElementById('contacto-captcha-text');
      
      if (!captchaAnswer.value.trim()) {
        showFieldError('contacto-captcha-help', 'Debes responder la pregunta de verificaciÃ³n');
        return false;
      }
      
      const userAnswer = captchaAnswer.value.toLowerCase().trim();
      const correctAnswer = captchaText.getAttribute('data-answer');
      
      if (userAnswer !== correctAnswer) {
        showFieldError('contacto-captcha-help', 'Respuesta incorrecta. Intenta nuevamente.');
        return false;
      }
      
      return true;
    }

    function updateMensajeCounter() {
      const mensaje = document.getElementById('contacto-mensaje');
      const counter = document.getElementById('mensaje-counter');
      const currentLength = mensaje.value.length;
      const maxLength = 1000;
      
      counter.textContent = currentLength;
      
      if (currentLength > maxLength * 0.9) {
        counter.style.color = '#f44336';
      } else if (currentLength > maxLength * 0.7) {
        counter.style.color = '#ff9800';
      } else {
        counter.style.color = '#666';
      }
    }

    function setupContactoRealTimeValidation() {
      // ValidaciÃ³n en tiempo real para nombre
      document.getElementById('contacto-nombre').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-nombre-error');
        if (this.value.trim().length >= 2) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El nombre debe tener al menos 2 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para email
      document.getElementById('contacto-email').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-email-error');
        if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'Ingresa un correo electrÃ³nico vÃ¡lido');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para telÃ©fono
      document.getElementById('contacto-telefono').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-telefono-error');
        if (this.value.trim() === '' || /^[0-9]{10}$/.test(this.value.trim())) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El telÃ©fono debe tener 10 dÃ­gitos');
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para asunto
      document.getElementById('contacto-asunto').addEventListener('change', function() {
        const errorElement = document.getElementById('contacto-asunto-error');
        if (this.value) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else {
          showFieldError(errorElement, 'Debes seleccionar un asunto');
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para mensaje
      document.getElementById('contacto-mensaje').addEventListener('input', function() {
        const errorElement = document.getElementById('contacto-mensaje-error');
        updateMensajeCounter();
        
        if (this.value.trim().length >= 10) {
          errorElement.style.display = 'none';
          this.classList.add('valid');
        } else if (this.value.trim().length > 0) {
          showFieldError(errorElement, 'El mensaje debe tener al menos 10 caracteres');
          this.classList.remove('valid');
        } else {
          errorElement.style.display = 'none';
          this.classList.remove('valid');
        }
      });
      
      // ValidaciÃ³n en tiempo real para CAPTCHA
      document.getElementById('contacto-captcha-answer').addEventListener('input', function() {
        const helpElement = document.getElementById('contacto-captcha-help');
        if (this.value.trim()) {
          helpElement.style.display = 'none';
          this.classList.add('valid');
        } else {
          this.classList.remove('valid');
        }
      });
    }

    function mostrarModalContacto() {
      mostrarModal('modal-contacto');
      showContactoCaptcha();
      setupContactoRealTimeValidation();
      announceToScreenReader('Formulario de contacto abierto');
    }

    // Formulario de contacto mejorado
    const formContacto = document.getElementById('form-contacto');
    if (formContacto) {
      formContacto.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Limpiar estado anterior
        clearContactoStatus();
        
        // Validar formulario
        if (!validateContactoForm()) {
          return;
        }
        
        // Obtener datos del formulario
        const formData = {
          nombre: document.getElementById('contacto-nombre').value.trim(),
          email: document.getElementById('contacto-email').value.trim(),
          telefono: document.getElementById('contacto-telefono').value.trim() || null,
          asunto: document.getElementById('contacto-asunto').value,
          mensaje: document.getElementById('contacto-mensaje').value.trim(),
          urgencia: document.querySelector('input[name="urgencia"]:checked').value,
          notificaciones: document.getElementById('contacto-notificaciones').checked
        };
        
        // Mostrar estado de carga
        setContactoButtonLoading(true);
        showContactoStatus('Enviando tu mensaje...', 'info');
        
        try {
          const startTime = Date.now();
          
          // Simular envÃ­o (en producciÃ³n serÃ­a una llamada real a la API)
          const res = await fetch(`${API_BASE_URL}/contacto`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          });
          
          const data = await res.json();
          const endTime = Date.now();
          const responseTime = endTime - startTime;
          
          // Verificar tiempo de respuesta
          if (responseTime > 10000) {
            showContactoStatus('La respuesta del servidor fue lenta. Intenta nuevamente.', 'error');
            setContactoButtonLoading(false);
            return;
          }
          
          if (res.ok) {
            // EnvÃ­o exitoso
            showContactoStatus('Â¡Mensaje enviado exitosamente! Te responderemos pronto.', 'success');
            announceToScreenReader('Mensaje enviado exitosamente');
            
            // Mostrar tiempo de respuesta estimado
            const urgencia = formData.urgencia;
            let tiempoRespuesta = '';
            switch (urgencia) {
              case 'alta':
                tiempoRespuesta = '2-6 horas';
                break;
              case 'media':
                tiempoRespuesta = '12-24 horas';
                break;
              default:
                tiempoRespuesta = '24-48 horas';
            }
            
            setTimeout(() => {
              showContactoStatus(`Gracias por contactarnos. Te responderemos en ${tiempoRespuesta}.`, 'info');
            }, 2000);
            
            // Cerrar modal despuÃ©s de un delay
            setTimeout(() => {
              cerrarModal('modal-contacto');
              showNotification('Mensaje enviado correctamente', 'success');
            }, 4000);
            
          } else {
            // EnvÃ­o fallido
            const errorMessage = data.mensaje || 'Error al enviar el mensaje. Intenta nuevamente.';
            showContactoStatus(errorMessage, 'error');
            announceToScreenReader('Error al enviar mensaje');
            setContactoButtonLoading(false);
          }
          
        } catch (error) {
          console.error('Error en contacto:', error);
          showContactoStatus('Error de conexiÃ³n. Verifica tu conexiÃ³n a internet e intenta nuevamente.', 'error');
          setContactoButtonLoading(false);
        }
              });
      }

    // Funciones de guardar registro
    function mostrarModalGuardar() {
      mostrarModal('modal-guardar-registro');
      announceToScreenReader('Formulario de guardar destino turÃ­stico abierto');
      inicializarFormularioGuardar();
    }

    function confirmarCerrarGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const hasData = Array.from(form.elements).some(element => 
        element.value && element.type !== 'submit' && element.type !== 'button'
      );
      
      if (hasData) {
        if (confirm('Â¿EstÃ¡s seguro de que quieres cerrar? Los datos no guardados se perderÃ¡n.')) {
          cerrarModalGuardar();
        }
      } else {
        cerrarModalGuardar();
      }
    }

    function cerrarModalGuardar() {
      cerrarModal('modal-guardar-registro');
      limpiarFormularioGuardar();
      announceToScreenReader('Formulario de guardar destino cerrado');
    }

    function inicializarFormularioGuardar() {
      // Configurar contador de caracteres
      const textarea = document.getElementById('destino-descripcion');
      const counter = document.getElementById('descripcion-counter');
      
      if (textarea && counter) {
        textarea.addEventListener('input', function() {
          counter.textContent = this.value.length;
          if (this.value.length > 900) {
            counter.style.color = '#dc3545';
          } else if (this.value.length > 800) {
            counter.style.color = '#ffc107';
          } else {
            counter.style.color = '#6c757d';
          }
        });
      }

      // Configurar validaciÃ³n en tiempo real
      configurarValidacionGuardar();
      
      // Cargar borrador si existe
      cargarBorrador();
    }

    function configurarValidacionGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const campos = form.querySelectorAll('input, select, textarea');
      
      campos.forEach(campo => {
        campo.addEventListener('blur', function() {
          validarCampoGuardar(this);
        });
        
        campo.addEventListener('input', function() {
          if (this.classList.contains('error')) {
            validarCampoGuardar(this);
          }
        });
      });
    }

    function validarCampoGuardar(campo) {
      const errorElement = document.getElementById(`${campo.id}-error`);
      let error = '';
      
      // Limpiar estado anterior
      campo.classList.remove('error');
      if (errorElement) {
        errorElement.textContent = '';
        errorElement.classList.remove('show');
      }
      
      // Validaciones especÃ­ficas
      if (campo.hasAttribute('required') && !campo.value.trim()) {
        error = 'Este campo es obligatorio';
      } else if (campo.type === 'email' && campo.value && !validarEmail(campo.value)) {
        error = 'Ingresa un email vÃ¡lido';
      } else if (campo.type === 'url' && campo.value && !validarURL(campo.value)) {
        error = 'Ingresa una URL vÃ¡lida';
      } else if (campo.type === 'tel' && campo.value && !validarTelefono(campo.value)) {
        error = 'Ingresa un telÃ©fono vÃ¡lido';
      } else if (campo.type === 'number') {
        const valor = parseFloat(campo.value);
        if (campo.value && (isNaN(valor) || valor < parseFloat(campo.min) || valor > parseFloat(campo.max))) {
          error = `El valor debe estar entre ${campo.min} y ${campo.max}`;
        }
      } else if (campo.type === 'textarea' && campo.value) {
        if (campo.value.length < parseInt(campo.minlength)) {
          error = `MÃ­nimo ${campo.minlength} caracteres`;
        } else if (campo.value.length > parseInt(campo.maxlength)) {
          error = `MÃ¡ximo ${campo.maxlength} caracteres`;
        }
      }
      
      // Mostrar error si existe
      if (error && errorElement) {
        errorElement.textContent = error;
        errorElement.classList.add('show');
        campo.classList.add('error');
        campo.style.borderColor = '#dc3545';
      } else if (campo.classList.contains('error')) {
        campo.style.borderColor = '';
      }
    }

    function validarEmail(email) {
      const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return regex.test(email);
    }

    function validarURL(url) {
      try {
        new URL(url);
        return true;
      } catch {
        return false;
      }
    }

    function validarTelefono(telefono) {
      const regex = /^[0-9\s\-\(\)]+$/;
      return regex.test(telefono) && telefono.length >= 7;
    }

    function guardarBorrador() {
      const form = document.getElementById('form-guardar-registro');
      const formData = new FormData(form);
      const datos = {};
      
      // Recopilar datos del formulario
      for (let [key, value] of formData.entries()) {
        if (key === 'caracteristicas') {
          if (!datos[key]) datos[key] = [];
          datos[key].push(value);
        } else {
          datos[key] = value;
        }
      }
      
      // Guardar en localStorage
      localStorage.setItem('borradorDestino', JSON.stringify(datos));
      
      // Mostrar confirmaciÃ³n
      mostrarEstadoGuardar('Borrador guardado exitosamente', 'success');
      announceToScreenReader('Borrador guardado exitosamente');
      
      // Auto-guardar cada 30 segundos
      setTimeout(guardarBorrador, 30000);
    }

    function cargarBorrador() {
      const borrador = localStorage.getItem('borradorDestino');
      if (borrador) {
        const datos = JSON.parse(borrador);
        const form = document.getElementById('form-guardar-registro');
        
        // Llenar campos con datos del borrador
        Object.keys(datos).forEach(key => {
          const campo = form.querySelector(`[name="${key}"]`);
          if (campo) {
            if (campo.type === 'checkbox') {
              campo.checked = datos[key].includes(campo.value);
            } else {
              campo.value = datos[key];
            }
          }
        });
        
        // Actualizar contador de caracteres
        const textarea = document.getElementById('destino-descripcion');
        const counter = document.getElementById('descripcion-counter');
        if (textarea && counter) {
          counter.textContent = textarea.value.length;
        }
        
        mostrarEstadoGuardar('Borrador cargado automÃ¡ticamente', 'info');
      }
    }

    function limpiarFormularioGuardar() {
      const form = document.getElementById('form-guardar-registro');
      form.reset();
      
      // Limpiar errores
      const errores = form.querySelectorAll('.error-message');
      errores.forEach(error => {
        error.textContent = '';
        error.classList.remove('show');
      });
      
      // Limpiar estados de campos
      const campos = form.querySelectorAll('input, select, textarea');
      campos.forEach(campo => {
        campo.classList.remove('error');
        campo.style.borderColor = '';
      });
      
      // Resetear contador
      const counter = document.getElementById('descripcion-counter');
      if (counter) counter.textContent = '0';
      
      // Limpiar estado
      mostrarEstadoGuardar('', '');
    }

    function mostrarEstadoGuardar(mensaje, tipo) {
      const statusElement = document.getElementById('guardar-status');
      if (statusElement) {
        statusElement.textContent = mensaje;
        statusElement.className = `guardar-status ${tipo}`;
        
        if (mensaje) {
          setTimeout(() => {
            statusElement.textContent = '';
            statusElement.className = 'guardar-status';
          }, 5000);
        }
      }
    }

    // Manejo del envÃ­o del formulario
    document.addEventListener('DOMContentLoaded', function() {
      const formGuardar = document.getElementById('form-guardar-registro');
      if (formGuardar) {
        formGuardar.addEventListener('submit', function(e) {
          e.preventDefault();
          enviarFormularioGuardar();
        });
      }
    });

    function enviarFormularioGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const submitBtn = document.getElementById('guardar-submit-btn');
      
      // Validar todo el formulario
      const campos = form.querySelectorAll('input, select, textarea');
      let hayErrores = false;
      
      campos.forEach(campo => {
        validarCampoGuardar(campo);
        if (campo.classList.contains('error')) {
          hayErrores = true;
        }
      });
      
      if (hayErrores) {
        mostrarEstadoGuardar('Por favor, corrige los errores antes de continuar', 'error');
        announceToScreenReader('Hay errores en el formulario que deben corregirse');
        return;
      }
      
      // Mostrar estado de carga
      submitBtn.classList.add('loading');
      submitBtn.disabled = true;
      mostrarEstadoGuardar('Guardando destino...', 'info');
      
      // Simular envÃ­o (aquÃ­ irÃ­a la llamada real al backend)
      setTimeout(() => {
        // Simular respuesta exitosa
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        
        mostrarEstadoGuardar('Â¡Destino guardado exitosamente!', 'success');
        announceToScreenReader('Destino turÃ­stico guardado exitosamente');
        
        // Limpiar borrador
        localStorage.removeItem('borradorDestino');
        
        // Cerrar modal despuÃ©s de 2 segundos
        setTimeout(() => {
          cerrarModalGuardar();
        }, 2000);
        
      }, 2000);
    }
    </script>

  <!-- Modal de Formulario de Contacto -->
  <div id="modal-contacto" class="modal oculto" role="dialog" aria-labelledby="modal-contacto-titulo" aria-hidden="true">
    <div class="modal-content contacto-modal">
      <span class="cerrar" onclick="cerrarModal('modal-contacto')" aria-label="Cerrar formulario de contacto">&times;</span>
      
      <div class="contacto-header">
        <div class="contacto-icon" aria-hidden="true">ğŸ“</div>
        <h2 id="modal-contacto-titulo">ContÃ¡ctanos</h2>
        <p class="contacto-subtitle">Estamos aquÃ­ para ayudarte con tu viaje a Ecuador</p>
      </div>
      
      <div class="contacto-instructions">
        <p>Completa el formulario a continuaciÃ³n y nos pondremos en contacto contigo en menos de 24 horas. Los campos marcados con <span class="required-mark">*</span> son obligatorios.</p>
      </div>
      
      <form id="form-contacto" role="form" aria-describedby="contacto-descripcion" novalidate>
        <p id="contacto-descripcion" class="sr-only">Formulario de contacto para consultas sobre turismo en Ecuador</p>
        
        <!-- InformaciÃ³n Personal -->
        <div class="form-section" aria-labelledby="info-personal-titulo">
          <h3 id="info-personal-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ‘¤</span>
            InformaciÃ³n Personal
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="contacto-nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ“›</span>
                Nombre Completo
              </label>
              <input 
                type="text" 
                id="contacto-nombre" 
                name="nombre" 
                placeholder="Ingresa tu nombre completo" 
                required 
                autocomplete="given-name"
                aria-describedby="contacto-nombre-error contacto-nombre-help"
                class="form-input"
                minlength="2"
                maxlength="50"
              />
              <div id="contacto-nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="contacto-nombre-help" class="help-text">Ingresa tu nombre y apellidos</div>
            </div>
            
            <div class="form-group">
              <label for="contacto-email" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ“§</span>
                Correo ElectrÃ³nico
              </label>
              <input 
                type="email" 
                id="contacto-email" 
                name="email" 
                placeholder="tu@email.com" 
                required 
                autocomplete="email"
                aria-describedby="contacto-email-error contacto-email-help"
                class="form-input"
              />
              <div id="contacto-email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="contacto-email-help" class="help-text">Usaremos este correo para responderte</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="contacto-telefono" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸ“±</span>
              TelÃ©fono (Opcional)
            </label>
            <input 
              type="tel" 
              id="contacto-telefono" 
              name="telefono" 
              placeholder="Ej: 0991234567" 
              autocomplete="tel"
              aria-describedby="contacto-telefono-error contacto-telefono-help"
              class="form-input"
              pattern="[0-9]{10}"
              maxlength="10"
            />
            <div id="contacto-telefono-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="contacto-telefono-help" class="help-text">Para contacto telefÃ³nico si lo prefieres</div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de la Consulta -->
        <div class="form-section" aria-labelledby="consulta-titulo">
          <h3 id="consulta-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">â“</span>
            InformaciÃ³n de la Consulta
          </h3>
          
          <div class="form-group">
            <label for="contacto-asunto" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ“‹</span>
              Asunto
            </label>
            <select 
              id="contacto-asunto" 
              name="asunto" 
              required 
              aria-describedby="contacto-asunto-error contacto-asunto-help"
              class="form-input"
            >
              <option value="">Selecciona un asunto</option>
              <option value="informacion-destinos">InformaciÃ³n sobre destinos</option>
              <option value="reservas-hoteles">Reservas de hoteles</option>
              <option value="paquetes-turisticos">Paquetes turÃ­sticos</option>
              <option value="transporte">InformaciÃ³n de transporte</option>
              <option value="actividades">Actividades y excursiones</option>
              <option value="documentacion">DocumentaciÃ³n y visas</option>
              <option value="clima">InformaciÃ³n del clima</option>
              <option value="seguridad">Seguridad y recomendaciones</option>
              <option value="accesibilidad">InformaciÃ³n de accesibilidad</option>
              <option value="otro">Otro</option>
            </select>
            <div id="contacto-asunto-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="contacto-asunto-help" class="help-text">Selecciona el tema principal de tu consulta</div>
          </div>
          
          <div class="form-group">
            <label for="contacto-mensaje" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ’¬</span>
              Mensaje
            </label>
            <textarea 
              id="contacto-mensaje" 
              name="mensaje" 
              placeholder="Describe tu consulta o solicitud aquÃ­..." 
              required 
              aria-describedby="contacto-mensaje-error contacto-mensaje-help"
              class="form-textarea"
              rows="6"
              minlength="10"
              maxlength="1000"
            ></textarea>
            <div class="textarea-counter">
              <span id="mensaje-counter">0</span> / 1000 caracteres
            </div>
            <div id="contacto-mensaje-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="contacto-mensaje-help" class="help-text">MÃ­nimo 10 caracteres. SÃ© especÃ­fico para una mejor respuesta</div>
          </div>
          
          <div class="form-group">
            <label for="contacto-urgencia" class="form-label">
              <span class="label-icon" aria-hidden="true">â°</span>
              Urgencia de la Consulta
            </label>
            <div class="radio-group">
              <label class="radio-wrapper">
                <input 
                  type="radio" 
                  name="urgencia" 
                  value="baja" 
                  checked
                  aria-describedby="urgencia-help"
                />
                <span class="radio-mark"></span>
                <span class="radio-text">Baja (Respuesta en 24-48 horas)</span>
              </label>
              <label class="radio-wrapper">
                <input 
                  type="radio" 
                  name="urgencia" 
                  value="media"
                  aria-describedby="urgencia-help"
                />
                <span class="radio-mark"></span>
                <span class="radio-text">Media (Respuesta en 12-24 horas)</span>
              </label>
              <label class="radio-wrapper">
                <input 
                  type="radio" 
                  name="urgencia" 
                  value="alta"
                  aria-describedby="urgencia-help"
                />
                <span class="radio-mark"></span>
                <span class="radio-text">Alta (Respuesta en 2-6 horas)</span>
              </label>
            </div>
            <div id="urgencia-help" class="help-text">Selecciona la urgencia de tu consulta</div>
          </div>
        </div>
        
        <!-- VerificaciÃ³n Anti-Spam -->
        <div class="form-section" aria-labelledby="verificacion-titulo">
          <h3 id="verificacion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ›¡ï¸</span>
            VerificaciÃ³n de Seguridad
          </h3>
          
          <div class="captcha-container" id="contacto-captcha-container">
            <div class="captcha-challenge">
              <span class="captcha-text" id="contacto-captcha-text">Â¿CuÃ¡l es la capital de Ecuador?</span>
              <input 
                type="text" 
                id="contacto-captcha-answer" 
                placeholder="Respuesta"
                class="form-input captcha-input"
                aria-describedby="contacto-captcha-help"
                required
              />
              <div id="contacto-captcha-help" class="help-text">Responde la pregunta para verificar que eres humano</div>
            </div>
          </div>
          
          <div class="form-options">
            <label class="checkbox-wrapper">
              <input 
                type="checkbox" 
                id="contacto-notificaciones" 
                name="notificaciones"
                aria-describedby="contacto-notificaciones-help"
              />
              <span class="checkmark"></span>
              <span class="checkbox-text">Deseo recibir notificaciones sobre ofertas turÃ­sticas</span>
            </label>
            <div id="contacto-notificaciones-help" class="help-text">Puedes cambiar esta opciÃ³n despuÃ©s</div>
          </div>
        </div>
        
        <!-- Botones de acciÃ³n -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-contacto-submit"
            aria-label="Enviar formulario de contacto"
            id="contacto-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">ğŸ“¤</span>
            <span class="btn-text">Enviar Mensaje</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-contacto-cancel"
            onclick="cerrarModal('modal-contacto')"
            aria-label="Cancelar envÃ­o de mensaje"
          >
            <span class="btn-icon" aria-hidden="true">âŒ</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="contacto-status" class="contacto-status" role="status" aria-live="polite"></div>
      </form>
      
      <!-- InformaciÃ³n adicional -->
      <div class="contacto-footer">
        <div class="contacto-info">
          <h4>InformaciÃ³n de Contacto Directo</h4>
          <div class="contacto-details">
            <p><span class="contact-icon" aria-hidden="true">ğŸ“§</span> Email: info@turismoecuador.com</p>
            <p><span class="contact-icon" aria-hidden="true">ğŸ“±</span> WhatsApp: +593 99 123 4567</p>
            <p><span class="contact-icon" aria-hidden="true">ğŸ•’</span> Horario: Lunes a Viernes 8:00 - 18:00</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Formulario de Guardar Registro -->
  <div id="modal-guardar-registro" class="modal oculto" role="dialog" aria-labelledby="modal-guardar-titulo" aria-hidden="true">
    <div class="modal-content guardar-modal">
      <span class="cerrar" onclick="confirmarCerrarGuardar()" aria-label="Cerrar formulario de guardar registro">&times;</span>
      
      <div class="guardar-header">
        <div class="guardar-icon" aria-hidden="true">ğŸ’¾</div>
        <h2 id="modal-guardar-titulo">Guardar Destino TurÃ­stico</h2>
        <p class="guardar-subtitle">Registra informaciÃ³n detallada de un nuevo destino</p>
      </div>
      
      <div class="guardar-instructions">
        <p>Completa la informaciÃ³n del destino turÃ­stico. Los campos marcados con <span class="required-mark">*</span> son obligatorios. Puedes guardar borradores y continuar despuÃ©s.</p>
      </div>
      
      <form id="form-guardar-registro" role="form" aria-describedby="guardar-descripcion" novalidate>
        <p id="guardar-descripcion" class="sr-only">Formulario para guardar informaciÃ³n de un nuevo destino turÃ­stico en Ecuador</p>
        
        <!-- InformaciÃ³n BÃ¡sica del Destino -->
        <div class="form-section" aria-labelledby="info-basica-titulo">
          <h3 id="info-basica-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“</span>
            InformaciÃ³n BÃ¡sica
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ·ï¸</span>
                Nombre del Destino
              </label>
              <input 
                type="text" 
                id="destino-nombre" 
                name="nombre" 
                placeholder="Ej: Centro HistÃ³rico de Cuenca" 
                required 
                autocomplete="off"
                aria-describedby="destino-nombre-error destino-nombre-help"
                class="form-input"
                maxlength="100"
              />
              <div id="destino-nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-nombre-help" class="help-text">Nombre oficial o popular del destino</div>
            </div>
            
            <div class="form-group">
              <label for="destino-tipo" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ›ï¸</span>
                Tipo de Destino
              </label>
              <select 
                id="destino-tipo" 
                name="tipo" 
                required 
                aria-describedby="destino-tipo-error destino-tipo-help"
                class="form-input"
              >
                <option value="">Selecciona el tipo</option>
                <option value="ciudad">Ciudad</option>
                <option value="playa">Playa</option>
                <option value="montaÃ±a">MontaÃ±a</option>
                <option value="selva">Selva</option>
                <option value="isla">Isla</option>
                <option value="parque">Parque Nacional</option>
                <option value="monumento">Monumento</option>
                <option value="museo">Museo</option>
                <option value="restaurante">Restaurante</option>
                <option value="hotel">Hotel</option>
                <option value="otro">Otro</option>
              </select>
              <div id="destino-tipo-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-tipo-help" class="help-text">CategorÃ­a principal del destino</div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-provincia" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ—ºï¸</span>
                Provincia
              </label>
              <select 
                id="destino-provincia" 
                name="provincia" 
                required 
                aria-describedby="destino-provincia-error destino-provincia-help"
                class="form-input"
              >
                <option value="">Selecciona la provincia</option>
                <option value="azuay">Azuay</option>
                <option value="bolivar">BolÃ­var</option>
                <option value="canar">CaÃ±ar</option>
                <option value="carchi">Carchi</option>
                <option value="chimborazo">Chimborazo</option>
                <option value="cotopaxi">Cotopaxi</option>
                <option value="el-oro">El Oro</option>
                <option value="esmeraldas">Esmeraldas</option>
                <option value="galapagos">GalÃ¡pagos</option>
                <option value="guayas">Guayas</option>
                <option value="imbabura">Imbabura</option>
                <option value="loja">Loja</option>
                <option value="los-rios">Los RÃ­os</option>
                <option value="manabi">ManabÃ­</option>
                <option value="morona-santiago">Morona Santiago</option>
                <option value="napo">Napo</option>
                <option value="orellana">Orellana</option>
                <option value="pastaza">Pastaza</option>
                <option value="pichincha">Pichincha</option>
                <option value="santa-elena">Santa Elena</option>
                <option value="santo-domingo">Santo Domingo</option>
                <option value="sucumbios">SucumbÃ­os</option>
                <option value="tungurahua">Tungurahua</option>
                <option value="zamora-chinchipe">Zamora Chinchipe</option>
              </select>
              <div id="destino-provincia-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-provincia-help" class="help-text">Provincia donde se encuentra el destino</div>
            </div>
            
            <div class="form-group">
              <label for="destino-ciudad" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ™ï¸</span>
                Ciudad (Opcional)
              </label>
              <input 
                type="text" 
                id="destino-ciudad" 
                name="ciudad" 
                placeholder="Ej: Cuenca, Guayaquil" 
                autocomplete="off"
                aria-describedby="destino-ciudad-error destino-ciudad-help"
                class="form-input"
                maxlength="50"
              />
              <div id="destino-ciudad-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-ciudad-help" class="help-text">Ciudad especÃ­fica si aplica</div>
            </div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de UbicaciÃ³n -->
        <div class="form-section" aria-labelledby="ubicacion-titulo">
          <h3 id="ubicacion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸŒ</span>
            UbicaciÃ³n y Coordenadas
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-latitud" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“¡</span>
                Latitud
              </label>
              <input 
                type="number" 
                id="destino-latitud" 
                name="latitud" 
                placeholder="Ej: -2.8968" 
                step="0.0001"
                min="-5"
                max="2"
                autocomplete="off"
                aria-describedby="destino-latitud-error destino-latitud-help"
                class="form-input"
              />
              <div id="destino-latitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-latitud-help" class="help-text">Coordenada de latitud (entre -5 y 2)</div>
            </div>
            
            <div class="form-group">
              <label for="destino-longitud" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“¡</span>
                Longitud
              </label>
              <input 
                type="number" 
                id="destino-longitud" 
                name="longitud" 
                placeholder="Ej: -79.0045" 
                step="0.0001"
                min="-82"
                max="-75"
                autocomplete="off"
                aria-describedby="destino-longitud-error destino-longitud-help"
                class="form-input"
              />
              <div id="destino-longitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-longitud-help" class="help-text">Coordenada de longitud (entre -82 y -75)</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="destino-direccion" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸ“</span>
              DirecciÃ³n
            </label>
            <input 
              type="text" 
              id="destino-direccion" 
              name="direccion" 
              placeholder="Ej: Calle Larga 10-77, Centro HistÃ³rico" 
              autocomplete="off"
              aria-describedby="destino-direccion-error destino-direccion-help"
              class="form-input"
              maxlength="200"
            />
            <div id="destino-direccion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="destino-direccion-help" class="help-text">DirecciÃ³n especÃ­fica del destino</div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de Contacto -->
        <div class="form-section" aria-labelledby="contacto-destino-titulo">
          <h3 id="contacto-destino-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“</span>
            InformaciÃ³n de Contacto
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-telefono" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“±</span>
                TelÃ©fono
              </label>
              <input 
                type="tel" 
                id="destino-telefono" 
                name="telefono" 
                placeholder="Ej: 07 2840 123" 
                autocomplete="tel"
                aria-describedby="destino-telefono-error destino-telefono-help"
                class="form-input"
                pattern="[0-9\s\-\(\)]+"
                maxlength="20"
              />
              <div id="destino-telefono-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-telefono-help" class="help-text">NÃºmero de telÃ©fono del destino</div>
            </div>
            
            <div class="form-group">
              <label for="destino-email" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“§</span>
                Email
              </label>
              <input 
                type="email" 
                id="destino-email" 
                name="email" 
                placeholder="Ej: info@destino.com" 
                autocomplete="email"
                aria-describedby="destino-email-error destino-email-help"
                class="form-input"
              />
              <div id="destino-email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-email-help" class="help-text">Correo electrÃ³nico de contacto</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="destino-web" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸŒ</span>
              Sitio Web
            </label>
            <input 
              type="url" 
              id="destino-web" 
              name="sitio_web" 
              placeholder="Ej: https://www.destino.com" 
              autocomplete="url"
              aria-describedby="destino-web-error destino-web-help"
              class="form-input"
            />
            <div id="destino-web-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="destino-web-help" class="help-text">URL del sitio web oficial</div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de Horarios y Precios -->
        <div class="form-section" aria-labelledby="horarios-precios-titulo">
          <h3 id="horarios-precios-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">â°</span>
            Horarios y Precios
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="destino-horario" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ•’</span>
                Horario de AtenciÃ³n
              </label>
              <input 
                type="text" 
                id="destino-horario" 
                name="horario" 
                placeholder="Ej: Lunes a Domingo 8:00 - 18:00" 
                autocomplete="off"
                aria-describedby="destino-horario-error destino-horario-help"
                class="form-input"
                maxlength="100"
              />
              <div id="destino-horario-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-horario-help" class="help-text">Horarios de apertura y cierre</div>
            </div>
            
            <div class="form-group">
              <label for="destino-precio" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ’°</span>
                Precio de Entrada
              </label>
              <input 
                type="text" 
                id="destino-precio" 
                name="precio" 
                placeholder="Ej: Gratis, $5, $10-20" 
                autocomplete="off"
                aria-describedby="destino-precio-error destino-precio-help"
                class="form-input"
                maxlength="50"
              />
              <div id="destino-precio-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="destino-precio-help" class="help-text">Costo de entrada o visita</div>
            </div>
          </div>
        </div>
        
        <!-- DescripciÃ³n y CaracterÃ­sticas -->
        <div class="form-section" aria-labelledby="descripcion-titulo">
          <h3 id="descripcion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“</span>
            DescripciÃ³n y CaracterÃ­sticas
          </h3>
          
          <div class="form-group">
            <label for="destino-descripcion" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ“„</span>
              DescripciÃ³n
            </label>
            <textarea 
              id="destino-descripcion" 
              name="descripcion" 
              placeholder="Describe el destino, sus atractivos principales, historia, etc..." 
              required 
              aria-describedby="destino-descripcion-error destino-descripcion-help"
              class="form-textarea"
              rows="4"
              minlength="20"
              maxlength="1000"
            ></textarea>
            <div class="textarea-counter">
              <span id="descripcion-counter">0</span> / 1000 caracteres
            </div>
            <div id="destino-descripcion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="destino-descripcion-help" class="help-text">DescripciÃ³n detallada del destino (mÃ­nimo 20 caracteres)</div>
          </div>
          
          <div class="form-group">
            <label for="destino-caracteristicas" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸ·ï¸</span>
              CaracterÃ­sticas Especiales
            </label>
            <div class="checkbox-group">
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="accesible" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Accesible para personas con discapacidad</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="familiar" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Apto para familias</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="aventura" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de aventura</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="cultural" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo cultural</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="naturaleza" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de naturaleza</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="gastronomico" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo gastronÃ³mico</span>
              </label>
            </div>
            <div class="help-text">Selecciona las caracterÃ­sticas que aplican al destino</div>
          </div>
        </div>
        
        <!-- Botones de acciÃ³n -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-guardar-submit"
            aria-label="Guardar destino turÃ­stico"
            id="guardar-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">ğŸ’¾</span>
            <span class="btn-text">Guardar Destino</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-guardar-borrador"
            onclick="guardarBorrador()"
            aria-label="Guardar como borrador"
          >
            <span class="btn-icon" aria-hidden="true">ğŸ“</span>
            <span class="btn-text">Guardar Borrador</span>
          </button>
          
          <button 
            type="button" 
            class="btn-guardar-cancel"
            onclick="confirmarCerrarGuardar()"
            aria-label="Cancelar guardado"
          >
            <span class="btn-icon" aria-hidden="true">âŒ</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="guardar-status" class="guardar-status" role="status" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- Modal de Formulario de Editar Registro -->
  <div id="modal-editar-registro" class="modal oculto" role="dialog" aria-labelledby="modal-editar-titulo" aria-hidden="true">
    <div class="modal-content editar-modal">
      <span class="cerrar" onclick="confirmarCerrarEditar()" aria-label="Cerrar formulario de editar registro">&times;</span>
      
      <div class="editar-header">
        <div class="editar-icon" aria-hidden="true">âœï¸</div>
        <h2 id="modal-editar-titulo">Editar Destino TurÃ­stico</h2>
        <p class="editar-subtitle">Modifica la informaciÃ³n del destino seleccionado</p>
      </div>
      
      <div class="editar-instructions">
        <p>Modifica los campos que necesites. Los campos marcados con <span class="required-mark">*</span> son obligatorios. Los cambios se resaltarÃ¡n automÃ¡ticamente.</p>
        <div class="editar-info">
          <span class="editar-id">ID: <span id="editar-destino-id">-</span></span>
          <span class="editar-fecha">Ãšltima modificaciÃ³n: <span id="editar-fecha-modificacion">-</span></span>
        </div>
      </div>
      
      <form id="form-editar-registro" role="form" aria-describedby="editar-descripcion" novalidate>
        <p id="editar-descripcion" class="sr-only">Formulario para editar informaciÃ³n de un destino turÃ­stico existente</p>
        
        <!-- InformaciÃ³n BÃ¡sica del Destino -->
        <div class="form-section" aria-labelledby="editar-info-basica-titulo">
          <h3 id="editar-info-basica-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“</span>
            InformaciÃ³n BÃ¡sica
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-nombre" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ·ï¸</span>
                Nombre del Destino
              </label>
              <input 
                type="text" 
                id="editar-destino-nombre" 
                name="nombre" 
                placeholder="Ej: Centro HistÃ³rico de Cuenca" 
                required 
                autocomplete="off"
                aria-describedby="editar-destino-nombre-error editar-destino-nombre-help"
                class="form-input"
                maxlength="100"
                data-original-value=""
              />
              <div id="editar-destino-nombre-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-nombre-help" class="help-text">Nombre oficial o popular del destino</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-tipo" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ›ï¸</span>
                Tipo de Destino
              </label>
              <select 
                id="editar-destino-tipo" 
                name="tipo" 
                required 
                aria-describedby="editar-destino-tipo-error editar-destino-tipo-help"
                class="form-input"
                data-original-value=""
              >
                <option value="">Selecciona el tipo</option>
                <option value="ciudad">Ciudad</option>
                <option value="playa">Playa</option>
                <option value="montaÃ±a">MontaÃ±a</option>
                <option value="selva">Selva</option>
                <option value="isla">Isla</option>
                <option value="parque">Parque Nacional</option>
                <option value="monumento">Monumento</option>
                <option value="museo">Museo</option>
                <option value="restaurante">Restaurante</option>
                <option value="hotel">Hotel</option>
                <option value="otro">Otro</option>
              </select>
              <div id="editar-destino-tipo-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-tipo-help" class="help-text">CategorÃ­a principal del destino</div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-provincia" class="form-label required">
                <span class="label-icon" aria-hidden="true">ğŸ—ºï¸</span>
                Provincia
              </label>
              <select 
                id="editar-destino-provincia" 
                name="provincia" 
                required 
                aria-describedby="editar-destino-provincia-error editar-destino-provincia-help"
                class="form-input"
                data-original-value=""
              >
                <option value="">Selecciona la provincia</option>
                <option value="azuay">Azuay</option>
                <option value="bolivar">BolÃ­var</option>
                <option value="canar">CaÃ±ar</option>
                <option value="carchi">Carchi</option>
                <option value="chimborazo">Chimborazo</option>
                <option value="cotopaxi">Cotopaxi</option>
                <option value="el-oro">El Oro</option>
                <option value="esmeraldas">Esmeraldas</option>
                <option value="galapagos">GalÃ¡pagos</option>
                <option value="guayas">Guayas</option>
                <option value="imbabura">Imbabura</option>
                <option value="loja">Loja</option>
                <option value="los-rios">Los RÃ­os</option>
                <option value="manabi">ManabÃ­</option>
                <option value="morona-santiago">Morona Santiago</option>
                <option value="napo">Napo</option>
                <option value="orellana">Orellana</option>
                <option value="pastaza">Pastaza</option>
                <option value="pichincha">Pichincha</option>
                <option value="santa-elena">Santa Elena</option>
                <option value="santo-domingo">Santo Domingo</option>
                <option value="sucumbios">SucumbÃ­os</option>
                <option value="tungurahua">Tungurahua</option>
                <option value="zamora-chinchipe">Zamora Chinchipe</option>
              </select>
              <div id="editar-destino-provincia-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-provincia-help" class="help-text">Provincia donde se encuentra el destino</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-ciudad" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ™ï¸</span>
                Ciudad (Opcional)
              </label>
              <input 
                type="text" 
                id="editar-destino-ciudad" 
                name="ciudad" 
                placeholder="Ej: Cuenca, Guayaquil" 
                autocomplete="off"
                aria-describedby="editar-destino-ciudad-error editar-destino-ciudad-help"
                class="form-input"
                maxlength="50"
                data-original-value=""
              />
              <div id="editar-destino-ciudad-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-ciudad-help" class="help-text">Ciudad especÃ­fica si aplica</div>
            </div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de UbicaciÃ³n -->
        <div class="form-section" aria-labelledby="editar-ubicacion-titulo">
          <h3 id="editar-ubicacion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸŒ</span>
            UbicaciÃ³n y Coordenadas
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-latitud" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“¡</span>
                Latitud
              </label>
              <input 
                type="number" 
                id="editar-destino-latitud" 
                name="latitud" 
                placeholder="Ej: -2.8968" 
                step="0.0001"
                min="-5"
                max="2"
                autocomplete="off"
                aria-describedby="editar-destino-latitud-error editar-destino-latitud-help"
                class="form-input"
                data-original-value=""
              />
              <div id="editar-destino-latitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-latitud-help" class="help-text">Coordenada de latitud (entre -5 y 2)</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-longitud" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“¡</span>
                Longitud
              </label>
              <input 
                type="number" 
                id="editar-destino-longitud" 
                name="longitud" 
                placeholder="Ej: -79.0045" 
                step="0.0001"
                min="-82"
                max="-75"
                autocomplete="off"
                aria-describedby="editar-destino-longitud-error editar-destino-longitud-help"
                class="form-input"
                data-original-value=""
              />
              <div id="editar-destino-longitud-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-longitud-help" class="help-text">Coordenada de longitud (entre -82 y -75)</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="editar-destino-direccion" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸ“</span>
              DirecciÃ³n
            </label>
            <input 
              type="text" 
              id="editar-destino-direccion" 
              name="direccion" 
              placeholder="Ej: Calle Larga 10-77, Centro HistÃ³rico" 
              autocomplete="off"
              aria-describedby="editar-destino-direccion-error editar-destino-direccion-help"
              class="form-input"
              maxlength="200"
              data-original-value=""
            />
            <div id="editar-destino-direccion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="editar-destino-direccion-help" class="help-text">DirecciÃ³n especÃ­fica del destino</div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de Contacto -->
        <div class="form-section" aria-labelledby="editar-contacto-destino-titulo">
          <h3 id="editar-contacto-destino-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“</span>
            InformaciÃ³n de Contacto
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-telefono" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“±</span>
                TelÃ©fono
              </label>
              <input 
                type="tel" 
                id="editar-destino-telefono" 
                name="telefono" 
                placeholder="Ej: 07 2840 123" 
                autocomplete="tel"
                aria-describedby="editar-destino-telefono-error editar-destino-telefono-help"
                class="form-input"
                pattern="[0-9\s\-\(\)]+"
                maxlength="20"
                data-original-value=""
              />
              <div id="editar-destino-telefono-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-telefono-help" class="help-text">NÃºmero de telÃ©fono del destino</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-email" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“§</span>
                Email
              </label>
              <input 
                type="email" 
                id="editar-destino-email" 
                name="email" 
                placeholder="Ej: info@destino.com" 
                autocomplete="email"
                aria-describedby="editar-destino-email-error editar-destino-email-help"
                class="form-input"
                data-original-value=""
              />
              <div id="editar-destino-email-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-email-help" class="help-text">Correo electrÃ³nico de contacto</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="editar-destino-web" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸŒ</span>
              Sitio Web
            </label>
            <input 
              type="url" 
              id="editar-destino-web" 
              name="sitio_web" 
              placeholder="Ej: https://www.destino.com" 
              autocomplete="url"
              aria-describedby="editar-destino-web-error editar-destino-web-help"
              class="form-input"
              data-original-value=""
            />
            <div id="editar-destino-web-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="editar-destino-web-help" class="help-text">URL del sitio web oficial</div>
          </div>
        </div>
        
        <!-- InformaciÃ³n de Horarios y Precios -->
        <div class="form-section" aria-labelledby="editar-horarios-precios-titulo">
          <h3 id="editar-horarios-precios-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">â°</span>
            Horarios y Precios
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="editar-destino-horario" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ•’</span>
                Horario de AtenciÃ³n
              </label>
              <input 
                type="text" 
                id="editar-destino-horario" 
                name="horario" 
                placeholder="Ej: Lunes a Domingo 8:00 - 18:00" 
                autocomplete="off"
                aria-describedby="editar-destino-horario-error editar-destino-horario-help"
                class="form-input"
                maxlength="100"
                data-original-value=""
              />
              <div id="editar-destino-horario-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-horario-help" class="help-text">Horarios de apertura y cierre</div>
            </div>
            
            <div class="form-group">
              <label for="editar-destino-precio" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ’°</span>
                Precio de Entrada
              </label>
              <input 
                type="text" 
                id="editar-destino-precio" 
                name="precio" 
                placeholder="Ej: Gratis, $5, $10-20" 
                autocomplete="off"
                aria-describedby="editar-destino-precio-error editar-destino-precio-help"
                class="form-input"
                maxlength="50"
                data-original-value=""
              />
              <div id="editar-destino-precio-error" class="error-message" role="alert" aria-live="polite"></div>
              <div id="editar-destino-precio-help" class="help-text">Costo de entrada o visita</div>
            </div>
          </div>
        </div>
        
        <!-- DescripciÃ³n y CaracterÃ­sticas -->
        <div class="form-section" aria-labelledby="editar-descripcion-titulo">
          <h3 id="editar-descripcion-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“</span>
            DescripciÃ³n y CaracterÃ­sticas
          </h3>
          
          <div class="form-group">
            <label for="editar-destino-descripcion" class="form-label required">
              <span class="label-icon" aria-hidden="true">ğŸ“„</span>
              DescripciÃ³n
            </label>
            <textarea 
              id="editar-destino-descripcion" 
              name="descripcion" 
              placeholder="Describe el destino, sus atractivos principales, historia, etc..." 
              required 
              aria-describedby="editar-destino-descripcion-error editar-destino-descripcion-help"
              class="form-textarea"
              rows="4"
              minlength="20"
              maxlength="1000"
              data-original-value=""
            ></textarea>
            <div class="textarea-counter">
              <span id="editar-descripcion-counter">0</span> / 1000 caracteres
            </div>
            <div id="editar-destino-descripcion-error" class="error-message" role="alert" aria-live="polite"></div>
            <div id="editar-destino-descripcion-help" class="help-text">DescripciÃ³n detallada del destino (mÃ­nimo 20 caracteres)</div>
          </div>
          
          <div class="form-group">
            <label for="editar-destino-caracteristicas" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸ·ï¸</span>
              CaracterÃ­sticas Especiales
            </label>
            <div class="checkbox-group">
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="accesible" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Accesible para personas con discapacidad</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="familiar" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Apto para familias</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="aventura" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de aventura</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="cultural" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo cultural</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="naturaleza" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo de naturaleza</span>
              </label>
              <label class="checkbox-wrapper">
                <input type="checkbox" name="caracteristicas" value="gastronomico" data-original-value="false" />
                <span class="checkmark"></span>
                <span class="checkbox-text">Turismo gastronÃ³mico</span>
              </label>
            </div>
            <div class="help-text">Selecciona las caracterÃ­sticas que aplican al destino</div>
          </div>
        </div>
        
        <!-- Historial de Cambios -->
        <div class="form-section" aria-labelledby="historial-titulo">
          <h3 id="historial-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“‹</span>
            Historial de Cambios
          </h3>
          <div class="historial-container">
            <div class="historial-item">
              <span class="historial-fecha">2024-01-15 14:30</span>
              <span class="historial-usuario">admin@turismo.com</span>
              <span class="historial-accion">ActualizÃ³ informaciÃ³n de contacto</span>
            </div>
            <div class="historial-item">
              <span class="historial-fecha">2024-01-10 09:15</span>
              <span class="historial-usuario">editor@turismo.com</span>
              <span class="historial-accion">ModificÃ³ horarios de atenciÃ³n</span>
            </div>
          </div>
        </div>
        
        <!-- Botones de acciÃ³n -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-editar-submit"
            aria-label="Actualizar destino turÃ­stico"
            id="editar-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">ğŸ’¾</span>
            <span class="btn-text">Actualizar Destino</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-editar-cancel"
            onclick="confirmarCerrarEditar()"
            aria-label="Cancelar ediciÃ³n"
          >
            <span class="btn-icon" aria-hidden="true">âŒ</span>
            <span class="btn-text">Cancelar</span>
          </button>
          
          <button 
            type="button" 
            class="btn-editar-restaurar"
            onclick="restaurarDatosOriginales()"
            aria-label="Restaurar datos originales"
            id="btn-restaurar"
            style="display: none;"
          >
            <span class="btn-icon" aria-hidden="true">â†º</span>
            <span class="btn-text">Restaurar Original</span>
          </button>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="editar-status" class="editar-status" role="status" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- Modal de BÃºsqueda con Filtros -->
  <div id="modal-busqueda-filtros" class="modal oculto" role="dialog" aria-labelledby="modal-busqueda-titulo" aria-hidden="true">
    <div class="modal-content busqueda-modal">
      <span class="cerrar" onclick="cerrarModal('modal-busqueda-filtros')" aria-label="Cerrar bÃºsqueda con filtros">&times;</span>
      
      <div class="busqueda-header">
        <div class="busqueda-icon" aria-hidden="true">ğŸ”</div>
        <h2 id="modal-busqueda-titulo">BÃºsqueda Avanzada</h2>
        <p class="busqueda-subtitle">Encuentra destinos turÃ­sticos con filtros especÃ­ficos</p>
      </div>
      
      <form id="form-busqueda-filtros" role="form" aria-describedby="busqueda-descripcion">
        <p id="busqueda-descripcion" class="sr-only">Formulario de bÃºsqueda avanzada con mÃºltiples filtros</p>
        
        <!-- Filtros BÃ¡sicos -->
        <div class="form-section" aria-labelledby="filtros-basicos-titulo">
          <h3 id="filtros-basicos-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ¯</span>
            Filtros BÃ¡sicos
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-nombre" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ·ï¸</span>
                Nombre del Destino
              </label>
              <input 
                type="text" 
                id="busqueda-nombre" 
                name="nombre" 
                placeholder="Buscar por nombre..." 
                autocomplete="off"
                class="form-input"
                list="sugerencias-nombres"
              />
              <datalist id="sugerencias-nombres">
                <option value="Centro HistÃ³rico de Cuenca">
                <option value="Playa de Salinas">
                <option value="BaÃ±os de Agua Santa">
                <option value="Islas GalÃ¡pagos">
              </datalist>
            </div>
            
            <div class="form-group">
              <label for="busqueda-tipo" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ›ï¸</span>
                Tipo de Destino
              </label>
              <select id="busqueda-tipo" name="tipo" class="form-input">
                <option value="">Todos los tipos</option>
                <option value="ciudad">Ciudad</option>
                <option value="playa">Playa</option>
                <option value="montaÃ±a">MontaÃ±a</option>
                <option value="selva">Selva</option>
                <option value="isla">Isla</option>
                <option value="parque">Parque Nacional</option>
                <option value="monumento">Monumento</option>
                <option value="museo">Museo</option>
                <option value="restaurante">Restaurante</option>
                <option value="hotel">Hotel</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-provincia" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ—ºï¸</span>
                Provincia
              </label>
              <select id="busqueda-provincia" name="provincia" class="form-input">
                <option value="">Todas las provincias</option>
                <option value="azuay">Azuay</option>
                <option value="guayas">Guayas</option>
                <option value="pichincha">Pichincha</option>
                <option value="manabi">ManabÃ­</option>
                <option value="galapagos">GalÃ¡pagos</option>
                <option value="tungurahua">Tungurahua</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="busqueda-ciudad" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ™ï¸</span>
                Ciudad
              </label>
              <input 
                type="text" 
                id="busqueda-ciudad" 
                name="ciudad" 
                placeholder="Buscar por ciudad..." 
                autocomplete="off"
                class="form-input"
              />
            </div>
          </div>
        </div>
        
        <!-- Filtros de CaracterÃ­sticas -->
        <div class="form-section" aria-labelledby="filtros-caracteristicas-titulo">
          <h3 id="filtros-caracteristicas-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ·ï¸</span>
            CaracterÃ­sticas Especiales
          </h3>
          
          <div class="checkbox-group">
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="accesible" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Accesible para personas con discapacidad</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="familiar" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Apto para familias</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="aventura" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo de aventura</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="cultural" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo cultural</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="naturaleza" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo de naturaleza</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" name="caracteristicas" value="gastronomico" />
              <span class="checkmark"></span>
              <span class="checkbox-text">Turismo gastronÃ³mico</span>
            </label>
          </div>
        </div>
        
        <!-- Filtros de Precio -->
        <div class="form-section" aria-labelledby="filtros-precio-titulo">
          <h3 id="filtros-precio-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ’°</span>
            Rango de Precio
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-precio-min" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“‰</span>
                Precio MÃ­nimo
              </label>
              <input 
                type="number" 
                id="busqueda-precio-min" 
                name="precio_min" 
                placeholder="0" 
                min="0"
                class="form-input"
              />
            </div>
            
            <div class="form-group">
              <label for="busqueda-precio-max" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“ˆ</span>
                Precio MÃ¡ximo
              </label>
              <input 
                type="number" 
                id="busqueda-precio-max" 
                name="precio_max" 
                placeholder="100" 
                min="0"
                class="form-input"
              />
            </div>
          </div>
          
          <div class="form-group">
            <label for="busqueda-gratis" class="form-label">
              <span class="label-icon" aria-hidden="true">ğŸ«</span>
              Incluir Gratuitos
            </label>
            <div class="radio-group">
              <label class="radio-wrapper">
                <input type="radio" name="incluir_gratis" value="si" checked />
                <span class="radio-mark"></span>
                <span class="radio-text">SÃ­, incluir destinos gratuitos</span>
              </label>
              <label class="radio-wrapper">
                <input type="radio" name="incluir_gratis" value="no" />
                <span class="radio-mark"></span>
                <span class="radio-text">No, solo destinos con costo</span>
              </label>
            </div>
          </div>
        </div>
        
        <!-- Filtros de Ordenamiento -->
        <div class="form-section" aria-labelledby="filtros-orden-titulo">
          <h3 id="filtros-orden-titulo" class="section-title">
            <span class="section-icon" aria-hidden="true">ğŸ“Š</span>
            Ordenar Por
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="busqueda-orden" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ”„</span>
                Criterio de Orden
              </label>
              <select id="busqueda-orden" name="orden" class="form-input">
                <option value="nombre">Nombre (A-Z)</option>
                <option value="nombre_desc">Nombre (Z-A)</option>
                <option value="precio">Precio (Menor a Mayor)</option>
                <option value="precio_desc">Precio (Mayor a Menor)</option>
                <option value="popularidad">Popularidad</option>
                <option value="fecha">Fecha de Registro</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="busqueda-limit" class="form-label">
                <span class="label-icon" aria-hidden="true">ğŸ“„</span>
                Resultados por PÃ¡gina
              </label>
              <select id="busqueda-limit" name="limit" class="form-input">
                <option value="10">10 resultados</option>
                <option value="20" selected>20 resultados</option>
                <option value="50">50 resultados</option>
                <option value="100">100 resultados</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- Botones de acciÃ³n -->
        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-busqueda-submit"
            aria-label="Aplicar filtros de bÃºsqueda"
            id="busqueda-submit-btn"
          >
            <span class="btn-icon" aria-hidden="true">ğŸ”</span>
            <span class="btn-text">Buscar Destinos</span>
            <div class="btn-loading" aria-hidden="true"></div>
          </button>
          
          <button 
            type="button" 
            class="btn-busqueda-limpiar"
            onclick="limpiarFiltrosBusqueda()"
            aria-label="Limpiar todos los filtros"
          >
            <span class="btn-icon" aria-hidden="true">ğŸ§¹</span>
            <span class="btn-text">Limpiar Filtros</span>
          </button>
          
          <button 
            type="button" 
            class="btn-busqueda-guardar"
            onclick="guardarFiltrosFrecuentes()"
            aria-label="Guardar filtros como favoritos"
          >
            <span class="btn-icon" aria-hidden="true">â­</span>
            <span class="btn-text">Guardar Filtros</span>
          </button>
          
          <button 
            type="button" 
            class="btn-busqueda-cancel"
            onclick="cerrarModal('modal-busqueda-filtros')"
            aria-label="Cancelar bÃºsqueda"
          >
            <span class="btn-icon" aria-hidden="true">âŒ</span>
            <span class="btn-text">Cancelar</span>
          </button>
        </div>
        
        <!-- Resultados de bÃºsqueda -->
        <div class="busqueda-resultados" id="busqueda-resultados">
          <div class="resultados-header">
            <h4>Resultados de BÃºsqueda</h4>
            <span class="resultados-contador" id="resultados-contador">0 destinos encontrados</span>
          </div>
          <div class="resultados-lista" id="resultados-lista">
            <!-- Los resultados se cargarÃ¡n dinÃ¡micamente aquÃ­ -->
          </div>
        </div>
        
        <!-- Mensaje de estado -->
        <div id="busqueda-status" class="busqueda-status" role="status" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- Modal de Eliminar Registro -->
  <div id="modal-eliminar-registro" class="modal oculto" role="dialog" aria-labelledby="modal-eliminar-titulo" aria-hidden="true">
    <div class="modal-content eliminar-modal">
      <span class="cerrar" onclick="cerrarModal('modal-eliminar-registro')" aria-label="Cerrar confirmaciÃ³n de eliminaciÃ³n">&times;</span>
      
      <div class="eliminar-header">
        <div class="eliminar-icon" aria-hidden="true">ğŸ—‘ï¸</div>
        <h2 id="modal-eliminar-titulo">Confirmar EliminaciÃ³n</h2>
        <p class="eliminar-subtitle">Esta acciÃ³n no se puede deshacer</p>
      </div>
      
      <div class="eliminar-content">
        <div class="eliminar-info">
          <h3>Â¿EstÃ¡s seguro de que quieres eliminar este destino?</h3>
          <div class="destino-a-eliminar">
            <div class="destino-detalle">
              <span class="destino-id">ID: <span id="eliminar-destino-id">-</span></span>
              <span class="destino-nombre">Nombre: <span id="eliminar-destino-nombre">-</span></span>
              <span class="destino-tipo">Tipo: <span id="eliminar-destino-tipo">-</span></span>
              <span class="destino-provincia">Provincia: <span id="eliminar-destino-provincia">-</span></span>
            </div>
            <div class="destino-descripcion">
              <p id="eliminar-destino-descripcion">-</p>
            </div>
          </div>
        </div>
        
        <div class="eliminar-advertencia">
          <div class="advertencia-icon" aria-hidden="true">âš ï¸</div>
          <div class="advertencia-text">
            <h4>Advertencia Importante</h4>
            <ul>
              <li>Esta acciÃ³n eliminarÃ¡ permanentemente el destino del sistema</li>
              <li>No se podrÃ¡ recuperar la informaciÃ³n eliminada</li>
              <li>Si el destino tiene reservas activas, no se podrÃ¡ eliminar</li>
              <li>Se registrarÃ¡ esta acciÃ³n en el historial de auditorÃ­a</li>
            </ul>
          </div>
        </div>
        
        <div class="eliminar-opciones">
          <label class="checkbox-wrapper">
            <input type="checkbox" id="eliminar-confirmar" required />
            <span class="checkmark"></span>
            <span class="checkbox-text">He leÃ­do y entiendo las consecuencias de esta acciÃ³n</span>
          </label>
          
          <label class="checkbox-wrapper">
            <input type="checkbox" id="eliminar-backup" />
            <span class="checkmark"></span>
            <span class="checkbox-text">Crear respaldo antes de eliminar (recomendado)</span>
          </label>
        </div>
      </div>
      
      <!-- Botones de acciÃ³n -->
      <div class="form-actions">
        <button 
          type="button" 
          class="btn-eliminar-confirmar"
          onclick="confirmarEliminacion()"
          aria-label="Confirmar eliminaciÃ³n del destino"
          id="eliminar-confirmar-btn"
          disabled
        >
          <span class="btn-icon" aria-hidden="true">ğŸ—‘ï¸</span>
          <span class="btn-text">Eliminar Destino</span>
          <div class="btn-loading" aria-hidden="true"></div>
        </button>
        
        <button 
          type="button" 
          class="btn-eliminar-cancel"
          onclick="cerrarModal('modal-eliminar-registro')"
          aria-label="Cancelar eliminaciÃ³n"
        >
          <span class="btn-icon" aria-hidden="true">âŒ</span>
          <span class="btn-text">Cancelar</span>
        </button>
        
        <button 
          type="button" 
          class="btn-eliminar-desactivar"
          onclick="desactivarDestino()"
          aria-label="Desactivar destino en lugar de eliminar"
        >
          <span class="btn-icon" aria-hidden="true">ğŸš«</span>
          <span class="btn-text">Desactivar (Recomendado)</span>
        </button>
      </div>
      
      <!-- Mensaje de estado -->
      <div id="eliminar-status" class="eliminar-status" role="status" aria-live="polite"></div>
    </div>
  </div>

  <script>
    // ===== FUNCIONES PARA FORMULARIO DE GUARDAR REGISTRO =====
    
    // FunciÃ³n para manejar el formulario de guardar registro
    function manejarFormularioGuardar(event) {
      event.preventDefault();
      
      // Mostrar estado de carga
      const submitBtn = document.getElementById('guardar-submit-btn');
      const statusDiv = document.getElementById('guardar-status');
      
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Guardando destino turÃ­stico...';
      statusDiv.className = 'guardar-status info';
      
      // Simular envÃ­o (en una aplicaciÃ³n real, aquÃ­ se enviarÃ­a al servidor)
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        statusDiv.textContent = 'Â¡Destino turÃ­stico guardado exitosamente!';
        statusDiv.className = 'guardar-status success';
        
        // Limpiar formulario despuÃ©s de 2 segundos
        setTimeout(() => {
          limpiarFormularioGuardar();
          cerrarModal('modal-guardar-registro');
        }, 2000);
      }, 2000);
    }
    
    // FunciÃ³n para limpiar el formulario de guardar
    function limpiarFormularioGuardar() {
      document.getElementById('form-guardar-registro').reset();
      document.getElementById('guardar-status').textContent = '';
      document.getElementById('guardar-status').className = 'guardar-status';
      
      // Limpiar contador de caracteres
      document.getElementById('descripcion-counter').textContent = '0';
      
      // Limpiar mensajes de error
      const errorMessages = document.querySelectorAll('#form-guardar-registro .error-message');
      errorMessages.forEach(error => error.textContent = '');
      
      // Limpiar clases de error
      const inputs = document.querySelectorAll('#form-guardar-registro .form-input, #form-guardar-registro .form-textarea');
      inputs.forEach(input => input.classList.remove('error'));
    }
    
    // FunciÃ³n para validar en tiempo real
    function validarCampoGuardar(input) {
      const value = input.value.trim();
      const errorElement = document.getElementById(input.id + '-error');
      let isValid = true;
      let errorMessage = '';
      
      // Validaciones especÃ­ficas por tipo de campo
      switch(input.name) {
        case 'nombre':
          if (!value) {
            errorMessage = 'El nombre del destino es obligatorio';
            isValid = false;
          } else if (value.length < 3) {
            errorMessage = 'El nombre debe tener al menos 3 caracteres';
            isValid = false;
          }
          break;
          
        case 'tipo':
          if (!value) {
            errorMessage = 'Debe seleccionar un tipo de destino';
            isValid = false;
          }
          break;
          
        case 'provincia':
          if (!value) {
            errorMessage = 'Debe seleccionar una provincia';
            isValid = false;
          }
          break;
          
        case 'descripcion':
          if (!value) {
            errorMessage = 'La descripciÃ³n es obligatoria';
            isValid = false;
          } else if (value.length < 20) {
            errorMessage = 'La descripciÃ³n debe tener al menos 20 caracteres';
            isValid = false;
          }
          break;
          
        case 'email':
          if (value && !isValidEmail(value)) {
            errorMessage = 'Ingrese un email vÃ¡lido';
            isValid = false;
          }
          break;
          
        case 'sitio_web':
          if (value && !isValidUrl(value)) {
            errorMessage = 'Ingrese una URL vÃ¡lida';
            isValid = false;
          }
          break;
          
        case 'latitud':
          if (value && (isNaN(value) || value < -5 || value > 2)) {
            errorMessage = 'La latitud debe estar entre -5 y 2';
            isValid = false;
          }
          break;
          
        case 'longitud':
          if (value && (isNaN(value) || value < -82 || value > -75)) {
            errorMessage = 'La longitud debe estar entre -82 y -75';
            isValid = false;
          }
          break;
      }
      
      // Mostrar/ocultar error
      if (isValid) {
        input.classList.remove('error');
        errorElement.textContent = '';
      } else {
        input.classList.add('error');
        errorElement.textContent = errorMessage;
      }
      
      return isValid;
    }
    
    // FunciÃ³n para validar email
    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }
    
    // FunciÃ³n para validar URL
    function isValidUrl(url) {
      try {
        new URL(url);
        return true;
      } catch {
        return false;
      }
    }
    
    // FunciÃ³n para actualizar contador de caracteres
    function actualizarContadorGuardar() {
      const textarea = document.getElementById('destino-descripcion');
      const counter = document.getElementById('descripcion-counter');
      const length = textarea.value.length;
      counter.textContent = length;
      
      if (length > 900) {
        counter.style.color = '#dc3545';
      } else if (length > 800) {
        counter.style.color = '#ffc107';
      } else {
        counter.style.color = '#6c757d';
      }
    }
    
    // FunciÃ³n para guardar borrador
    function guardarBorradorGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const formData = new FormData(form);
      const data = {};
      
      formData.forEach((value, key) => {
        data[key] = value;
      });
      
      // Guardar en localStorage
      localStorage.setItem('borradorDestino', JSON.stringify(data));
      
      // Mostrar confirmaciÃ³n
      const statusDiv = document.getElementById('guardar-status');
      statusDiv.textContent = 'Borrador guardado automÃ¡ticamente';
      statusDiv.className = 'guardar-status info';
      
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = 'guardar-status';
      }, 2000);
    }
    
    // FunciÃ³n para cargar borrador
    function cargarBorradorGuardar() {
      const borrador = localStorage.getItem('borradorDestino');
      if (borrador) {
        const data = JSON.parse(borrador);
        const form = document.getElementById('form-guardar-registro');
        
        // Llenar campos
        Object.keys(data).forEach(key => {
          const input = form.querySelector(`[name="${key}"]`);
          if (input) {
            if (input.type === 'checkbox') {
              input.checked = data[key] === 'on';
            } else {
              input.value = data[key];
            }
          }
        });
        
        // Actualizar contador
        actualizarContadorGuardar();
        
        // Mostrar confirmaciÃ³n
        const statusDiv = document.getElementById('guardar-status');
        statusDiv.textContent = 'Borrador cargado automÃ¡ticamente';
        statusDiv.className = 'guardar-status info';
        
        setTimeout(() => {
          statusDiv.textContent = '';
          statusDiv.className = 'guardar-status';
        }, 2000);
      }
    }
    
    // FunciÃ³n para confirmar antes de cerrar
    function confirmarCerrarGuardar() {
      const form = document.getElementById('form-guardar-registro');
      const hasData = Array.from(form.elements).some(element => {
        if (element.type === 'checkbox') {
          return element.checked;
        }
        return element.value && element.value.trim() !== '';
      });
      
      if (hasData) {
        if (confirm('Â¿EstÃ¡s seguro de que quieres cerrar? Los datos no guardados se perderÃ¡n.')) {
          cerrarModal('modal-guardar-registro');
        }
      } else {
        cerrarModal('modal-guardar-registro');
      }
    }
    
    // ===== FUNCIONES PARA FORMULARIO DE EDITAR REGISTRO =====
    
    // FunciÃ³n para abrir modal de editar
    function abrirModalEditar(destinoId) {
      // Simular carga de datos del destino
      const destino = {
        id: destinoId,
        nombre: 'Centro HistÃ³rico de Cuenca',
        tipo: 'ciudad',
        provincia: 'azuay',
        ciudad: 'Cuenca',
        latitud: -2.8968,
        longitud: -79.0045,
        direccion: 'Calle Larga 10-77, Centro HistÃ³rico',
        telefono: '07 2840 123',
        email: 'info@cuenca.com',
        sitio_web: 'https://www.cuenca.com',
        horario: 'Lunes a Domingo 8:00 - 18:00',
        precio: 'Gratis',
        descripcion: 'El Centro HistÃ³rico de Cuenca es uno de los mÃ¡s hermosos de AmÃ©rica Latina, declarado Patrimonio Cultural de la Humanidad por la UNESCO en 1999. Sus calles empedradas, iglesias coloniales y plazas histÃ³ricas transportan a los visitantes a la Ã©poca colonial.',
        caracteristicas: ['cultural', 'accesible', 'familiar'],
        fecha_modificacion: '2024-01-15 14:30'
      };
      
      // Llenar formulario con datos
      document.getElementById('editar-destino-id').textContent = destino.id;
      document.getElementById('editar-fecha-modificacion').textContent = destino.fecha_modificacion;
      
      // Llenar campos del formulario
      document.getElementById('editar-destino-nombre').value = destino.nombre;
      document.getElementById('editar-destino-tipo').value = destino.tipo;
      document.getElementById('editar-destino-provincia').value = destino.provincia;
      document.getElementById('editar-destino-ciudad').value = destino.ciudad;
      document.getElementById('editar-destino-latitud').value = destino.latitud;
      document.getElementById('editar-destino-longitud').value = destino.longitud;
      document.getElementById('editar-destino-direccion').value = destino.direccion;
      document.getElementById('editar-destino-telefono').value = destino.telefono;
      document.getElementById('editar-destino-email').value = destino.email;
      document.getElementById('editar-destino-web').value = destino.sitio_web;
      document.getElementById('editar-destino-horario').value = destino.horario;
      document.getElementById('editar-destino-precio').value = destino.precio;
      document.getElementById('editar-destino-descripcion').value = destino.descripcion;
      
      // Llenar checkboxes de caracterÃ­sticas
      const checkboxes = document.querySelectorAll('#form-editar-registro input[name="caracteristicas"]');
      checkboxes.forEach(checkbox => {
        checkbox.checked = destino.caracteristicas.includes(checkbox.value);
      });
      
      // Guardar valores originales
      guardarValoresOriginales();
      
      // Actualizar contador
      actualizarContadorEditar();
      
      // Abrir modal
      document.getElementById('modal-editar-registro').classList.remove('oculto');
    }
    
    // FunciÃ³n para guardar valores originales
    function guardarValoresOriginales() {
      const form = document.getElementById('form-editar-registro');
      const inputs = form.querySelectorAll('input, select, textarea');
      
      inputs.forEach(input => {
        if (input.type === 'checkbox') {
          input.setAttribute('data-original-value', input.checked.toString());
        } else {
          input.setAttribute('data-original-value', input.value);
        }
      });
    }
    
    // FunciÃ³n para detectar cambios
    function detectarCambios() {
      const form = document.getElementById('form-editar-registro');
      const inputs = form.querySelectorAll('input, select, textarea');
      const btnRestaurar = document.getElementById('btn-restaurar');
      let hayCambios = false;
      
      inputs.forEach(input => {
        const originalValue = input.getAttribute('data-original-value');
        let currentValue;
        
        if (input.type === 'checkbox') {
          currentValue = input.checked.toString();
        } else {
          currentValue = input.value;
        }
        
        if (originalValue !== currentValue) {
          input.classList.add('modificado');
          hayCambios = true;
        } else {
          input.classList.remove('modificado');
        }
      });
      
      // Mostrar/ocultar botÃ³n restaurar
      if (hayCambios) {
        btnRestaurar.style.display = 'inline-flex';
      } else {
        btnRestaurar.style.display = 'none';
      }
      
      return hayCambios;
    }
    
    // FunciÃ³n para restaurar datos originales
    function restaurarDatosOriginales() {
      const form = document.getElementById('form-editar-registro');
      const inputs = form.querySelectorAll('input, select, textarea');
      
      inputs.forEach(input => {
        const originalValue = input.getAttribute('data-original-value');
        
        if (input.type === 'checkbox') {
          input.checked = originalValue === 'true';
        } else {
          input.value = originalValue;
        }
        
        input.classList.remove('modificado');
      });
      
      // Ocultar botÃ³n restaurar
      document.getElementById('btn-restaurar').style.display = 'none';
      
      // Actualizar contador
      actualizarContadorEditar();
      
      // Mostrar confirmaciÃ³n
      const statusDiv = document.getElementById('editar-status');
      statusDiv.textContent = 'Datos originales restaurados';
      statusDiv.className = 'editar-status info';
      
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = 'editar-status';
      }, 2000);
    }
    
    // FunciÃ³n para manejar formulario de editar
    function manejarFormularioEditar(event) {
      event.preventDefault();
      
      // Validar formulario
      const form = event.target;
      const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
      let isValid = true;
      
      inputs.forEach(input => {
        if (!validarCampoEditar(input)) {
          isValid = false;
        }
      });
      
      if (!isValid) {
        return;
      }
      
      // Verificar si hay cambios
      if (!detectarCambios()) {
        const statusDiv = document.getElementById('editar-status');
        statusDiv.textContent = 'No se detectaron cambios para guardar';
        statusDiv.className = 'editar-status info';
        return;
      }
      
      // Mostrar estado de carga
      const submitBtn = document.getElementById('editar-submit-btn');
      const statusDiv = document.getElementById('editar-status');
      
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Actualizando destino turÃ­stico...';
      statusDiv.className = 'editar-status info';
      
      // Simular envÃ­o
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        statusDiv.textContent = 'Â¡Destino turÃ­stico actualizado exitosamente!';
        statusDiv.className = 'editar-status success';
        
        // Cerrar modal despuÃ©s de 2 segundos
        setTimeout(() => {
          cerrarModal('modal-editar-registro');
        }, 2000);
      }, 2000);
    }
    
    // FunciÃ³n para validar campo de editar
    function validarCampoEditar(input) {
      const value = input.value.trim();
      const errorElement = document.getElementById(input.id + '-error');
      let isValid = true;
      let errorMessage = '';
      
      // Validaciones especÃ­ficas por tipo de campo
      switch(input.name) {
        case 'nombre':
          if (!value) {
            errorMessage = 'El nombre del destino es obligatorio';
            isValid = false;
          } else if (value.length < 3) {
            errorMessage = 'El nombre debe tener al menos 3 caracteres';
            isValid = false;
          }
          break;
          
        case 'tipo':
          if (!value) {
            errorMessage = 'Debe seleccionar un tipo de destino';
            isValid = false;
          }
          break;
          
        case 'provincia':
          if (!value) {
            errorMessage = 'Debe seleccionar una provincia';
            isValid = false;
          }
          break;
          
        case 'descripcion':
          if (!value) {
            errorMessage = 'La descripciÃ³n es obligatoria';
            isValid = false;
          } else if (value.length < 20) {
            errorMessage = 'La descripciÃ³n debe tener al menos 20 caracteres';
            isValid = false;
          }
          break;
          
        case 'email':
          if (value && !isValidEmail(value)) {
            errorMessage = 'Ingrese un email vÃ¡lido';
            isValid = false;
          }
          break;
          
        case 'sitio_web':
          if (value && !isValidUrl(value)) {
            errorMessage = 'Ingrese una URL vÃ¡lida';
            isValid = false;
          }
          break;
          
        case 'latitud':
          if (value && (isNaN(value) || value < -5 || value > 2)) {
            errorMessage = 'La latitud debe estar entre -5 y 2';
            isValid = false;
          }
          break;
          
        case 'longitud':
          if (value && (isNaN(value) || value < -82 || value > -75)) {
            errorMessage = 'La longitud debe estar entre -82 y -75';
            isValid = false;
          }
          break;
      }
      
      // Mostrar/ocultar error
      if (isValid) {
        input.classList.remove('error');
        errorElement.textContent = '';
      } else {
        input.classList.add('error');
        errorElement.textContent = errorMessage;
      }
      
      return isValid;
    }
    
    // FunciÃ³n para actualizar contador de editar
    function actualizarContadorEditar() {
      const textarea = document.getElementById('editar-destino-descripcion');
      const counter = document.getElementById('editar-descripcion-counter');
      const length = textarea.value.length;
      counter.textContent = length;
      
      if (length > 900) {
        counter.style.color = '#dc3545';
      } else if (length > 800) {
        counter.style.color = '#ffc107';
      } else {
        counter.style.color = '#6c757d';
      }
    }
    
    // FunciÃ³n para confirmar cerrar editar
    function confirmarCerrarEditar() {
      if (detectarCambios()) {
        if (confirm('Â¿EstÃ¡s seguro de que quieres cerrar? Los cambios no guardados se perderÃ¡n.')) {
          cerrarModal('modal-editar-registro');
        }
      } else {
        cerrarModal('modal-editar-registro');
      }
    }
    
    // ===== FUNCIONES PARA FORMULARIO DE BÃšSQUEDA CON FILTROS =====
    
    // FunciÃ³n para abrir modal de bÃºsqueda
    function abrirModalBusqueda() {
      document.getElementById('modal-busqueda-filtros').classList.remove('oculto');
      cargarFiltrosGuardados();
    }
    
    // FunciÃ³n para manejar formulario de bÃºsqueda
    function manejarFormularioBusqueda(event) {
      event.preventDefault();
      
      // Mostrar estado de carga
      const submitBtn = document.getElementById('busqueda-submit-btn');
      const statusDiv = document.getElementById('busqueda-status');
      
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Buscando destinos...';
      statusDiv.className = 'busqueda-status info';
      
      // Simular bÃºsqueda
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        realizarBusqueda();
      }, 1500);
    }
    
    // FunciÃ³n para realizar bÃºsqueda
    function realizarBusqueda() {
      const form = document.getElementById('form-busqueda-filtros');
      const formData = new FormData(form);
      const filtros = {};
      
      formData.forEach((value, key) => {
        if (value) {
          filtros[key] = value;
        }
      });
      
      // Simular resultados
      const resultados = [
        {
          id: 1,
          nombre: 'Centro HistÃ³rico de Cuenca',
          tipo: 'Ciudad',
          provincia: 'Azuay',
          descripcion: 'Patrimonio Cultural de la Humanidad con arquitectura colonial.',
          precio: 'Gratis'
        },
        {
          id: 2,
          nombre: 'Playa de Salinas',
          tipo: 'Playa',
          provincia: 'Santa Elena',
          descripcion: 'Hermosa playa con aguas cristalinas y arena blanca.',
          precio: '$5'
        },
        {
          id: 3,
          nombre: 'BaÃ±os de Agua Santa',
          tipo: 'MontaÃ±a',
          provincia: 'Tungurahua',
          descripcion: 'Destino de aventura con cascadas y aguas termales.',
          precio: '$10-20'
        }
      ];
      
      mostrarResultadosBusqueda(resultados);
    }
    
    // FunciÃ³n para mostrar resultados
    function mostrarResultadosBusqueda(resultados) {
      const contador = document.getElementById('resultados-contador');
      const lista = document.getElementById('resultados-lista');
      const statusDiv = document.getElementById('busqueda-status');
      
      contador.textContent = `${resultados.length} destinos encontrados`;
      
      if (resultados.length === 0) {
        lista.innerHTML = '<div class="no-resultados">No se encontraron destinos con los filtros aplicados</div>';
        statusDiv.textContent = 'No se encontraron resultados';
        statusDiv.className = 'busqueda-status info';
      } else {
        lista.innerHTML = resultados.map(destino => `
          <div class="resultado-item">
            <div class="resultado-nombre">${destino.nombre}</div>
            <div class="resultado-tipo">${destino.tipo}</div>
            <div class="resultado-provincia">${destino.provincia}</div>
            <div class="resultado-descripcion">${destino.descripcion}</div>
            <div class="resultado-precio">Precio: ${destino.precio}</div>
            <div class="resultado-acciones">
              <button class="btn-resultado ver" onclick="verDestino(${destino.id})">ğŸ‘ï¸ Ver</button>
              <button class="btn-resultado editar" onclick="abrirModalEditar(${destino.id})">âœï¸ Editar</button>
              <button class="btn-resultado eliminar" onclick="abrirModalEliminar(${destino.id})">ğŸ—‘ï¸ Eliminar</button>
            </div>
          </div>
        `).join('');
        
        statusDiv.textContent = 'BÃºsqueda completada exitosamente';
        statusDiv.className = 'busqueda-status success';
      }
    }
    
    // FunciÃ³n para limpiar filtros
    function limpiarFiltrosBusqueda() {
      document.getElementById('form-busqueda-filtros').reset();
      document.getElementById('resultados-lista').innerHTML = '';
      document.getElementById('resultados-contador').textContent = '0 destinos encontrados';
      document.getElementById('busqueda-status').textContent = '';
      document.getElementById('busqueda-status').className = 'busqueda-status';
    }
    
    // FunciÃ³n para guardar filtros frecuentes
    function guardarFiltrosFrecuentes() {
      const form = document.getElementById('form-busqueda-filtros');
      const formData = new FormData(form);
      const filtros = {};
      
      formData.forEach((value, key) => {
        if (value) {
          filtros[key] = value;
        }
      });
      
      // Guardar en localStorage
      const filtrosGuardados = JSON.parse(localStorage.getItem('filtrosFrecuentes') || '[]');
      filtrosGuardados.push({
        id: Date.now(),
        nombre: 'Filtros ' + new Date().toLocaleDateString(),
        filtros: filtros
      });
      
      localStorage.setItem('filtrosFrecuentes', JSON.stringify(filtrosGuardados));
      
      // Mostrar confirmaciÃ³n
      const statusDiv = document.getElementById('busqueda-status');
      statusDiv.textContent = 'Filtros guardados como favoritos';
      statusDiv.className = 'busqueda-status success';
      
      setTimeout(() => {
        statusDiv.textContent = '';
        statusDiv.className = 'busqueda-status';
      }, 2000);
    }
    
    // FunciÃ³n para cargar filtros guardados
    function cargarFiltrosGuardados() {
      const filtrosGuardados = JSON.parse(localStorage.getItem('filtrosFrecuentes') || '[]');
      if (filtrosGuardados.length > 0) {
        // AquÃ­ se podrÃ­an mostrar los filtros guardados en un menÃº desplegable
        console.log('Filtros guardados:', filtrosGuardados);
      }
    }
    
    // ===== FUNCIONES PARA FORMULARIO DE ELIMINAR REGISTRO =====
    
    // FunciÃ³n para abrir modal de eliminar
    function abrirModalEliminar(destinoId) {
      // Simular carga de datos del destino
      const destino = {
        id: destinoId,
        nombre: 'Centro HistÃ³rico de Cuenca',
        tipo: 'Ciudad',
        provincia: 'Azuay',
        descripcion: 'Patrimonio Cultural de la Humanidad con arquitectura colonial.'
      };
      
      // Llenar informaciÃ³n del destino
      document.getElementById('eliminar-destino-id').textContent = destino.id;
      document.getElementById('eliminar-destino-nombre').textContent = destino.nombre;
      document.getElementById('eliminar-destino-tipo').textContent = destino.tipo;
      document.getElementById('eliminar-destino-provincia').textContent = destino.provincia;
      document.getElementById('eliminar-destino-descripcion').textContent = destino.descripcion;
      
      // Resetear checkboxes
      document.getElementById('eliminar-confirmar').checked = false;
      document.getElementById('eliminar-backup').checked = false;
      
      // Deshabilitar botÃ³n de confirmar
      document.getElementById('eliminar-confirmar-btn').disabled = true;
      
      // Limpiar estado
      document.getElementById('eliminar-status').textContent = '';
      document.getElementById('eliminar-status').className = 'eliminar-status';
      
      // Abrir modal
      document.getElementById('modal-eliminar-registro').classList.remove('oculto');
    }
    
    // FunciÃ³n para confirmar eliminaciÃ³n
    function confirmarEliminacion() {
      const confirmarCheckbox = document.getElementById('eliminar-confirmar');
      const backupCheckbox = document.getElementById('eliminar-backup');
      const submitBtn = document.getElementById('eliminar-confirmar-btn');
      const statusDiv = document.getElementById('eliminar-status');
      
      if (!confirmarCheckbox.checked) {
        statusDiv.textContent = 'Debe confirmar que entiende las consecuencias';
        statusDiv.className = 'eliminar-status error';
        return;
      }
      
      // Mostrar estado de carga
      submitBtn.classList.add('loading');
      statusDiv.textContent = 'Eliminando destino...';
      statusDiv.className = 'eliminar-status info';
      
      // Simular eliminaciÃ³n
      setTimeout(() => {
        submitBtn.classList.remove('loading');
        statusDiv.textContent = 'Â¡Destino eliminado exitosamente!';
        statusDiv.className = 'eliminar-status success';
        
        // Cerrar modal despuÃ©s de 2 segundos
        setTimeout(() => {
          cerrarModal('modal-eliminar-registro');
        }, 2000);
      }, 2000);
    }
    
    // FunciÃ³n para desactivar destino
    function desactivarDestino() {
      const statusDiv = document.getElementById('eliminar-status');
      statusDiv.textContent = 'Destino desactivado (recomendado)';
      statusDiv.className = 'eliminar-status success';
      
      // Cerrar modal despuÃ©s de 2 segundos
      setTimeout(() => {
        cerrarModal('modal-eliminar-registro');
      }, 2000);
    }
    
    // FunciÃ³n para ver destino
    function verDestino(destinoId) {
      alert(`Viendo destino con ID: ${destinoId}`);
      // AquÃ­ se abrirÃ­a una vista detallada del destino
    }
    
    // Event listeners para todos los formularios
    document.addEventListener('DOMContentLoaded', function() {
      // Formulario de guardar
      const formGuardar = document.getElementById('form-guardar-registro');
      if (formGuardar) {
        formGuardar.addEventListener('submit', manejarFormularioGuardar);
        
        // ValidaciÃ³n en tiempo real
        const inputs = formGuardar.querySelectorAll('.form-input, .form-textarea');
        inputs.forEach(input => {
          input.addEventListener('blur', () => validarCampoGuardar(input));
          input.addEventListener('input', () => {
            validarCampoGuardar(input);
            guardarBorradorGuardar();
          });
        });
        
        // Contador de caracteres
        const textarea = document.getElementById('destino-descripcion');
        if (textarea) {
          textarea.addEventListener('input', actualizarContadorGuardar);
        }
        
        // Cargar borrador al abrir
        cargarBorradorGuardar();
      }
      
      // Formulario de editar
      const formEditar = document.getElementById('form-editar-registro');
      if (formEditar) {
        formEditar.addEventListener('submit', manejarFormularioEditar);
        
        // ValidaciÃ³n en tiempo real
        const inputs = formEditar.querySelectorAll('.form-input, .form-textarea');
        inputs.forEach(input => {
          input.addEventListener('blur', () => validarCampoEditar(input));
          input.addEventListener('input', () => {
            validarCampoEditar(input);
            detectarCambios();
          });
        });
        
        // Contador de caracteres
        const textareaEditar = document.getElementById('editar-destino-descripcion');
        if (textareaEditar) {
          textareaEditar.addEventListener('input', actualizarContadorEditar);
        }
      }
      
      // Formulario de bÃºsqueda
      const formBusqueda = document.getElementById('form-busqueda-filtros');
      if (formBusqueda) {
        formBusqueda.addEventListener('submit', manejarFormularioBusqueda);
      }
      
      // Checkbox de confirmaciÃ³n para eliminar
      const confirmarCheckbox = document.getElementById('eliminar-confirmar');
      if (confirmarCheckbox) {
        confirmarCheckbox.addEventListener('change', function() {
          document.getElementById('eliminar-confirmar-btn').disabled = !this.checked;
        });
      }
    });
  </script>
</body>
</html>
